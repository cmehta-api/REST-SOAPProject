<?xml version="1.0" encoding="UTF-8"?>
<con:soapui-project id="c785e905-ac79-4cde-a7ac-fa3e2bb18e78" activeEnvironment="Default" name="GSS-SIT_REST" soapui-version="5.4.0" abortOnError="false" runType="SEQUENTIAL" resourceRoot="" xmlns:con="http://eviware.com/soapui/config"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.actions.iface.tools.soapui.TestRunnerAction@values-local"><![CDATA[<xml-fragment xmlns:con="http://eviware.com/soapui/config">
  <con:entry key="Environment" value="Default"/>
  <con:entry key="Global Properties" value=""/>
  <con:entry key="TestSuite" value="TestSuite 1"/>
  <con:entry key="Password" value=""/>
  <con:entry key="TestRunner Path" value=""/>
  <con:entry key="Tool Args" value=""/>
  <con:entry key="Ignore Errors" value="false"/>
  <con:entry key="Host:Port" value=""/>
  <con:entry key="user-settings.xml Password" value=""/>
  <con:entry key="WSS Password Type" value=""/>
  <con:entry key="Save Project" value="false"/>
  <con:entry key="Enable UI" value="false"/>
  <con:entry key="System Properties" value=""/>
  <con:entry key="Domain" value=""/>
  <con:entry key="Coverage Report" value="false"/>
  <con:entry key="Export JUnit Results" value="false"/>
  <con:entry key="Export JUnit Results with test properties" value="false"/>
  <con:entry key="Open Report" value="false"/>
  <con:entry key="Project Properties" value=""/>
  <con:entry key="Export All" value="false"/>
  <con:entry key="Project Password" value=""/>
  <con:entry key="Report Format(s)" value=""/>
  <con:entry key="TestCase" value="TestCase 1.1-GetDeviceList"/>
  <con:entry key="Print Report" value="false"/>
  <con:entry key="Username" value=""/>
  <con:entry key="Root Folder" value=""/>
  <con:entry key="Select Report Type" value=""/>
  <con:entry key="Save After" value="false"/>
  <con:entry key="Add Settings" value="false"/>
  <con:entry key="Endpoint" value=""/>
</xml-fragment>]]></con:setting></con:settings><con:interface xsi:type="con:RestService" id="0efa8dfe-39f5-45e6-86b3-fac600ade78f" wadlVersion="http://wadl.dev.java.net/2009/02" name="https://gbrdsr000003146.intranet.barcapint.com:4201" type="rest" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:settings/><con:definitionCache type="TEXT" rootPart=""/><con:endpoints><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint></con:endpoints><con:resource name="Devicelist" path="/generic-security-rs/devicelist" id="b532e88e-fd9e-4233-b8c6-fe58197d7336"><con:settings/><con:parameters/><con:method name="Devicelist" id="10bcb582-6acd-4f50-80fc-e0a17ea5450f" method="POST"><con:settings/><con:parameters/><con:representation type="RESPONSE"><con:mediaType>application/json</con:mediaType><con:status>200</con:status><con:params/><con:element xmlns:dev="https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/devicelist">dev:Response</con:element></con:representation><con:representation type="REQUEST"><con:mediaType>application/json</con:mediaType><con:params/></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="FAULT"><con:mediaType>text/html;charset=utf-8</con:mediaType><con:status>500</con:status><con:params/><con:element>html</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:request name="Request 1" id="b063e9a0-5f4c-484f-b84a-038d96c080c1" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request>{
	"gssRequestHeader":{
		"serviceContext":{
			"USER_AGENT":"Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
			"APPLICATION":"B.NET"
		},
		"securityContext":null,
		"requestContext":{
			"REQUEST_TIMESTAMP":"2011-06-14T04:12:36BST",
			"REQUEST_TRACKING_ID":"REQ10001",
			"CALLBACK_URL":"https://bnet.barclays.com/"
		},
		"auditContext":{
			"MODULE_ID":"B.Net Login Module",
			"IS_FINANCIAL_TRANSACTION":"false",
			"CLIENT_IP_ADDRESS":"35.53.180.6"
		}
	},
	"deviceRequestMap":{
		"ONLY_ACTIVE":"true",
		"OUTPUT_TYPE":"BOTH"
	}
}</con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/devicelist</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:request></con:method></con:resource><con:resource name="ReferenceData" path="/generic-security-rs/referencedata" id="41ad5f7e-1a0b-4b6e-ba65-1e4f53082b93"><con:settings/><con:parameters/><con:method name="Method 1" id="f07e692f-4603-43ec-afc3-da60a0fae741" method="POST"><con:settings/><con:parameters/><con:representation type="RESPONSE"><con:mediaType>application/json</con:mediaType><con:status>200</con:status><con:params/><con:element xmlns:ref="https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/referencedata">ref:Response</con:element></con:representation><con:representation type="REQUEST"><con:mediaType>application/json</con:mediaType><con:params/></con:representation><con:request name="Request 1" id="42fd94ab-feba-4bf6-89c2-a651afc75e7e" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request>{
	"gssRequestHeader":{
		"serviceContext":{
			"USER_AGENT":"Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
			"APPLICATION":"B.NET"
		},
		"securityContext":null,
		"requestContext":{
			"REQUEST_TIMESTAMP":"2011-06-14T04:12:36BST",
			"REQUEST_TRACKING_ID":"REQ10001",
			"CALLBACK_URL":"https://bnet.barclays.com/"
		},
		"auditContext":{
			"MODULE_ID":"B.Net Login Module",
			"IS_FINANCIAL_TRANSACTION":"false",
			"CLIENT_IP_ADDRESS":"35.53.180.6"
		}
	},
	"refDataMap":{
		"FILTER_VALUE1":"SC",
		"REFERENCE_DATA_KEY":"SOFTWARE_TYPES",
		"FILTER_KEY1":"DEVICE_READER_TYPE_CODE"
	}
}</con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/referencedata</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:request></con:method></con:resource><con:resource name="initiateLogin" path="/generic-security-rs/initiate" id="3a388ee9-9421-4358-88c7-1314f33de668"><con:settings/><con:parameters/><con:method name="Method 1" id="d7bdb511-3f39-43ed-a8f4-7e30cbad714a" method="POST"><con:settings/><con:parameters/><con:representation type="REQUEST"><con:mediaType>application/json</con:mediaType><con:params/></con:representation><con:representation type="RESPONSE"><con:mediaType>application/json</con:mediaType><con:status>200</con:status><con:params/><con:element xmlns:init="https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/initiate">init:Response</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:request name="Request 1" id="45730af7-4d98-41bd-a00f-24929dff6304" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request>{
   "transactionItemList": [],
   "preFormattedData": "VGhpcyBpcyBhIHNhbXBsZSBvZiBwcmVmb3JtYXR0ZWQgZGF0YSwgY3JlYXRlZCBvbiAyNy8wMy8yMDE1Lg==",
   "initiateRequestHeader":    {
      "gssRequestHeader":       {
         "serviceContext":          {
            "PURN_TYPE": "pki",
            "USER_AGENT": "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
            "PURN": "99000000000000000003",
            "APPLICATION": "B.NET"
         },
         "auditContext":          {
            "MODULE_ID": "12345678901234567890123456789012345678901",
            "IS_FINANCIAL_TRANSACTION": "false",
            "SUB_MODULE_ID": "eyJVU0VSX0FHRU5UIjoiSUU4IiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IkdCIn0=",
            "SUBMODULE_ID": "eyJVU0VSX0FHRU5UIjoiSUU4IiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IkdCIn0=",
            "CLIENT_IP_ADDRESS": "35.53.180.6"
         },
         "requestContext":          {
            "REQUEST_TIMESTAMP": "2011-06-14T04:12:36BST",
            "REQUEST_TRACKING_ID": "REQ10001",
            "CALLBACK_URL": "https://bnet.barclays.com/"
         },
         "securityContext": "eyJVU0VSX0FHRU5UIjoiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgNi4xOyBXT1c2NDsgVHJpZGVudC83LjA7IEFTOyBydjoxMS4wKSBsaWtlIEdlY2tvIiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IkdCIn0="
      },
      "initiateRequestHeaderDetails":       {
         "FUNCTION_TYPE": "AUTHENTICATE",
         "ACTION_TYPE": "SUBMIT",
         "DEVICE_TYPE_CODE": "FV",
         "OUTPUT_TYPE": "HTML"
      }
   },
   "requestDetailsMap": {}
}</con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/initiate</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:request></con:method></con:resource><con:resource name="verifyLogin" path="/generic-security-rs/verify" id="931a79b1-2829-49e3-a7ed-2f4386c28729"><con:settings/><con:parameters/><con:method name="Method 1" id="1a6ad2be-fd53-4808-bfad-166f89514a9b" method="POST"><con:settings/><con:parameters/><con:representation type="REQUEST"><con:mediaType>application/json</con:mediaType><con:params/></con:representation><con:representation type="RESPONSE"><con:mediaType>application/json</con:mediaType><con:status>200</con:status><con:params/><con:element xmlns:ver="https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/verify">ver:Response</con:element></con:representation><con:request name="Request 1" id="ae8cc01d-5b14-46b5-8fa6-6207c40ac5af" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request><![CDATA[{
   "verifyDetailMap": {"GSS_REFERENCE_ID": "0F75F0000EF043429EA098CCA641E258"},
   "gssRequestHeader":    {
      "serviceContext":       {
         "USER_AGENT": "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
         "APPLICATION": "B.NET"
      },
      "auditContext":       {
         "MODULE_ID": "B.Net Login Module",
         "IS_FINANCIAL_TRANSACTION": "false",
         "CLIENT_IP_ADDRESS": "35.53.180.6"
      },
      "requestContext":       {
         "REQUEST_TIMESTAMP": "2011-06-14T04:12:36BST",
         "REQUEST_TRACKING_ID": "REQ10001",
         "CALLBACK_URL": "https://bnet.barclays.com/",
         "GSS_NONCE": "20eda812-a85c-49d2-8333-b883fd63d888"
      },
      "securityContext": "eyJQVVJOX1RZUEUiOiJwa2kiLCJQVVJOIjoiOTkwMDAwMDAwMDAwMDAwMDAwMDMiLCJVU0VSX0FHRU5UIjoiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgNi4xOyBXT1c2NDsgVHJpZGVudC83LjA7IEFTOyBydjoxMS4wKSBsaWtlIEdlY2tvIiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIkRFVklDRV9UWVBFX0NPREUiOiJGViIsIlJFR0lPTiI6IkdCIiwiR1NTX1JFRkVSRU5DRV9JRCI6IjBGNzVGMDAwMEVGMDQzNDI5RUEwOThDQ0E2NDFFMjU4In0="
   },
   "deviceParamMap":    {
      "HTTP_METHOD": "PUT",
      "HTTP_INPUT_CONTENTS": "Version_Spec=100&amp;Version_Plugin_Major=3&amp;Version_Plugin_Minor=0&amp;Version_Browser_Major=0&amp;Version_Browser_Minor=11&amp;Transaction_ID=7a4a1763-0ac0-4fb7-9d98-e6053e95d191401141426801730&amp;Signature_Data=MIIPZgYJKoZIhvcNAQcCoIIPVzCCD1MCAQExCzAJBgUrDgMCGgUAMIID2wYJKoZIhvcNAQcBoIIDzASCA8hDbGllbnQgTmFtZTogICAgICAgICAgICAgICAgICAgICAgICBURVNUSU5HIENPTVBBTlkgICAgICAgICAgICAgICAgICAgICAgIA0KRG9jdW1lbnQgSUQ6ICAgICAgICAgICAgICAgICAgICAgICAgRjAyNjNBMEUyNDJFNEM5NEI2MEREMjA0RjQ0QjZDQUINClNpZ24gYW5kIFN1Ym1pdCB0aGUgZm9sbG93aW5nIHRyYW5zYWN0aW9ucyAoMSkNCg0KUGF5bWVudCBUeXBlOiAgICAgICAgICAgICAgICAgICAgICAgRG9tZXN0aWMgUGF5bWVudA0KRGVsaXZlcnkgT3B0aW9uOiAgICAgICAgICAgICAgICAgICAgVUsgVGhyZWUgRGF5IFBheW1lbnQNCkRlYml0IEFjY291bnQgQmFuayBJZGVudGlmaWVyOiAgICAgIDA5MDA2Mw0KRGViaXQgQWNjb3VudCBOdW1iZXI6ICAgICAgICAgICAgICAgMDMwNDE0MDENCkRlYml0IEFjY291bnQgQ3VycmVuY3k6ICAgICAgICAgICAgIFBvdW5kIFN0ZXJsaW5nDQpQYXltZW50IEN1cnJlbmN5OiAgICAgICAgICAgICAgICAgICBQb3VuZCBTdGVybGluZw0KUGF5bWVudCBBbW91bnQ6ICAgICAgICAgICAgICAgICAgICAgMjYwMC4wMA0KVHJhbnNhY3Rpb24gUmVmZXJlbmNlIE51bWJlcjogICAgICAgQlgxNTA0MjAwNjkzMjYwNw0KVmFsdWUgRGF0ZTogICAgICAgICAgICAgICAgICAgICAgICAgQXByIDI0LCAyMDE1DQpDdXN0b21lciBSZWZlcmVuY2U6ICAgICAgICAgICAgICAgICAxMjMxMjMxMjMNCk51bWJlciBvZiBjcmVkaXQvZGViaXQgcmVjb3JkczoJICAgIDENCg0KQmVuZWZpY2lhcnkgTmFtZTogICAgICAgICAgICAgICAgICAgMTM0MjM0MjMNCkJlbmVmaWNpYXJ5IEFjY291bnQgQmFuayBJZGVudGlmaWVyOjE4NTAwOA0KQmVuZWZpY2lh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&amp;Signature_Format=PKCS7_basic&amp;IsDetailScrAction=false&amp;pd=F0263A0E242E4C94B60DD204F44B6CAB&amp;gssRefId=7a4a1763-0ac0-4fb7-9d98-e6053e95d191401141426801730&amp;gssStore=true"
   }
}]]></con:request><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:request></con:method></con:resource><con:resource name="initiateSigning" path="/generic-security-rs/initiate" id="3a388ee9-9421-4358-88c7-1314f33de668"><con:settings/><con:parameters/><con:method name="Method 1" id="d7bdb511-3f39-43ed-a8f4-7e30cbad714a" method="POST"><con:settings/><con:parameters/><con:request name="Request 1" id="45730af7-4d98-41bd-a00f-24929dff6304" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request>{
   "transactionItemList": [],
   "preFormattedData": "VGhpcyBpcyBhIHNhbXBsZSBvZiBwcmVmb3JtYXR0ZWQgZGF0YSwgY3JlYXRlZCBvbiAyNy8wMy8yMDE1Lg==",
   "initiateRequestHeader":    {
      "gssRequestHeader":       {
         "serviceContext":          {
            "PURN_TYPE": "pki",
            "USER_AGENT": "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
            "PURN": "99000000000000000003",
            "APPLICATION": "B.NET"
         },
         "auditContext":          {
            "MODULE_ID": "12345678901234567890123456789012345678901",
            "IS_FINANCIAL_TRANSACTION": "false",
            "SUB_MODULE_ID": "eyJVU0VSX0FHRU5UIjoiSUU4IiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IkdCIn0=",
            "SUBMODULE_ID": "eyJVU0VSX0FHRU5UIjoiSUU4IiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IkdCIn0=",
            "CLIENT_IP_ADDRESS": "35.53.180.6"
         },
         "requestContext":          {
            "REQUEST_TIMESTAMP": "2011-06-14T04:12:36BST",
            "REQUEST_TRACKING_ID": "REQ10001",
            "CALLBACK_URL": "https://bnet.barclays.com/"
         },
         "securityContext": "eyJQVVJOX1RZUEUiOiJwa2kiLCJQVVJOIjoiOTkwMDAwMDAwMDAwMDAwMDAwMDMiLCJVU0VSX0FHRU5UIjoiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgNi4xOyBXT1c2NDsgVHJpZGVudC83LjA7IEFTOyBydjoxMS4wKSBsaWtlIEdlY2tvIiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIkRFVklDRV9UWVBFX0NPREUiOiJGViIsIlJFR0lPTiI6IkdCIiwiR1NTX1JFRkVSRU5DRV9JRCI6IjBGNzVGMDAwMEVGMDQzNDI5RUEwOThDQ0E2NDFFMjU4IiwiQ0xJRU5UX05BTUUiOiJiYXJjbGF5cyBjb3JwIExpbWl0ZWQiLCJVU0VSX05BTUUiOiJKZXNpY2EzIGFsYmEzIiwiREVWSUNFX0FMSUFTIjoiRlYgQWxpYXMiLCJVU0VSX1NUQVRVUyI6IkFDVElWRSJ9"
      },
      "initiateRequestHeaderDetails":       {
         "FUNCTION_TYPE": "SIGN-TRANSACTIONS",
         "ACTION_TYPE": "SUBMIT",
         "DEVICE_TYPE_CODE": "FV",
         "OUTPUT_TYPE": "HTML"
      }
   },
   "requestDetailsMap": {}
}</con:request><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:request></con:method></con:resource><con:resource name="verifySigning" path="/generic-security-rs/verify" id="931a79b1-2829-49e3-a7ed-2f4386c28729"><con:settings/><con:parameters/><con:method name="Method 1" id="1a6ad2be-fd53-4808-bfad-166f89514a9b" method="POST"><con:settings/><con:parameters/><con:request name="Request 1" id="ae8cc01d-5b14-46b5-8fa6-6207c40ac5af" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request><![CDATA[{
   "verifyDetailMap": {"GSS_REFERENCE_ID": "F401D190D6B746EEA66795E3086DC477"},
   "gssRequestHeader":    {
      "serviceContext":       {
         "USER_AGENT": "Gecko/20130401 Firefox/31.0",
         "APPLICATION": "B.NET"
      },
      "auditContext":       {
         "MODULE_ID": "B.Net Login Module",
         "IS_FINANCIAL_TRANSACTION": "false",
         "CLIENT_IP_ADDRESS": "35.53.180.6"
      },
      "requestContext":       {
         "REQUEST_TIMESTAMP": "2011-06-14T04:12:36BST",
         "REQUEST_TRACKING_ID": "REQ10001",
         "CALLBACK_URL": "https://gbrdsr000002800:5351/generic-security-test-bed/FV_Servlet",
         "GSS_NONCE": "52862c85-4be6-4998-a73f-86ad49d5adbc"
      },
      "securityContext": "eyJQVVJOX1RZUEUiOiJwa2kiLCJVU0VSX05BTUUiOiJKZXNpY2EzIGFsYmEzIiwiQ0xJRU5UX05BTUUiOiJiYXJjbGF5cyBjb3JwIExpbWl0ZWQiLCJVU0VSX0FHRU5UIjoiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgNi4xOyBXT1c2NDsgVHJpZGVudC83LjA7IEFTOyBydjoxMS4wKSBsaWtlIEdlY2tvIiwiUFVSTiI6Ijk5MDAwMDAwMDAwMDAwMDAwMDAzIiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIkRFVklDRV9BTElBUyI6IkZWIEFsaWFzIiwiREVWSUNFX1RZUEVfQ09ERSI6IkZWIiwiUkVHSU9OIjoiR0IiLCJVU0VSX1NUQVRVUyI6IkFDVElWRSIsIkdTU19SRUZFUkVOQ0VfSUQiOiJGNDAxRDE5MEQ2Qjc0NkVFQTY2Nzk1RTMwODZEQzQ3NyJ9"
   },
   "deviceParamMap":    {
      "HTTP_METHOD": "PUT",
      "HTTP_INPUT_CONTENTS": "Version_Spec=100&amp;Version_Plugin_Major=3&amp;Version_Plugin_Minor=0&amp;Version_Browser_Major=0&amp;Version_Browser_Minor=11&amp;Transaction_ID=03B8BBD9AA084C7F917FE3D31CDE19BA&amp;Signature_Data=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&amp;Signature_Format=PKCS7_basic&amp;IsDetailScrAction=false&amp;pd=F0263A0E242E4C94B60DD204F44B6CAB&amp;gssRefId=7a4a1763-0ac0-4fb7-9d98-e6053e95d191401141426801730&amp;gssStore=true"
   }
}]]></con:request><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:request></con:method></con:resource></con:interface><con:testSuite id="61d9db92-1942-4bf7-94cb-9ec8cd4a4ad6" name="TestSuite 1"><con:settings/><con:runType>SEQUENTIAL</con:runType><con:testCase id="1da3175b-b3ed-447c-8128-b61b3796202b" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="TestCase 1.1-GetDeviceList" searchProperties="true"><con:settings/><con:testStep type="restrequest" name="GetDeviceList-HapplyFlow" id="67fbe5c5-42d2-45cc-9291-22225848bd47"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" methodName="Devicelist" resourcePath="/generic-security-rs/devicelist" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="GetDeviceList-HapplyFlow" id="342ca3e0-16fb-45fd-8375-e796626ecacc" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request>{
	"gssRequestHeader":{
		"serviceContext":{
			"USER_AGENT":"Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
			"APPLICATION":"B.NET"
		},
		"securityContext":null,
		"requestContext":{
			"REQUEST_TIMESTAMP":"2011-06-14T04:12:36BST",
			"REQUEST_TRACKING_ID":"REQ10001",
			"CALLBACK_URL":"https://bnet.barclays.com/"
		},
		"auditContext":{
			"MODULE_ID":"B.Net Login Module",
			"IS_FINANCIAL_TRANSACTION":"false",
			"CLIENT_IP_ADDRESS":"35.53.180.6"
		}
	},
	"deviceRequestMap":{
		"ONLY_ACTIVE":"true",
		"OUTPUT_TYPE":"BOTH"
	}
}</con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/devicelist</con:originalUri><con:assertion type="GroovyScriptAssertion" id="5b77e101-adfc-4b9f-a929-105a043a86e4" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "sUCCESS"
assert jsonMap.deviceInfo[0].DeviceDetailMap.STATUS == "Active"</scriptText></con:configuration></con:assertion><con:assertion type="GroovyScriptAssertion" id="6350c67c-d7f2-41cb-8242-76bb55ec6e06" name="Script Assertion 1"><con:configuration><scriptText>class Example {
   static def DisplayName() {
      println("This is how methods work in groovy");
      println("This is an example of a simple method");
   } 
	
   static void main(String[] args) {
      DisplayName();
   } 
}</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="groovy" name="Groovy Script" id="545e4821-ea81-4783-a3ec-c0f9e24a7812"><con:settings/><con:config><script>import groovy.json.JsonSlurper 
//def response = messageExchange.response.responseContent
//def slurper = new JsonSlurper()
//def jsonMap = slurper.parseText response



class Example {
   static def DisplayName() {
      println("This is how methods work in groovy");
      println("This is an example of a simple method");
   } 
	
   static void main(String[] args) {
      DisplayName();
   } 
}


</script></con:config></con:testStep><con:properties/></con:testCase><con:testCase id="ed84ce2c-2568-4a4b-8089-d59f4c125039" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="TestCase 1.2-GetDeviceList-NO_DATA_FOUND" searchProperties="true"><con:settings/><con:testStep type="restrequest" name="GetDeviceList-NO_DATA_FOUND" id="acf1537b-bbc7-482d-8759-00bdfbc8f088"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" methodName="Devicelist" resourcePath="/generic-security-rs/devicelist" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="GetDeviceList-NO_DATA_FOUND" id="342ca3e0-16fb-45fd-8375-e796626ecacc" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request>{
	"gssRequestHeader":{
		"serviceContext":{
			"USER_AGENT":"Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
			"APPLICATION":"MEHTA"
		},
		"securityContext":null,
		"requestContext":{
			"REQUEST_TIMESTAMP":"2011-06-14T04:12:36BST",
			"REQUEST_TRACKING_ID":"REQ10001",
			"CALLBACK_URL":"https://bnet.barclays.com/"
		},
		"auditContext":{
			"MODULE_ID":"B.Net Login Module",
			"IS_FINANCIAL_TRANSACTION":"false",
			"CLIENT_IP_ADDRESS":"35.53.180.6"
		}
	},
	"deviceRequestMap":{
		"ONLY_ACTIVE":"true",
		"OUTPUT_TYPE":"BOTH"
	}
}</con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/devicelist</con:originalUri><con:assertion type="GroovyScriptAssertion" id="a9530c3d-fe56-4c91-a605-7f157f68a301" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "ERROR"


assert jsonMap.gssResponseHeader.gssError.errorCode == "NO_DATA_FOUND"


assert jsonMap.gssResponseHeader.gssError.errorMsg == "No devices supporting the coarse grained filter"
</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:properties/></con:testCase><con:testCase id="3c1f339d-48f2-4afd-891e-76dab217fb8d" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="TestCase 1.3-GetDeviceList-INSUFFICIENT_PARAMETER" searchProperties="true"><con:settings/><con:testStep type="restrequest" name="GetDeviceList-INSUFFICIENT_PARAMETER" id="dbe4232e-60fc-4c8b-b712-d92a5674d614"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" methodName="Devicelist" resourcePath="/generic-security-rs/devicelist" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="GetDeviceList-INSUFFICIENT_PARAMETER" id="342ca3e0-16fb-45fd-8375-e796626ecacc" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request>{
	"gssRequestHeader":{
		"serviceContext":{
			"":"Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
			"APPLICATION":"B.NET"
		},
		"securityContext":null,
		"requestContext":{
			"REQUEST_TIMESTAMP":"2011-06-14T04:12:36BST",
			"REQUEST_TRACKING_ID":"REQ10001",
			"CALLBACK_URL":"https://bnet.barclays.com/"
		},
		"auditContext":{
			"MODULE_ID":"B.Net Login Module",
			"IS_FINANCIAL_TRANSACTION":"false",
			"CLIENT_IP_ADDRESS":"35.53.180.6"
		}
	},
	"deviceRequestMap":{
		"ONLY_ACTIVE":"true",
		"OUTPUT_TYPE":"BOTH"
	}
}</con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/devicelist</con:originalUri><con:assertion type="GroovyScriptAssertion" id="7683318c-824f-4e96-8a27-c1ea63fed924" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "ERROR"


assert jsonMap.gssResponseHeader.gssError.errorCode == "INSUFFICIENT_PARAMETERS"


assert jsonMap.gssResponseHeader.gssError.errorMsg == "The mandatory field USER_AGENT is missing or its value is empty  in ServiceContext"
</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:properties/></con:testCase><con:testCase id="dcc7b6ad-8073-4add-9f75-45716efce0a5" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="TestCase 1.4-GetDeviceList-IncorrectObjectName" searchProperties="true"><con:settings/><con:testStep type="restrequest" name="GetDeviceList-IncorrectObjectName" id="147e1bf1-4398-4ee5-80cd-d7afc2e7127a"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" methodName="Devicelist" resourcePath="/generic-security-rs/devicelist" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="GetDeviceList-IncorrectObjectName" id="342ca3e0-16fb-45fd-8375-e796626ecacc" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:encoding>UTF-8</con:encoding><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request>{
	"gssRequestHeader":{
		"serviceContext":{
			"USER_AGENT":"Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
			"APPLICATION":"B.NET"
		},
		"securityContext":null,
		"-requestContext":{
			"REQUEST_TIMESTAMP":"2011-06-14T04:12:36BST",
			"REQUEST_TRACKING_ID":"REQ10001",
			"CALLBACK_URL":"https://bnet.barclays.com/"
		},
		"auditContext":{
			"MODULE_ID":"B.Net Login Module",
			"IS_FINANCIAL_TRANSACTION":"false",
			"CLIENT_IP_ADDRESS":"35.53.180.6"
		}
	},
	"deviceRequestMap":{
		"ONLY_ACTIVE":"true",
		"OUTPUT_TYPE":"BOTH"
	}
}</con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/devicelist</con:originalUri><con:assertion type="Simple NotContains" id="1ad8bf01-f37d-4718-b3a2-ef98954c3cbb" name="Not Contains"><con:configuration><token>SUCCESS</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:properties/></con:testCase><con:testCase id="d0664dcc-175a-4bd5-9230-8fe32b9964ad" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="TestCase 2.1-Login-HappyFlow" searchProperties="true"><con:settings/><con:testStep type="restrequest" name="GetDeviceList" id="0b2df073-6020-4e26-adf0-8869cba96f46"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/devicelist" methodName="Devicelist" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="GetDeviceList" id="b063e9a0-5f4c-484f-b84a-038d96c080c1" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request>{
	"gssRequestHeader":{
		"serviceContext":{
			"USER_AGENT":"Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
			"APPLICATION":"B.NET"
		},
		"securityContext":null,
		"requestContext":{
			"REQUEST_TIMESTAMP":"2011-06-14T04:12:36BST",
			"REQUEST_TRACKING_ID":"REQ10001",
			"CALLBACK_URL":"https://bnet.barclays.com/"
		},
		"auditContext":{
			"MODULE_ID":"B.Net Login Module",
			"IS_FINANCIAL_TRANSACTION":"false",
			"CLIENT_IP_ADDRESS":"35.53.180.6"
		}
	},
	"deviceRequestMap":{
		"ONLY_ACTIVE":"true",
		"OUTPUT_TYPE":"BOTH"
	}
}</con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/devicelist</con:originalUri><con:assertion type="GroovyScriptAssertion" id="6c166ddf-cdfe-4189-9b56-bea28374973b" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "SUCCESS"
assert jsonMap.deviceInfo[0].DeviceDetailMap.STATUS == "Active"</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-GetDeviceList" id="101697b9-75b8-4d35-b28d-b2a3f5742a72"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-SC</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>GetDeviceList</con:sourceStep><con:sourcePath>gssResponseHeader.securityContext</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>InitiateLogin</con:targetStep><con:targetPath>initiateRequestHeader.gssRequestHeader.securityContext</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="restrequest" name="InitiateLogin" id="a7771706-1651-4dc5-b2db-a1ad8f5c0aaf"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/initiate" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="InitiateLogin" id="45730af7-4d98-41bd-a00f-24929dff6304" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request>{
   "transactionItemList": [],
   "preFormattedData": "VGhpcyBpcyBhIHNhbXBsZSBvZiBwcmVmb3JtYXR0ZWQgZGF0YSwgY3JlYXRlZCBvbiAyNy8wMy8yMDE1Lg==",
   "initiateRequestHeader":    {
      "gssRequestHeader":       {
         "serviceContext":          {
            "PURN_TYPE": "pki",
            "USER_AGENT": "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
            "PURN": "99800000008804000050",
            "APPLICATION": "B.NET"
         },
         "auditContext":          {
            "MODULE_ID": "B.Net Login Module",
            "IS_FINANCIAL_TRANSACTION": "false",
            "CLIENT_IP_ADDRESS": "35.53.180.6"
         },
         "requestContext":          {
            "REQUEST_TIMESTAMP": "2011-06-14T04:12:36BST",
            "REQUEST_TRACKING_ID": "REQ10001",
            "CALLBACK_URL": "https://bnet.barclays.com/"
         },
         "securityContext": "eyJVU0VSX0FHRU5UIjoiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgNi4xOyBXT1c2NDsgVHJpZGVudC83LjA7IEFTOyBydjoxMS4wKSBsaWtlIEdlY2tvIiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IlBVIn0="
      },
      "initiateRequestHeaderDetails":       {
         "FUNCTION_TYPE": "AUTHENTICATE",
         "ACTION_TYPE": "SUBMIT",
         "DEVICE_TYPE_CODE": "SC",
         "OUTPUT_TYPE": "HTML"
      }
   },
   "requestDetailsMap": {}
}</con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/initiate</con:originalUri><con:assertion type="GroovyScriptAssertion" id="3f2a7f7f-4150-4f59-b57e-eddb93b59884" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "SUCCESS"
assert jsonMap.gssResponseHeader.responseContext.NEXTACTION == "VERIFY"</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Login_SecurityContext" id="644174cf-f624-4dd2-a905-91178889d0d8"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>SGG-SC</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateLogin</con:sourceStep><con:sourcePath>gssResponseHeader.securityContext</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifyLogin</con:targetStep><con:targetPath>gssRequestHeader.securityContext</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Login_GSS-Nonce" id="7876b89d-d42a-4df4-a617-2e1487721f84"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-NONCE</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateLogin</con:sourceStep><con:sourcePath>gssResponseHeader.responseContext.GSS_NONCE</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifyLogin</con:targetStep><con:targetPath>gssRequestHeader.requestContext.GSS_NONCE</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Login_GSS-Ref-ID" id="b59ab128-6c6f-4b35-a29a-f54ab3ef3c70"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-REF-ID</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateLogin</con:sourceStep><con:sourcePath>initiateResponseDetailsMap.GSS_REFERENCE_ID</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifyLogin</con:targetStep><con:targetPath>verifyDetailMap.GSS_REFERENCE_ID</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="restrequest" name="VerifyLogin" id="d6c311d9-92db-4def-8c13-95dee6f32c05"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/verify" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="VerifyLogin" id="ae8cc01d-5b14-46b5-8fa6-6207c40ac5af" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request><![CDATA[{
   "verifyDetailMap": {"GSS_REFERENCE_ID": "98EDA53FBC364A079BCB11230EBF29BF"},
   "gssRequestHeader":    {
      "serviceContext":       {
         "USER_AGENT": "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
         "APPLICATION": "B.NET"
      },
      "auditContext":       {
         "MODULE_ID": "B.Net Login Module",
         "IS_FINANCIAL_TRANSACTION": "false",
         "CLIENT_IP_ADDRESS": "35.53.180.6"
      },
      "requestContext":       {
         "REQUEST_TIMESTAMP": "2011-06-14T04:12:36BST",
         "REQUEST_TRACKING_ID": "REQ10001",
         "CALLBACK_URL": "https://bnet.barclays.com/",
         "GSS_NONCE": "f1bac328-ad45-438b-ba03-ff3804bef8f0"
      },
      "securityContext": "eyJQVVJOX1RZUEUiOiJwa2kiLCJQVVJOIjoiOTk4MDAwMDAwMDg4MDQwMDAwNTAiLCJVU0VSX0FHRU5UIjoiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgNi4xOyBXT1c2NDsgVHJpZGVudC83LjA7IEFTOyBydjoxMS4wKSBsaWtlIEdlY2tvIiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIkRFVklDRV9UWVBFX0NPREUiOiJTQyIsIlJFR0lPTiI6IkdCIiwiR1NTX1JFRkVSRU5DRV9JRCI6Ijk4RURBNTNGQkMzNjRBMDc5QkNCMTEyMzBFQkYyOUJGIn0="
   },
   "deviceParamMap":    {
      "HTTP_METHOD": "PUT",
      "HTTP_INPUT_CONTENTS": "Version_Spec=100&amp;Version_Plugin_Major=3&amp;Version_Plugin_Minor=0&amp;Version_Browser_Major=0&amp;Version_Browser_Minor=11&amp;Transaction_ID=7a4a1763-0ac0-4fb7-9d98-e6053e95d191401141426801730&amp;Signature_Data=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&amp;Signature_Format=PKCS7_basic&amp;IsDetailScrAction=false&amp;pd=F0263A0E242E4C94B60DD204F44B6CAB&amp;gssRefId=7a4a1763-0ac0-4fb7-9d98-e6053e95d191401141426801730&amp;gssStore=true"
   }
}]]></con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/verify</con:originalUri><con:assertion type="GroovyScriptAssertion" id="b2b9bd53-4cd9-4378-ad3e-a47f8bc3793c" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "SUCCESS"
assert jsonMap.gssResponseHeader.responseContext.NEXTACTION == "COMPLETE"</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:properties/></con:testCase><con:testCase id="e6029053-3b79-4ed4-8726-b78a60a2db66" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="TestCase 2.2-Login-Invalid_Ref_ID" searchProperties="true"><con:settings/><con:testStep type="restrequest" name="GetDeviceList" id="a3e4e62a-70aa-48cc-b8e8-a55dafba2207"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/devicelist" methodName="Devicelist" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="GetDeviceList" id="b063e9a0-5f4c-484f-b84a-038d96c080c1" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request>{
	"gssRequestHeader":{
		"serviceContext":{
			"USER_AGENT":"Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
			"APPLICATION":"B.NET"
		},
		"securityContext":null,
		"requestContext":{
			"REQUEST_TIMESTAMP":"2011-06-14T04:12:36BST",
			"REQUEST_TRACKING_ID":"REQ10001",
			"CALLBACK_URL":"https://bnet.barclays.com/"
		},
		"auditContext":{
			"MODULE_ID":"B.Net Login Module",
			"IS_FINANCIAL_TRANSACTION":"false",
			"CLIENT_IP_ADDRESS":"35.53.180.6"
		}
	},
	"deviceRequestMap":{
		"ONLY_ACTIVE":"true",
		"OUTPUT_TYPE":"BOTH"
	}
}</con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/devicelist</con:originalUri><con:assertion type="GroovyScriptAssertion" id="6c166ddf-cdfe-4189-9b56-bea28374973b" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "SUCCESS"
assert jsonMap.deviceInfo[0].DeviceDetailMap.STATUS == "Active"</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-GetDeviceList" id="fce44b81-83e8-4970-b8fe-6bca82149638"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-SC</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>GetDeviceList</con:sourceStep><con:sourcePath>gssResponseHeader.securityContext</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>InitiateLogin</con:targetStep><con:targetPath>initiateRequestHeader.gssRequestHeader.securityContext</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="restrequest" name="InitiateLogin" id="a5373e4f-730b-4ce7-8292-88c67e5faf74"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/initiate" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="InitiateLogin" id="45730af7-4d98-41bd-a00f-24929dff6304" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request>{
   "transactionItemList": [],
   "preFormattedData": "VGhpcyBpcyBhIHNhbXBsZSBvZiBwcmVmb3JtYXR0ZWQgZGF0YSwgY3JlYXRlZCBvbiAyNy8wMy8yMDE1Lg==",
   "initiateRequestHeader":    {
      "gssRequestHeader":       {
         "serviceContext":          {
            "PURN_TYPE": "pki",
            "PURN": "99800000008804000050",
            "USER_AGENT": "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
            "APPLICATION": "B.NET"
         },
         "auditContext":          {
            "MODULE_ID": "12345678901234567890123456789012345678901",
            "IS_FINANCIAL_TRANSACTION": "false",
            "SUB_MODULE_ID": "eyJVU0VSX0FHRU5UIjoiSUU4IiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IkdCIn0=",
            "SUBMODULE_ID": "eyJVU0VSX0FHRU5UIjoiSUU4IiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IkdCIn0=",
            "CLIENT_IP_ADDRESS": "35.53.180.6"
         },
         "requestContext":          {
            "REQUEST_TIMESTAMP": "2011-06-14T04:12:36BST",
            "REQUEST_TRACKING_ID": "REQ10001",
            "CALLBACK_URL": "https://bnet.barclays.com/"
         },
         "securityContext": "eyJVU0VSX0FHRU5UIjoiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgNi4xOyBXT1c2NDsgVHJpZGVudC83LjA7IEFTOyBydjoxMS4wKSBsaWtlIEdlY2tvIiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IlBVIn0="
      },
      "initiateRequestHeaderDetails":       {
         "FUNCTION_TYPE": "AUTHENTICATE",
         "ACTION_TYPE": "SUBMIT",
         "DEVICE_TYPE_CODE": "SC",
         "OUTPUT_TYPE": "HTML"
      }
   },
   "requestDetailsMap": {}
}</con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/initiate</con:originalUri><con:assertion type="GroovyScriptAssertion" id="3f2a7f7f-4150-4f59-b57e-eddb93b59884" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "SUCCESS"
assert jsonMap.gssResponseHeader.responseContext.NEXTACTION == "VERIFY"</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Login_SecurityContext" id="b89d4c0a-a934-4024-b174-c7c6404b1183"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>SGG-SC</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateLogin</con:sourceStep><con:sourcePath>gssResponseHeader.securityContext</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifyLogin</con:targetStep><con:targetPath>gssRequestHeader.securityContext</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Login_GSS-Nonce" id="027b22a0-e44a-41c4-8e7d-0df0f9e83506"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-NONCE</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateLogin</con:sourceStep><con:sourcePath>gssResponseHeader.responseContext.GSS_NONCE</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifyLogin</con:targetStep><con:targetPath>gssRequestHeader.requestContext.GSS_NONCE</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Login_GSS-Ref-ID" id="6c9f27ed-b271-4fee-9004-a3c62d3e1ab1" disabled="true"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-REF-ID</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateLogin</con:sourceStep><con:sourcePath>initiateResponseDetailsMap.GSS_REFERENCE_ID</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifyLogin</con:targetStep><con:targetPath>verifyDetailMap.GSS_REFERENCE_ID</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="restrequest" name="VerifyLogin" id="6967aa49-4673-4997-b06c-c937944f49b8"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/verify" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="VerifyLogin" id="ae8cc01d-5b14-46b5-8fa6-6207c40ac5af" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request><![CDATA[{
   "verifyDetailMap": {"GSS_REFERENCE_ID": "3A9612BD91D64C80AACA5701A3568128"},
   "gssRequestHeader":    {
      "serviceContext":       {
         "USER_AGENT": "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
         "APPLICATION": "B.NET"
      },
      "auditContext":       {
         "MODULE_ID": "B.Net Login Module",
         "IS_FINANCIAL_TRANSACTION": "false",
         "CLIENT_IP_ADDRESS": "35.53.180.6"
      },
      "requestContext":       {
         "REQUEST_TIMESTAMP": "2011-06-14T04:12:36BST",
         "REQUEST_TRACKING_ID": "REQ10001",
         "CALLBACK_URL": "https://bnet.barclays.com/",
         "GSS_NONCE": "f4a51b0a-5db3-4c2c-a308-bb0406f870e5"
      },
      "securityContext": "eyJQVVJOX1RZUEUiOiJwa2kiLCJQVVJOIjoiOTk4MDAwMDAwMDg4MDQwMDAwNTAiLCJVU0VSX0FHRU5UIjoiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgNi4xOyBXT1c2NDsgVHJpZGVudC83LjA7IEFTOyBydjoxMS4wKSBsaWtlIEdlY2tvIiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIkRFVklDRV9UWVBFX0NPREUiOiJTQyIsIlJFR0lPTiI6IkdCIiwiR1NTX1JFRkVSRU5DRV9JRCI6IjRGREE1NEYzQjM5ODQ4NEI5RDI2ODRCQzcwQTJFQjhFIn0="
   },
   "deviceParamMap":    {
      "HTTP_METHOD": "PUT",
      "HTTP_INPUT_CONTENTS": "Version_Spec=100&amp;Version_Plugin_Major=3&amp;Version_Plugin_Minor=0&amp;Version_Browser_Major=0&amp;Version_Browser_Minor=11&amp;Transaction_ID=7a4a1763-0ac0-4fb7-9d98-e6053e95d191401141426801730&amp;Signature_Data=MIIPZgYJKoZIhvcNAQcCoIIPVzCCD1MCAQExCzAJBgUrDgMCGgUAMIID2wYJKoZIhvcNAQcBoIIDzASCA8hDbGllbnQgTmFtZTogICAgICAgICAgICAgICAgICAgICAgICBURVNUSU5HIENPTVBBTlkgICAgICAgICAgICAgICAgICAgICAgIA0KRG9jdW1lbnQgSUQ6ICAgICAgICAgICAgICAgICAgICAgICAgRjAyNjNBMEUyNDJFNEM5NEI2MEREMjA0RjQ0QjZDQUINClNpZ24gYW5kIFN1Ym1pdCB0aGUgZm9sbG93aW5nIHRyYW5zYWN0aW9ucyAoMSkNCg0KUGF5bWVudCBUeXBlOiAgICAgICAgICAgICAgICAgICAgICAgRG9tZXN0aWMgUGF5bWVudA0KRGVsaXZlcnkgT3B0aW9uOiAgICAgICAgICAgICAgICAgICAgVUsgVGhyZWUgRGF5IFBheW1lbnQNCkRlYml0IEFjY291bnQgQmFuayBJZGVudGlmaWVyOiAgICAgIDA5MDA2Mw0KRGViaXQgQWNjb3VudCBOdW1iZXI6ICAgICAgICAgICAgICAgMDMwNDE0MDENCkRlYml0IEFjY291bnQgQ3VycmVuY3k6ICAgICAgICAgICAgIFBvdW5kIFN0ZXJsaW5nDQpQYXltZW50IEN1cnJlbmN5OiAgICAgICAgICAgICAgICAgICBQb3VuZCBTdGVybGluZw0KUGF5bWVudCBBbW91bnQ6ICAgICAgICAgICAgICAgICAgICAgMjYwMC4wMA0KVHJhbnNhY3Rpb24gUmVmZXJlbmNlIE51bWJlcjogICAgICAgQlgxNTA0MjAwNjkzMjYwNw0KVmFsdWUgRGF0ZTogICAgICAgICAgICAgICAgICAgICAgICAgQXByIDI0LCAyMDE1DQpDdXN0b21lciBSZWZlcmVuY2U6ICAgICAgICAgICAgICAgICAxMjMxMjMxMjMNCk51bWJlciBvZiBjcmVkaXQvZGViaXQgcmVjb3JkczoJICAgIDENCg0KQmVuZWZpY2lhcnkgTmFtZTogICAgICAgICAgICAgICAgICAgMTM0MjM0MjMNCkJlbmVmaWNpYXJ5IEFjY291bnQgQmFuayBJZGVudGlmaWVyOjE4NTAwOA0KQmVuZWZpY2lh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&amp;Signature_Format=PKCS7_basic&amp;IsDetailScrAction=false&amp;pd=F0263A0E242E4C94B60DD204F44B6CAB&amp;gssRefId=7a4a1763-0ac0-4fb7-9d98-e6053e95d191401141426801730&amp;gssStore=true"
   }
}]]></con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/verify</con:originalUri><con:assertion type="GroovyScriptAssertion" id="b2b9bd53-4cd9-4378-ad3e-a47f8bc3793c" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "ERROR"


assert jsonMap.gssResponseHeader.gssError.errorCode == "INVALID_REFERENCE_ID"


assert jsonMap.gssResponseHeader.gssError.errorMsg == "Reference id is invalid or null"
</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:properties/></con:testCase><con:testCase id="b2ede684-9bfd-484b-baaf-a0f2cf7d0dd4" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="TestCase 2.3-Login-Invalid_Nonce" searchProperties="true"><con:settings/><con:testStep type="restrequest" name="GetDeviceList" id="3a9b2a1f-f439-4e8b-b55b-cc8918f1387d"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/devicelist" methodName="Devicelist" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="GetDeviceList" id="b063e9a0-5f4c-484f-b84a-038d96c080c1" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request>{
	"gssRequestHeader":{
		"serviceContext":{
			"USER_AGENT":"Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
			"APPLICATION":"B.NET"
		},
		"securityContext":null,
		"requestContext":{
			"REQUEST_TIMESTAMP":"2011-06-14T04:12:36BST",
			"REQUEST_TRACKING_ID":"REQ10001",
			"CALLBACK_URL":"https://bnet.barclays.com/"
		},
		"auditContext":{
			"MODULE_ID":"B.Net Login Module",
			"IS_FINANCIAL_TRANSACTION":"false",
			"CLIENT_IP_ADDRESS":"35.53.180.6"
		}
	},
	"deviceRequestMap":{
		"ONLY_ACTIVE":"true",
		"OUTPUT_TYPE":"BOTH"
	}
}</con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/devicelist</con:originalUri><con:assertion type="GroovyScriptAssertion" id="6c166ddf-cdfe-4189-9b56-bea28374973b" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "SUCCESS"
assert jsonMap.deviceInfo[0].DeviceDetailMap.STATUS == "Active"</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-GetDeviceList" id="fb52129c-0b80-4729-a6e7-75ca77de5e6d"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-SC</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>GetDeviceList</con:sourceStep><con:sourcePath>gssResponseHeader.securityContext</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>InitiateLogin</con:targetStep><con:targetPath>initiateRequestHeader.gssRequestHeader.securityContext</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="restrequest" name="InitiateLogin" id="b4d028a8-6684-4c9f-a614-35a99095a2d3"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/initiate" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="InitiateLogin" id="45730af7-4d98-41bd-a00f-24929dff6304" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request>{
   "transactionItemList": [],
   "preFormattedData": "VGhpcyBpcyBhIHNhbXBsZSBvZiBwcmVmb3JtYXR0ZWQgZGF0YSwgY3JlYXRlZCBvbiAyNy8wMy8yMDE1Lg==",
   "initiateRequestHeader":    {
      "gssRequestHeader":       {
         "serviceContext":          {
            "PURN_TYPE": "pki",
            "PURN": "99800000008804000050",
            "USER_AGENT": "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
            "APPLICATION": "B.NET"
         },
         "auditContext":          {
            "MODULE_ID": "12345678901234567890123456789012345678901",
            "IS_FINANCIAL_TRANSACTION": "false",
            "SUB_MODULE_ID": "eyJVU0VSX0FHRU5UIjoiSUU4IiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IkdCIn0=",
            "SUBMODULE_ID": "eyJVU0VSX0FHRU5UIjoiSUU4IiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IkdCIn0=",
            "CLIENT_IP_ADDRESS": "35.53.180.6"
         },
         "requestContext":          {
            "REQUEST_TIMESTAMP": "2011-06-14T04:12:36BST",
            "REQUEST_TRACKING_ID": "REQ10001",
            "CALLBACK_URL": "https://bnet.barclays.com/"
         },
         "securityContext": "eyJVU0VSX0FHRU5UIjoiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgNi4xOyBXT1c2NDsgVHJpZGVudC83LjA7IEFTOyBydjoxMS4wKSBsaWtlIEdlY2tvIiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IlBVIn0="
      },
      "initiateRequestHeaderDetails":       {
         "FUNCTION_TYPE": "AUTHENTICATE",
         "ACTION_TYPE": "SUBMIT",
         "DEVICE_TYPE_CODE": "SC",
         "OUTPUT_TYPE": "HTML"
      }
   },
   "requestDetailsMap": {}
}</con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/initiate</con:originalUri><con:assertion type="GroovyScriptAssertion" id="3f2a7f7f-4150-4f59-b57e-eddb93b59884" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "SUCCESS"
assert jsonMap.gssResponseHeader.responseContext.NEXTACTION == "VERIFY"</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Login_SecurityContext" id="da78af3e-e469-4d44-b3b8-30301ef0cba6"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>SGG-SC</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateLogin</con:sourceStep><con:sourcePath>gssResponseHeader.securityContext</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifyLogin</con:targetStep><con:targetPath>gssRequestHeader.securityContext</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Login_GSS-Nonce" id="dec5d9ab-b840-42b2-97a4-8762794c8e75" disabled="true"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-NONCE</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateLogin</con:sourceStep><con:sourcePath>gssResponseHeader.responseContext.GSS_NONCE</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifyLogin</con:targetStep><con:targetPath>gssRequestHeader.requestContext.GSS_NONCE</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Login_GSS-Ref-ID" id="74bee002-0343-4af3-a3a0-8ded2eae2114"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-REF-ID</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateLogin</con:sourceStep><con:sourcePath>initiateResponseDetailsMap.GSS_REFERENCE_ID</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifyLogin</con:targetStep><con:targetPath>verifyDetailMap.GSS_REFERENCE_ID</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="restrequest" name="VerifyLogin" id="90b53e08-0dac-45d0-8502-6f3e095df5b5"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/verify" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="VerifyLogin" id="ae8cc01d-5b14-46b5-8fa6-6207c40ac5af" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request><![CDATA[{
   "verifyDetailMap": {"GSS_REFERENCE_ID": "270E750BA6B444228893A5017063AC23"},
   "gssRequestHeader":    {
      "serviceContext":       {
         "USER_AGENT": "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
         "APPLICATION": "B.NET"
      },
      "auditContext":       {
         "MODULE_ID": "B.Net Login Module",
         "IS_FINANCIAL_TRANSACTION": "false",
         "CLIENT_IP_ADDRESS": "35.53.180.6"
      },
      "requestContext":       {
         "REQUEST_TIMESTAMP": "2011-06-14T04:12:36BST",
         "REQUEST_TRACKING_ID": "REQ10001",
         "CALLBACK_URL": "https://bnet.barclays.com/",
         "GSS_NONCE": "3d11623a-6c84-4060-979f-53df099e14d0"
      },
      "securityContext": "eyJQVVJOX1RZUEUiOiJwa2kiLCJQVVJOIjoiOTk4MDAwMDAwMDg4MDQwMDAwNTAiLCJVU0VSX0FHRU5UIjoiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgNi4xOyBXT1c2NDsgVHJpZGVudC83LjA7IEFTOyBydjoxMS4wKSBsaWtlIEdlY2tvIiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIkRFVklDRV9UWVBFX0NPREUiOiJTQyIsIlJFR0lPTiI6IkdCIiwiR1NTX1JFRkVSRU5DRV9JRCI6IjI3MEU3NTBCQTZCNDQ0MjI4ODkzQTUwMTcwNjNBQzIzIn0="
   },
   "deviceParamMap":    {
      "HTTP_METHOD": "PUT",
      "HTTP_INPUT_CONTENTS": "Version_Spec=100&amp;Version_Plugin_Major=3&amp;Version_Plugin_Minor=0&amp;Version_Browser_Major=0&amp;Version_Browser_Minor=11&amp;Transaction_ID=7a4a1763-0ac0-4fb7-9d98-e6053e95d191401141426801730&amp;Signature_Data=MIIPZgYJKoZIhvcNAQcCoIIPVzCCD1MCAQExCzAJBgUrDgMCGgUAMIID2wYJKoZIhvcNAQcBoIIDzASCA8hDbGllbnQgTmFtZTogICAgICAgICAgICAgICAgICAgICAgICBURVNUSU5HIENPTVBBTlkgICAgICAgICAgICAgICAgICAgICAgIA0KRG9jdW1lbnQgSUQ6ICAgICAgICAgICAgICAgICAgICAgICAgRjAyNjNBMEUyNDJFNEM5NEI2MEREMjA0RjQ0QjZDQUINClNpZ24gYW5kIFN1Ym1pdCB0aGUgZm9sbG93aW5nIHRyYW5zYWN0aW9ucyAoMSkNCg0KUGF5bWVudCBUeXBlOiAgICAgICAgICAgICAgICAgICAgICAgRG9tZXN0aWMgUGF5bWVudA0KRGVsaXZlcnkgT3B0aW9uOiAgICAgICAgICAgICAgICAgICAgVUsgVGhyZWUgRGF5IFBheW1lbnQNCkRlYml0IEFjY291bnQgQmFuayBJZGVudGlmaWVyOiAgICAgIDA5MDA2Mw0KRGViaXQgQWNjb3VudCBOdW1iZXI6ICAgICAgICAgICAgICAgMDMwNDE0MDENCkRlYml0IEFjY291bnQgQ3VycmVuY3k6ICAgICAgICAgICAgIFBvdW5kIFN0ZXJsaW5nDQpQYXltZW50IEN1cnJlbmN5OiAgICAgICAgICAgICAgICAgICBQb3VuZCBTdGVybGluZw0KUGF5bWVudCBBbW91bnQ6ICAgICAgICAgICAgICAgICAgICAgMjYwMC4wMA0KVHJhbnNhY3Rpb24gUmVmZXJlbmNlIE51bWJlcjogICAgICAgQlgxNTA0MjAwNjkzMjYwNw0KVmFsdWUgRGF0ZTogICAgICAgICAgICAgICAgICAgICAgICAgQXByIDI0LCAyMDE1DQpDdXN0b21lciBSZWZlcmVuY2U6ICAgICAgICAgICAgICAgICAxMjMxMjMxMjMNCk51bWJlciBvZiBjcmVkaXQvZGViaXQgcmVjb3JkczoJICAgIDENCg0KQmVuZWZpY2lhcnkgTmFtZTogICAgICAgICAgICAgICAgICAgMTM0MjM0MjMNCkJlbmVmaWNpYXJ5IEFjY291bnQgQmFuayBJZGVudGlmaWVyOjE4NTAwOA0KQmVuZWZpY2lh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&amp;Signature_Format=PKCS7_basic&amp;IsDetailScrAction=false&amp;pd=F0263A0E242E4C94B60DD204F44B6CAB&amp;gssRefId=7a4a1763-0ac0-4fb7-9d98-e6053e95d191401141426801730&amp;gssStore=true"
   }
}]]></con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/verify</con:originalUri><con:assertion type="GroovyScriptAssertion" id="b2b9bd53-4cd9-4378-ad3e-a47f8bc3793c" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "ERROR"


assert jsonMap.gssResponseHeader.gssError.errorCode == "ILLEGAL_DATA_MODIFICATION"


assert jsonMap.gssResponseHeader.gssError.errorMsg == "User tried to modify Nonce"
</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:properties/></con:testCase><con:testCase id="ca44b6f0-03b8-42c2-aebf-8604d24f15ce" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="TestCase 2.4-Login-Invalid_Security_Context" searchProperties="true"><con:settings/><con:testStep type="restrequest" name="GetDeviceList" id="887f167d-5fb3-47ea-a252-56f42d408c83" disabled="true"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/devicelist" methodName="Devicelist" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="GetDeviceList" id="b063e9a0-5f4c-484f-b84a-038d96c080c1" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request>{
	"gssRequestHeader":{
		"serviceContext":{
			"USER_AGENT":"Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
			"APPLICATION":"B.NET"
		},
		"securityContext":null,
		"requestContext":{
			"REQUEST_TIMESTAMP":"2011-06-14T04:12:36BST",
			"REQUEST_TRACKING_ID":"REQ10001",
			"CALLBACK_URL":"https://bnet.barclays.com/"
		},
		"auditContext":{
			"MODULE_ID":"B.Net Login Module",
			"IS_FINANCIAL_TRANSACTION":"false",
			"CLIENT_IP_ADDRESS":"35.53.180.6"
		}
	},
	"deviceRequestMap":{
		"ONLY_ACTIVE":"true",
		"OUTPUT_TYPE":"BOTH"
	}
}</con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/devicelist</con:originalUri><con:assertion type="GroovyScriptAssertion" id="6c166ddf-cdfe-4189-9b56-bea28374973b" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "SUCCESS"
assert jsonMap.deviceInfo[0].DeviceDetailMap.STATUS == "Active"</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-GetDeviceList" id="70eab84f-dd11-422b-a347-d434a5081538" disabled="true"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-SC</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>GetDeviceList</con:sourceStep><con:sourcePath>gssResponseHeader.securityContext</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>InitiateLogin</con:targetStep><con:targetPath>initiateRequestHeader.gssRequestHeader.securityContext</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="restrequest" name="InitiateLogin" id="7e13d9f2-5146-44f0-b2e8-979196309d99"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/initiate" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="InitiateLogin" id="45730af7-4d98-41bd-a00f-24929dff6304" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request>{
   "transactionItemList": [],
   "preFormattedData": "VGhpcyBpcyBhIHNhbXBsZSBvZiBwcmVmb3JtYXR0ZWQgZGF0YSwgY3JlYXRlZCBvbiAyNy8wMy8yMDE1Lg==",
   "initiateRequestHeader":    {
      "gssRequestHeader":       {
         "serviceContext":          {
            "PURN_TYPE": "pki",
            "USER_AGENT": "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
            "PURN": "99800000008804000050",
            "APPLICATION": "B.NET"
         },
         "auditContext":          {
            "MODULE_ID": "12345678901234567890123456789012345678901",
            "IS_FINANCIAL_TRANSACTION": "false",
            "SUB_MODULE_ID": "eyJVU0VSX0FHRU5UIjoiSUU4IiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IkdCIn0=",
            "SUBMODULE_ID": "eyJVU0VSX0FHRU5UIjoiSUU4IiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IkdCIn0=",
            "CLIENT_IP_ADDRESS": "35.53.180.6"
         },
         "requestContext":          {
            "REQUEST_TIMESTAMP": "2011-06-14T04:12:36BST",
            "REQUEST_TRACKING_ID": "REQ10001",
            "CALLBACK_URL": "https://bnet.barclays.com/"
         },
         "securityContext": "eyJVU0VSX0FHRU5UIjoiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgNi4xOyBXT1c2NDsgVHJpZGVudC83LjA7IEFTOyBydjoxMS4wKSBsaWtlIEdlY2tvIiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IkdCIn0="
      },
      "initiateRequestHeaderDetails":       {
         "FUNCTION_TYPE": "AUTHENTICATE",
         "ACTION_TYPE": "SUBMIT",
         "DEVICE_TYPE_CODE": "SC",
         "OUTPUT_TYPE": "HTML"
      }
   },
   "requestDetailsMap": {}
}</con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/initiate</con:originalUri><con:assertion type="GroovyScriptAssertion" id="3f2a7f7f-4150-4f59-b57e-eddb93b59884" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "SUCCESS"
assert jsonMap.gssResponseHeader.responseContext.NEXTACTION == "VERIFY"</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Login_SecurityContext" id="956925c6-9ef0-414c-893c-d8a4ba745be9" disabled="true"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>SGG-SC</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateLogin</con:sourceStep><con:sourcePath>gssResponseHeader.securityContext</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifyLogin</con:targetStep><con:targetPath>gssRequestHeader.securityContext</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Login_GSS-Nonce" id="7c495a21-1a7b-4248-a6fc-f6e8387ad342"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-NONCE</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateLogin</con:sourceStep><con:sourcePath>gssResponseHeader.responseContext.GSS_NONCE</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifyLogin</con:targetStep><con:targetPath>gssRequestHeader.requestContext.GSS_NONCE</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Login_GSS-Ref-ID" id="d3ad7087-4f68-4613-a73a-2bb1ce37f6e5"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-REF-ID</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateLogin</con:sourceStep><con:sourcePath>initiateResponseDetailsMap.GSS_REFERENCE_ID</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifyLogin</con:targetStep><con:targetPath>verifyDetailMap.GSS_REFERENCE_ID</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="restrequest" name="VerifyLogin" id="319a4bd5-0d47-44e5-b829-95072b577000"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/verify" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="VerifyLogin" id="ae8cc01d-5b14-46b5-8fa6-6207c40ac5af" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request><![CDATA[{
   "verifyDetailMap": {"GSS_REFERENCE_ID": "D53FFE72B15943EFB9CD583E6894B378"},
   "gssRequestHeader":    {
      "serviceContext":       {
         "USER_AGENT": "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
         "APPLICATION": "B.NET"
      },
      "auditContext":       {
         "MODULE_ID": "B.Net Login Module",
         "IS_FINANCIAL_TRANSACTION": "false",
         "CLIENT_IP_ADDRESS": "35.53.180.6"
      },
      "requestContext":       {
         "REQUEST_TIMESTAMP": "2011-06-14T04:12:36BST",
         "REQUEST_TRACKING_ID": "REQ10001",
         "CALLBACK_URL": "https://bnet.barclays.com/",
         "GSS_NONCE": "3e3ab937-e316-46c4-baa9-387fd21a30ff"
      },
      "securityContext": "eyJQVVJOX1RZUEUiOiJwa2kiLCJQVVJOIjoiOTk4MDAwMDAwMDg4MDQwMDAwNTAiLCJVU0VSX0FHRU5UIjoiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgNi4xOyBXT1c2NDsgVHJpZGVudC83LjA7IEFTOyBydjoxMS4wKSBsaWtlIEdlY2tvIiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIkRFVklDRV9UWVBFX0NPREUiOiJGViIsIlJFR0lPTiI6IkdCIiwiR1NTX1JFRkVSRU5DRV9JRCI6IjNBOTYxMkJEOTFENjRDODBBQUNBNTcwMUEzNTY4MTI4In0="
   },
   "deviceParamMap":    {
      "HTTP_METHOD": "PUT",
      "HTTP_INPUT_CONTENTS": "Version_Spec=100&amp;Version_Plugin_Major=3&amp;Version_Plugin_Minor=0&amp;Version_Browser_Major=0&amp;Version_Browser_Minor=11&amp;Transaction_ID=7a4a1763-0ac0-4fb7-9d98-e6053e95d191401141426801730&amp;Signature_Data=MIIPZgYJKoZIhvcNAQcCoIIPVzCCD1MCAQExCzAJBgUrDgMCGgUAMIID2wYJKoZIhvcNAQcBoIIDzASCA8hDbGllbnQgTmFtZTogICAgICAgICAgICAgICAgICAgICAgICBURVNUSU5HIENPTVBBTlkgICAgICAgICAgICAgICAgICAgICAgIA0KRG9jdW1lbnQgSUQ6ICAgICAgICAgICAgICAgICAgICAgICAgRjAyNjNBMEUyNDJFNEM5NEI2MEREMjA0RjQ0QjZDQUINClNpZ24gYW5kIFN1Ym1pdCB0aGUgZm9sbG93aW5nIHRyYW5zYWN0aW9ucyAoMSkNCg0KUGF5bWVudCBUeXBlOiAgICAgICAgICAgICAgICAgICAgICAgRG9tZXN0aWMgUGF5bWVudA0KRGVsaXZlcnkgT3B0aW9uOiAgICAgICAgICAgICAgICAgICAgVUsgVGhyZWUgRGF5IFBheW1lbnQNCkRlYml0IEFjY291bnQgQmFuayBJZGVudGlmaWVyOiAgICAgIDA5MDA2Mw0KRGViaXQgQWNjb3VudCBOdW1iZXI6ICAgICAgICAgICAgICAgMDMwNDE0MDENCkRlYml0IEFjY291bnQgQ3VycmVuY3k6ICAgICAgICAgICAgIFBvdW5kIFN0ZXJsaW5nDQpQYXltZW50IEN1cnJlbmN5OiAgICAgICAgICAgICAgICAgICBQb3VuZCBTdGVybGluZw0KUGF5bWVudCBBbW91bnQ6ICAgICAgICAgICAgICAgICAgICAgMjYwMC4wMA0KVHJhbnNhY3Rpb24gUmVmZXJlbmNlIE51bWJlcjogICAgICAgQlgxNTA0MjAwNjkzMjYwNw0KVmFsdWUgRGF0ZTogICAgICAgICAgICAgICAgICAgICAgICAgQXByIDI0LCAyMDE1DQpDdXN0b21lciBSZWZlcmVuY2U6ICAgICAgICAgICAgICAgICAxMjMxMjMxMjMNCk51bWJlciBvZiBjcmVkaXQvZGViaXQgcmVjb3JkczoJICAgIDENCg0KQmVuZWZpY2lhcnkgTmFtZTogICAgICAgICAgICAgICAgICAgMTM0MjM0MjMNCkJlbmVmaWNpYXJ5IEFjY291bnQgQmFuayBJZGVudGlmaWVyOjE4NTAwOA0KQmVuZWZpY2lh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&amp;Signature_Format=PKCS7_basic&amp;IsDetailScrAction=false&amp;pd=F0263A0E242E4C94B60DD204F44B6CAB&amp;gssRefId=7a4a1763-0ac0-4fb7-9d98-e6053e95d191401141426801730&amp;gssStore=true"
   }
}]]></con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/verify</con:originalUri><con:assertion type="GroovyScriptAssertion" id="b2b9bd53-4cd9-4378-ad3e-a47f8bc3793c" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "ERROR"


assert jsonMap.gssResponseHeader.gssError.errorCode == "ILLEGAL_DATA_MODIFICATION"


assert jsonMap.gssResponseHeader.gssError.errorMsg == "User tried to modify SecurityContext"
</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:properties/></con:testCase><con:testCase id="497963d5-9592-4911-a269-9b4cf9eb983a" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="TestCase 2.5-Login-Invalid_Signature" searchProperties="true"><con:settings/><con:testStep type="restrequest" name="GetDeviceList" id="a8d74811-5353-4005-8f6f-eea5a5711355" disabled="true"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/devicelist" methodName="Devicelist" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="GetDeviceList" id="b063e9a0-5f4c-484f-b84a-038d96c080c1" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request>{
	"gssRequestHeader":{
		"serviceContext":{
			"USER_AGENT":"Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
			"APPLICATION":"B.NET"
		},
		"securityContext":null,
		"requestContext":{
			"REQUEST_TIMESTAMP":"2011-06-14T04:12:36BST",
			"REQUEST_TRACKING_ID":"REQ10001",
			"CALLBACK_URL":"https://bnet.barclays.com/"
		},
		"auditContext":{
			"MODULE_ID":"B.Net Login Module",
			"IS_FINANCIAL_TRANSACTION":"false",
			"CLIENT_IP_ADDRESS":"35.53.180.6"
		}
	},
	"deviceRequestMap":{
		"ONLY_ACTIVE":"true",
		"OUTPUT_TYPE":"BOTH"
	}
}</con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/devicelist</con:originalUri><con:assertion type="GroovyScriptAssertion" id="6c166ddf-cdfe-4189-9b56-bea28374973b" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "SUCCESS"
assert jsonMap.deviceInfo[0].DeviceDetailMap.STATUS == "Active"</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-GetDeviceList" id="8b61c80f-c8b8-44a0-ad57-3037d1f00443" disabled="true"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-SC</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>GetDeviceList</con:sourceStep><con:sourcePath>gssResponseHeader.securityContext</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>InitiateLogin</con:targetStep><con:targetPath>initiateRequestHeader.gssRequestHeader.securityContext</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="restrequest" name="InitiateLogin" id="b0203959-4295-44b9-830a-8a6342ec8032"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/initiate" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="InitiateLogin" id="45730af7-4d98-41bd-a00f-24929dff6304" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request>{
   "transactionItemList": [],
   "preFormattedData": "VGhpcyBpcyBhIHNhbXBsZSBvZiBwcmVmb3JtYXR0ZWQgZGF0YSwgY3JlYXRlZCBvbiAyNy8wMy8yMDE1Lg==",
   "initiateRequestHeader":    {
      "gssRequestHeader":       {
         "serviceContext":          {
            "PURN_TYPE": "pki",
            "USER_AGENT": "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
            "PURN": "99800000008804000050",
            "APPLICATION": "B.NET"
         },
         "auditContext":          {
            "MODULE_ID": "12345678901234567890123456789012345678901",
            "IS_FINANCIAL_TRANSACTION": "false",
            "SUB_MODULE_ID": "eyJVU0VSX0FHRU5UIjoiSUU4IiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IkdCIn0=",
            "SUBMODULE_ID": "eyJVU0VSX0FHRU5UIjoiSUU4IiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IkdCIn0=",
            "CLIENT_IP_ADDRESS": "35.53.180.6"
         },
         "requestContext":          {
            "REQUEST_TIMESTAMP": "2011-06-14T04:12:36BST",
            "REQUEST_TRACKING_ID": "REQ10001",
            "CALLBACK_URL": "https://bnet.barclays.com/"
         },
         "securityContext": "eyJVU0VSX0FHRU5UIjoiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgNi4xOyBXT1c2NDsgVHJpZGVudC83LjA7IEFTOyBydjoxMS4wKSBsaWtlIEdlY2tvIiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IkdCIn0="
      },
      "initiateRequestHeaderDetails":       {
         "FUNCTION_TYPE": "AUTHENTICATE",
         "ACTION_TYPE": "SUBMIT",
         "DEVICE_TYPE_CODE": "SC",
         "OUTPUT_TYPE": "HTML"
      }
   },
   "requestDetailsMap": {}
}</con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/initiate</con:originalUri><con:assertion type="GroovyScriptAssertion" id="3f2a7f7f-4150-4f59-b57e-eddb93b59884" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "SUCCESS"
assert jsonMap.gssResponseHeader.responseContext.NEXTACTION == "VERIFY"</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Login_SecurityContext" id="857238a3-2b9e-4678-9a84-bc10e7079e76"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>SGG-SC</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateLogin</con:sourceStep><con:sourcePath>gssResponseHeader.securityContext</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifyLogin</con:targetStep><con:targetPath>gssRequestHeader.securityContext</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Login_GSS-Nonce" id="b0abdb7c-7628-4062-a9f7-6edf629f5658"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-NONCE</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateLogin</con:sourceStep><con:sourcePath>gssResponseHeader.responseContext.GSS_NONCE</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifyLogin</con:targetStep><con:targetPath>gssRequestHeader.requestContext.GSS_NONCE</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Login_GSS-Ref-ID" id="08dda3b4-0d50-4439-b209-ae7d07523346"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-REF-ID</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateLogin</con:sourceStep><con:sourcePath>initiateResponseDetailsMap.GSS_REFERENCE_ID</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifyLogin</con:targetStep><con:targetPath>verifyDetailMap.GSS_REFERENCE_ID</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="restrequest" name="VerifyLogin" id="1ce7fb30-c9f9-4ebc-8e98-e1fb38d25928"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/verify" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="VerifyLogin" id="ae8cc01d-5b14-46b5-8fa6-6207c40ac5af" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request><![CDATA[{
   "verifyDetailMap": {"GSS_REFERENCE_ID": "85A11D8DB9424213BBD9FB15A3258A13"},
   "gssRequestHeader":    {
      "serviceContext":       {
         "USER_AGENT": "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
         "APPLICATION": "B.NET"
      },
      "auditContext":       {
         "MODULE_ID": "B.Net Login Module",
         "IS_FINANCIAL_TRANSACTION": "false",
         "CLIENT_IP_ADDRESS": "35.53.180.6"
      },
      "requestContext":       {
         "REQUEST_TIMESTAMP": "2011-06-14T04:12:36BST",
         "REQUEST_TRACKING_ID": "REQ10001",
         "CALLBACK_URL": "https://bnet.barclays.com/",
         "GSS_NONCE": "64687d72-33df-4bfd-ae31-8c9300c78222"
      },
      "securityContext": "eyJQVVJOX1RZUEUiOiJwa2kiLCJQVVJOIjoiOTk4MDAwMDAwMDg4MDQwMDAwNTAiLCJVU0VSX0FHRU5UIjoiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgNi4xOyBXT1c2NDsgVHJpZGVudC83LjA7IEFTOyBydjoxMS4wKSBsaWtlIEdlY2tvIiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIkRFVklDRV9UWVBFX0NPREUiOiJTQyIsIlJFR0lPTiI6IkdCIiwiR1NTX1JFRkVSRU5DRV9JRCI6Ijg1QTExRDhEQjk0MjQyMTNCQkQ5RkIxNUEzMjU4QTEzIn0="
   },
   "deviceParamMap":    {
      "HTTP_METHOD": "PUT",
      "HTTP_INPUT_CONTENTS": "Version_Spec=100&amp;Version_Plugin_Major=3&amp;Version_Plugin_Minor=0&amp;Version_Browser_Major=0&amp;Version_Browser_Minor=11&amp;Transaction_ID=7a4a1763-0ac0-4fb7-9d98-e6053e95d191401141426801730&amp;Signature_DataICAgICAgICAgICAgICAgICAgICAgICBURVNUSU5HIENPTVBBTlkgICAgICAgICAgICAgICAgICAgICAgIA0KRG9jdW1lbnQgSUQ6ICAgICAgICAgICAgICAgICAgICAgICAgRjAyNjNBMEUyNDJFNEM5NEI2MEREMjA0RjQ0QjZDQUINClNpZ24gYW5kIFN1Ym1pdCB0aGUgZm9sbG93aW5nIHRyYW5zYWN0aW9ucyAoMSkNCg0KUGF5bWVudCBUeXBlOiAgICAgICAgICAgICAgICAgICAgICAgRG9tZXN0aWMgUGF5bWVudA0KRGVsaXZlcnkgT3B0aW9uOiAgICAgICAgICAgICAgICAgICAgVUsgVGhyZWUgRGF5IFBheW1lbnQNCkRlYml0IEFjY291bnQgQmFuayBJZGVudGlmaWVyOiAgICAgIDA5MDA2Mw0KRGViaXQgQWNjb3VudCBOdW1iZXI6ICAgICAgICAgICAgICAgMDMwNDE0MDENCkRlYml0IEFjY291bnQgQ3VycmVuY3k6ICAgICAgICAgICAgIFBvdW5kIFN0ZXJsaW5nDQpQYXltZW50IEN1cnJlbmN5OiAgICAgICAgICAgICAgICAgICBQb3VuZCBTdGVybGluZw0KUGF5bWVudCBBbW91bnQ6ICAgICAgICAgICAgICAgICAgICAgMjYwMC4wMA0KVHJhbnNhY3Rpb24gUmVmZXJlbmNlIE51bWJlcjogICAgICAgQlgxNTA0MjAwNjkzMjYwNw0KVmFsdWUgRGF0ZTogICAgICAgICAgICAgICAgICAgICAgICAgQXByIDI0LCAyMDE1DQpDdXN0b21lciBSZWZlcmVuY2U6ICAgICAgICAgICAgICAgICAxMjMxMjMxMjMNCk51bWJlciBvZiBjcmVkaXQvZGViaXQgcmVjb3JkczoJICAgIDENCg0KQmVuZWZpY2lhcnkgTmFtZTogICAgICAgICAgICAgICAgICAgMTM0MjM0MjMNCkJlbmVmaWNpYXJ5IEFjY291bnQgQmFuayBJZGVudGlmaWVyOjE4NTAwOA0KQmVuZWZpY2lhcnkgQWNjb3VudCBOdW1iZXI6ICAgICAgICAgNDE4NTAwODMNCkJlbmVmaWNpYXJ5IEFtb3VudDogICAgICAgICAgICAgICAg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&amp;Signature_Format=PKCS7_basic&amp;IsDetailScrAction=false&amp;pd=F0263A0E242E4C94B60DD204F44B6CAB&amp;gssRefId=7a4a1763-0ac0-4fb7-9d98-e6053e95d191401141426801730&amp;gssStore=true"
   }
}]]></con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/verify</con:originalUri><con:assertion type="GroovyScriptAssertion" id="b2b9bd53-4cd9-4378-ad3e-a47f8bc3793c" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "ERROR"


assert jsonMap.gssResponseHeader.gssError.errorCode == "INVALID_SIGNATURE_FORMAT"


assert jsonMap.gssResponseHeader.gssError.errorMsg == "Format of the signature given to esigner to display is not supported."
</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:properties/></con:testCase><con:testCase id="6e1af1c2-822a-4dbb-9854-615de7f723b5" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="TestCase 2.6-Login-SessionTimeOut&lt;20Min" searchProperties="true"><con:settings/><con:testStep type="restrequest" name="GetDeviceList" id="96ebc137-9949-48ce-aeca-d11636fed1d7"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/devicelist" methodName="Devicelist" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="GetDeviceList" id="b063e9a0-5f4c-484f-b84a-038d96c080c1" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request>{
	"gssRequestHeader":{
		"serviceContext":{
			"USER_AGENT":"Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
			"APPLICATION":"B.NET"
		},
		"securityContext":null,
		"requestContext":{
			"REQUEST_TIMESTAMP":"2011-06-14T04:12:36BST",
			"REQUEST_TRACKING_ID":"REQ10001",
			"CALLBACK_URL":"https://bnet.barclays.com/"
		},
		"auditContext":{
			"MODULE_ID":"B.Net Login Module",
			"IS_FINANCIAL_TRANSACTION":"false",
			"CLIENT_IP_ADDRESS":"35.53.180.6"
		}
	},
	"deviceRequestMap":{
		"ONLY_ACTIVE":"true",
		"OUTPUT_TYPE":"BOTH"
	}
}</con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/devicelist</con:originalUri><con:assertion type="GroovyScriptAssertion" id="6c166ddf-cdfe-4189-9b56-bea28374973b" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "SUCCESS"
assert jsonMap.deviceInfo[0].DeviceDetailMap.STATUS == "Active"</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-GetDeviceList" id="72ade034-762d-495a-9c4d-ea83679426a0"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-SC</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>GetDeviceList</con:sourceStep><con:sourcePath>gssResponseHeader.securityContext</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>InitiateLogin</con:targetStep><con:targetPath>initiateRequestHeader.gssRequestHeader.securityContext</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="restrequest" name="InitiateLogin" id="6225419c-c02a-4a31-b02f-807c97540410"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/initiate" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="InitiateLogin" id="45730af7-4d98-41bd-a00f-24929dff6304" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request>{
   "transactionItemList": [],
   "preFormattedData": "VGhpcyBpcyBhIHNhbXBsZSBvZiBwcmVmb3JtYXR0ZWQgZGF0YSwgY3JlYXRlZCBvbiAyNy8wMy8yMDE1Lg==",
   "initiateRequestHeader":    {
      "gssRequestHeader":       {
         "serviceContext":          {
            "PURN_TYPE": "pki",
            "PURN": "99800000008804000050",
            "USER_AGENT": "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
            "APPLICATION": "B.NET"
         },
         "auditContext":          {
            "MODULE_ID": "12345678901234567890123456789012345678901",
            "IS_FINANCIAL_TRANSACTION": "false",
            "SUB_MODULE_ID": "eyJVU0VSX0FHRU5UIjoiSUU4IiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IkdCIn0=",
            "SUBMODULE_ID": "eyJVU0VSX0FHRU5UIjoiSUU4IiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IkdCIn0=",
            "CLIENT_IP_ADDRESS": "35.53.180.6"
         },
         "requestContext":          {
            "REQUEST_TIMESTAMP": "2011-06-14T04:12:36BST",
            "REQUEST_TRACKING_ID": "REQ10001",
            "CALLBACK_URL": "https://bnet.barclays.com/"
         },
         "securityContext": "eyJVU0VSX0FHRU5UIjoiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgNi4xOyBXT1c2NDsgVHJpZGVudC83LjA7IEFTOyBydjoxMS4wKSBsaWtlIEdlY2tvIiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IlBVIn0="
      },
      "initiateRequestHeaderDetails":       {
         "FUNCTION_TYPE": "AUTHENTICATE",
         "ACTION_TYPE": "SUBMIT",
         "DEVICE_TYPE_CODE": "SC",
         "OUTPUT_TYPE": "HTML"
      }
   },
   "requestDetailsMap": {}
}</con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/initiate</con:originalUri><con:assertion type="GroovyScriptAssertion" id="3f2a7f7f-4150-4f59-b57e-eddb93b59884" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "SUCCESS"
assert jsonMap.gssResponseHeader.responseContext.NEXTACTION == "VERIFY"</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Login_SecurityContext" id="3875a463-c946-42cf-aa8a-857c8e898ece"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>SGG-SC</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateLogin</con:sourceStep><con:sourcePath>gssResponseHeader.securityContext</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifyLogin</con:targetStep><con:targetPath>gssRequestHeader.securityContext</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Login_GSS-Nonce" id="6fb51363-be80-489c-ae4e-ca52e6b8aa10"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-NONCE</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateLogin</con:sourceStep><con:sourcePath>gssResponseHeader.responseContext.GSS_NONCE</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifyLogin</con:targetStep><con:targetPath>gssRequestHeader.requestContext.GSS_NONCE</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Login_GSS-Ref-ID" id="e15076ab-bcd7-4f77-85c7-ae2ecf1400ac"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-REF-ID</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateLogin</con:sourceStep><con:sourcePath>initiateResponseDetailsMap.GSS_REFERENCE_ID</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifyLogin</con:targetStep><con:targetPath>verifyDetailMap.GSS_REFERENCE_ID</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="delay" name="Delay" id="7f13c44b-0552-4a97-a60f-9eab55e3050b"><con:settings/><con:config><delay>1100000</delay></con:config></con:testStep><con:testStep type="restrequest" name="VerifyLogin" id="025264df-ebad-4b76-9fd2-bdfdda6ba8fa"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/verify" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="VerifyLogin" id="ae8cc01d-5b14-46b5-8fa6-6207c40ac5af" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request><![CDATA[{
   "verifyDetailMap": {"GSS_REFERENCE_ID": "0E49EE1B23B544B49A2DA0BE381162EB"},
   "gssRequestHeader":    {
      "serviceContext":       {
         "USER_AGENT": "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
         "APPLICATION": "B.NET"
      },
      "auditContext":       {
         "MODULE_ID": "B.Net Login Module",
         "IS_FINANCIAL_TRANSACTION": "false",
         "CLIENT_IP_ADDRESS": "35.53.180.6"
      },
      "requestContext":       {
         "REQUEST_TIMESTAMP": "2011-06-14T04:12:36BST",
         "REQUEST_TRACKING_ID": "REQ10001",
         "CALLBACK_URL": "https://bnet.barclays.com/",
         "GSS_NONCE": "06c1b6b7-bcde-4f31-9fa6-acff5cf99ef2"
      },
      "securityContext": "eyJQVVJOX1RZUEUiOiJwa2kiLCJQVVJOIjoiOTk4MDAwMDAwMDg4MDQwMDAwNTAiLCJVU0VSX0FHRU5UIjoiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgNi4xOyBXT1c2NDsgVHJpZGVudC83LjA7IEFTOyBydjoxMS4wKSBsaWtlIEdlY2tvIiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIkRFVklDRV9UWVBFX0NPREUiOiJTQyIsIlJFR0lPTiI6IkdCIiwiR1NTX1JFRkVSRU5DRV9JRCI6IjBFNDlFRTFCMjNCNTQ0QjQ5QTJEQTBCRTM4MTE2MkVCIn0="
   },
   "deviceParamMap":    {
      "HTTP_METHOD": "PUT",
      "HTTP_INPUT_CONTENTS": "Version_Spec=100&amp;Version_Plugin_Major=3&amp;Version_Plugin_Minor=0&amp;Version_Browser_Major=0&amp;Version_Browser_Minor=11&amp;Transaction_ID=7a4a1763-0ac0-4fb7-9d98-e6053e95d191401141426801730&amp;Signature_Data=MIIPZgYJKoZIhvcNAQcCoIIPVzCCD1MCAQExCzAJBgUrDgMCGgUAMIID2wYJKoZIhvcNAQcBoIIDzASCA8hDbGllbnQgTmFtZTogICAgICAgICAgICAgICAgICAgICAgICBURVNUSU5HIENPTVBBTlkgICAgICAgICAgICAgICAgICAgICAgIA0KRG9jdW1lbnQgSUQ6ICAgICAgICAgICAgICAgICAgICAgICAgRjAyNjNBMEUyNDJFNEM5NEI2MEREMjA0RjQ0QjZDQUINClNpZ24gYW5kIFN1Ym1pdCB0aGUgZm9sbG93aW5nIHRyYW5zYWN0aW9ucyAoMSkNCg0KUGF5bWVudCBUeXBlOiAgICAgICAgICAgICAgICAgICAgICAgRG9tZXN0aWMgUGF5bWVudA0KRGVsaXZlcnkgT3B0aW9uOiAgICAgICAgICAgICAgICAgICAgVUsgVGhyZWUgRGF5IFBheW1lbnQNCkRlYml0IEFjY291bnQgQmFuayBJZGVudGlmaWVyOiAgICAgIDA5MDA2Mw0KRGViaXQgQWNjb3VudCBOdW1iZXI6ICAgICAgICAgICAgICAgMDMwNDE0MDENCkRlYml0IEFjY291bnQgQ3VycmVuY3k6ICAgICAgICAgICAgIFBvdW5kIFN0ZXJsaW5nDQpQYXltZW50IEN1cnJlbmN5OiAgICAgICAgICAgICAgICAgICBQb3VuZCBTdGVybGluZw0KUGF5bWVudCBBbW91bnQ6ICAgICAgICAgICAgICAgICAgICAgMjYwMC4wMA0KVHJhbnNhY3Rpb24gUmVmZXJlbmNlIE51bWJlcjogICAgICAgQlgxNTA0MjAwNjkzMjYwNw0KVmFsdWUgRGF0ZTogICAgICAgICAgICAgICAgICAgICAgICAgQXByIDI0LCAyMDE1DQpDdXN0b21lciBSZWZlcmVuY2U6ICAgICAgICAgICAgICAgICAxMjMxMjMxMjMNCk51bWJlciBvZiBjcmVkaXQvZGViaXQgcmVjb3JkczoJICAgIDENCg0KQmVuZWZpY2lhcnkgTmFtZTogICAgICAgICAgICAgICAgICAgMTM0MjM0MjMNCkJlbmVmaWNpYXJ5IEFjY291bnQgQmFuayBJZGVudGlmaWVyOjE4NTAwOA0KQmVuZWZpY2lh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&amp;Signature_Format=PKCS7_basic&amp;IsDetailScrAction=false&amp;pd=F0263A0E242E4C94B60DD204F44B6CAB&amp;gssRefId=7a4a1763-0ac0-4fb7-9d98-e6053e95d191401141426801730&amp;gssStore=true"
   }
}]]></con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/verify</con:originalUri><con:assertion type="GroovyScriptAssertion" id="b2b9bd53-4cd9-4378-ad3e-a47f8bc3793c" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "SUCCESS"
assert jsonMap.gssResponseHeader.responseContext.NEXTACTION == "COMPLETE"</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:properties/></con:testCase><con:testCase id="13409cf8-4307-42bd-82ca-842db93db8ca" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="TestCase 2.7-Login-OCSP_Check" searchProperties="true" disabled="true"><con:settings/><con:testStep type="restrequest" name="GetDeviceList" id="1d0e4f7c-f268-4488-8c50-eabd31f57042"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/devicelist" methodName="Devicelist" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="GetDeviceList" id="b063e9a0-5f4c-484f-b84a-038d96c080c1" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request>{
	"gssRequestHeader":{
		"serviceContext":{
			"USER_AGENT":"Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
			"APPLICATION":"B.NET"
		},
		"securityContext":null,
		"requestContext":{
			"REQUEST_TIMESTAMP":"2011-06-14T04:12:36BST",
			"REQUEST_TRACKING_ID":"REQ10001",
			"CALLBACK_URL":"https://bnet.barclays.com/"
		},
		"auditContext":{
			"MODULE_ID":"B.Net Login Module",
			"IS_FINANCIAL_TRANSACTION":"false",
			"CLIENT_IP_ADDRESS":"35.53.180.6"
		}
	},
	"deviceRequestMap":{
		"ONLY_ACTIVE":"true",
		"OUTPUT_TYPE":"BOTH"
	}
}</con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/devicelist</con:originalUri><con:assertion type="GroovyScriptAssertion" id="6c166ddf-cdfe-4189-9b56-bea28374973b" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "SUCCESS"
assert jsonMap.deviceInfo[0].DeviceDetailMap.STATUS == "Active"</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-GetDeviceList" id="516cf735-7bbc-4e05-8a91-1f089dd7188d"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-SC</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>GetDeviceList</con:sourceStep><con:sourcePath>gssResponseHeader.securityContext</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>InitiateLogin</con:targetStep><con:targetPath>initiateRequestHeader.gssRequestHeader.securityContext</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="restrequest" name="InitiateLogin" id="5df31e8b-97f0-45a7-906a-5a4b2a56ed68"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/initiate" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="InitiateLogin" id="45730af7-4d98-41bd-a00f-24929dff6304" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request>{
   "transactionItemList": [],
   "preFormattedData": "VGhpcyBpcyBhIHNhbXBsZSBvZiBwcmVmb3JtYXR0ZWQgZGF0YSwgY3JlYXRlZCBvbiAyNy8wMy8yMDE1Lg==",
   "initiateRequestHeader":    {
      "gssRequestHeader":       {
         "serviceContext":          {
            "PURN_TYPE": "pki",
            "USER_AGENT": "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
            "PURN": "99800000008804000050",
            "APPLICATION": "B.NET"
         },
         "auditContext":          {
            "MODULE_ID": "12345678901234567890123456789012345678901",
            "IS_FINANCIAL_TRANSACTION": "false",
            "SUB_MODULE_ID": "eyJVU0VSX0FHRU5UIjoiSUU4IiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IkdCIn0=",
            "SUBMODULE_ID": "eyJVU0VSX0FHRU5UIjoiSUU4IiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IkdCIn0=",
            "CLIENT_IP_ADDRESS": "35.53.180.6"
         },
         "requestContext":          {
            "REQUEST_TIMESTAMP": "2011-06-14T04:12:36BST",
            "REQUEST_TRACKING_ID": "REQ10001",
            "CALLBACK_URL": "https://bnet.barclays.com/"
         },
         "securityContext": "eyJVU0VSX0FHRU5UIjoiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgNi4xOyBXT1c2NDsgVHJpZGVudC83LjA7IEFTOyBydjoxMS4wKSBsaWtlIEdlY2tvIiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IkdCIn0="
      },
      "initiateRequestHeaderDetails":       {
         "FUNCTION_TYPE": "AUTHENTICATE",
         "ACTION_TYPE": "SUBMIT",
         "DEVICE_TYPE_CODE": "SC",
         "OUTPUT_TYPE": "HTML"
      }
   },
   "requestDetailsMap": {}
}</con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/initiate</con:originalUri><con:assertion type="GroovyScriptAssertion" id="3f2a7f7f-4150-4f59-b57e-eddb93b59884" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "SUCCESS"
assert jsonMap.gssResponseHeader.responseContext.NEXTACTION == "VERIFY"</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Login_SecurityContext" id="749245f6-4007-4497-9ca3-42e763207101"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>SGG-SC</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateLogin</con:sourceStep><con:sourcePath>gssResponseHeader.securityContext</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifyLogin</con:targetStep><con:targetPath>gssRequestHeader.securityContext</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Login_GSS-Nonce" id="a69bb4a9-1b4f-476a-ac1a-5ef26eaa7413"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-NONCE</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateLogin</con:sourceStep><con:sourcePath>gssResponseHeader.responseContext.GSS_NONCE</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifyLogin</con:targetStep><con:targetPath>gssRequestHeader.requestContext.GSS_NONCE</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Login_GSS-Ref-ID" id="5921383a-bb04-4016-b5fe-c8efc17b4ebd"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-REF-ID</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateLogin</con:sourceStep><con:sourcePath>initiateResponseDetailsMap.GSS_REFERENCE_ID</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifyLogin</con:targetStep><con:targetPath>verifyDetailMap.GSS_REFERENCE_ID</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="restrequest" name="VerifyLogin" id="271cfc2f-2174-43b8-bd0f-fbfe16e8e050"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/verify" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="VerifyLogin" id="ae8cc01d-5b14-46b5-8fa6-6207c40ac5af" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request><![CDATA[{
   "verifyDetailMap": {"GSS_REFERENCE_ID": "63FBB4DB5C4947C7A56ACE537815085E"},
   "gssRequestHeader":    {
      "serviceContext":       {
         "USER_AGENT": "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
         "APPLICATION": "B.NET"
      },
      "auditContext":       {
         "MODULE_ID": "B.Net Login Module",
         "IS_FINANCIAL_TRANSACTION": "false",
         "CLIENT_IP_ADDRESS": "35.53.180.6"
      },
      "requestContext":       {
         "REQUEST_TIMESTAMP": "2011-06-14T04:12:36BST",
         "REQUEST_TRACKING_ID": "REQ10001",
         "CALLBACK_URL": "https://bnet.barclays.com/",
         "GSS_NONCE": "1cddc496-4e5d-4cc8-8e63-3ac602c16116"
      },
      "securityContext": "eyJQVVJOX1RZUEUiOiJwa2kiLCJQVVJOIjoiOTk4MDAwMDAwMDg4MDQwMDAwNTAiLCJVU0VSX0FHRU5UIjoiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgNi4xOyBXT1c2NDsgVHJpZGVudC83LjA7IEFTOyBydjoxMS4wKSBsaWtlIEdlY2tvIiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIkRFVklDRV9UWVBFX0NPREUiOiJTQyIsIlJFR0lPTiI6IkdCIiwiR1NTX1JFRkVSRU5DRV9JRCI6IjYzRkJCNERCNUM0OTQ3QzdBNTZBQ0U1Mzc4MTUwODVFIn0="
   },
   "deviceParamMap":    {
      "HTTP_METHOD": "PUT",
      "HTTP_INPUT_CONTENTS": "Version_Spec=100&amp;Version_Plugin_Major=3&amp;Version_Plugin_Minor=0&amp;Version_Browser_Major=0&amp;Version_Browser_Minor=11&amp;Transaction_ID=7a4a1763-0ac0-4fb7-9d98-e6053e95d191401141426801730&amp;Signature_Data=MIIPZgYJKoZIhvcNAQcCoIIPVzCCD1MCAQExCzAJBgUrDgMCGgUAMIID2wYJKoZIhvcNAQcBoIIDzASCA8hDbGllbnQgTmFtZTogICAgICAgICAgICAgICAgICAgICAgICBURVNUSU5HIENPTVBBTlkgICAgICAgICAgICAgICAgICAgICAgIA0KRG9jdW1lbnQgSUQ6ICAgICAgICAgICAgICAgICAgICAgICAgRjAyNjNBMEUyNDJFNEM5NEI2MEREMjA0RjQ0QjZDQUINClNpZ24gYW5kIFN1Ym1pdCB0aGUgZm9sbG93aW5nIHRyYW5zYWN0aW9ucyAoMSkNCg0KUGF5bWVudCBUeXBlOiAgICAgICAgICAgICAgICAgICAgICAgRG9tZXN0aWMgUGF5bWVudA0KRGVsaXZlcnkgT3B0aW9uOiAgICAgICAgICAgICAgICAgICAgVUsgVGhyZWUgRGF5IFBheW1lbnQNCkRlYml0IEFjY291bnQgQmFuayBJZGVudGlmaWVyOiAgICAgIDA5MDA2Mw0KRGViaXQgQWNjb3VudCBOdW1iZXI6ICAgICAgICAgICAgICAgMDMwNDE0MDENCkRlYml0IEFjY291bnQgQ3VycmVuY3k6ICAgICAgICAgICAgIFBvdW5kIFN0ZXJsaW5nDQpQYXltZW50IEN1cnJlbmN5OiAgICAgICAgICAgICAgICAgICBQb3VuZCBTdGVybGluZw0KUGF5bWVudCBBbW91bnQ6ICAgICAgICAgICAgICAgICAgICAgMjYwMC4wMA0KVHJhbnNhY3Rpb24gUmVmZXJlbmNlIE51bWJlcjogICAgICAgQlgxNTA0MjAwNjkzMjYwNw0KVmFsdWUgRGF0ZTogICAgICAgICAgICAgICAgICAgICAgICAgQXByIDI0LCAyMDE1DQpDdXN0b21lciBSZWZlcmVuY2U6ICAgICAgICAgICAgICAgICAxMjMxMjMxMjMNCk51bWJlciBvZiBjcmVkaXQvZGViaXQgcmVjb3JkczoJICAgIDENCg0KQmVuZWZpY2lhcnkgTmFtZTogICAgICAgICAgICAgICAgICAgMTM0MjM0MjMNCkJlbmVmaWNpYXJ5IEFjY291bnQgQmFuayBJZGVudGlmaWVyOjE4NTAwOA0KQmVuZWZpY2lh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&amp;Signature_Format=PKCS7_basic&amp;IsDetailScrAction=false&amp;pd=F0263A0E242E4C94B60DD204F44B6CAB&amp;gssRefId=7a4a1763-0ac0-4fb7-9d98-e6053e95d191401141426801730&amp;gssStore=true"
   }
}]]></con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/verify</con:originalUri><con:assertion type="GroovyScriptAssertion" id="b2b9bd53-4cd9-4378-ad3e-a47f8bc3793c" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "SUCCESS"
assert jsonMap.gssResponseHeader.responseContext.NEXTACTION == "COMPLETE"</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:properties/></con:testCase><con:testCase id="12b670c5-c372-4646-82b8-4a1f61a37d11" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="TestCase 2.8-Login-TIAA-Check" searchProperties="true"><con:settings/><con:testStep type="restrequest" name="GetDeviceList" id="43bab917-8a4c-47e8-a600-363b665a4454"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/devicelist" methodName="Devicelist" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="GetDeviceList" id="b063e9a0-5f4c-484f-b84a-038d96c080c1" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request>{
	"gssRequestHeader":{
		"serviceContext":{
			"USER_AGENT":"Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
			"APPLICATION":"B.NET"
		},
		"securityContext":null,
		"requestContext":{
			"REQUEST_TIMESTAMP":"2011-06-14T04:12:36BST",
			"REQUEST_TRACKING_ID":"REQ10001",
			"CALLBACK_URL":"https://bnet.barclays.com/"
		},
		"auditContext":{
			"MODULE_ID":"B.Net Login Module",
			"IS_FINANCIAL_TRANSACTION":"false",
			"CLIENT_IP_ADDRESS":"35.53.180.6"
		}
	},
	"deviceRequestMap":{
		"ONLY_ACTIVE":"true",
		"OUTPUT_TYPE":"BOTH"
	}
}</con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/devicelist</con:originalUri><con:assertion type="GroovyScriptAssertion" id="6c166ddf-cdfe-4189-9b56-bea28374973b" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "SUCCESS"
assert jsonMap.deviceInfo[0].DeviceDetailMap.STATUS == "Active"</scriptText></con:configuration></con:assertion><con:assertion type="Valid HTTP Status Codes" id="0c3b29be-2c8c-4dd0-834b-7163b264b4d4" name="Valid HTTP Status Codes"><con:configuration><codes/></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-GetDeviceList" id="98590824-abf5-446b-90b7-3b056a286767"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-SC</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>GetDeviceList</con:sourceStep><con:sourcePath>gssResponseHeader.securityContext</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>InitiateLogin</con:targetStep><con:targetPath>initiateRequestHeader.gssRequestHeader.securityContext</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Login_SecurityContext" id="53833b4d-30d5-4e97-a870-1d36dd38a9d1"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>SGG-SC</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateLogin</con:sourceStep><con:sourcePath>gssResponseHeader.securityContext</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifyLogin</con:targetStep><con:targetPath>gssRequestHeader.securityContext</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Login_GSS-Nonce" id="2af42e61-2c1c-4159-b1a9-17f82a980292"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-NONCE</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateLogin</con:sourceStep><con:sourcePath>gssResponseHeader.responseContext.GSS_NONCE</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifyLogin</con:targetStep><con:targetPath>gssRequestHeader.requestContext.GSS_NONCE</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="restrequest" name="InitiateLogin" id="f5aefec7-3a5d-4727-9eb1-44d0f857ec9b"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/initiate" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="InitiateLogin" id="45730af7-4d98-41bd-a00f-24929dff6304" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request>{
   "transactionItemList": [],
   "preFormattedData": "VGhpcyBpcyBhIHNhbXBsZSBvZiBwcmVmb3JtYXR0ZWQgZGF0YSwgY3JlYXRlZCBvbiAyNy8wMy8yMDE1Lg==",
   "initiateRequestHeader":    {
      "gssRequestHeader":       {
         "serviceContext":          {
            "PURN_TYPE": "pki",
            "PURN": "99800000008804000050",
            "USER_AGENT": "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
            "APPLICATION": "B.NET"
         },
         "auditContext":          {
            "MODULE_ID": "12345678901234567890123456789012345678901",
            "IS_FINANCIAL_TRANSACTION": "false",
            "SUB_MODULE_ID": "eyJVU0VSX0FHRU5UIjoiSUU4IiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IkdCIn0=",
            "SUBMODULE_ID": "eyJVU0VSX0FHRU5UIjoiSUU4IiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IkdCIn0=",
            "CLIENT_IP_ADDRESS": "35.53.180.6"
         },
         "requestContext":          {
            "REQUEST_TIMESTAMP": "2011-06-14T04:12:36BST",
            "REQUEST_TRACKING_ID": "REQ10001",
            "CALLBACK_URL": "https://bnet.barclays.com/"
         },
         "securityContext": "eyJVU0VSX0FHRU5UIjoiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgNi4xOyBXT1c2NDsgVHJpZGVudC83LjA7IEFTOyBydjoxMS4wKSBsaWtlIEdlY2tvIiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IlBVIn0="
      },
      "initiateRequestHeaderDetails":       {
         "FUNCTION_TYPE": "AUTHENTICATE",
         "ACTION_TYPE": "SUBMIT",
         "DEVICE_TYPE_CODE": "SC",
         "OUTPUT_TYPE": "HTML"
      }
   },
   "requestDetailsMap": {}
}</con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/initiate</con:originalUri><con:assertion type="GroovyScriptAssertion" id="3f2a7f7f-4150-4f59-b57e-eddb93b59884" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "SUCCESS"
assert jsonMap.gssResponseHeader.responseContext.NEXTACTION == "VERIFY"</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Login_GSS-Ref-ID" id="7a8fd63f-ef63-40b0-9d13-af2e57d46030"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-REF-ID</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateLogin</con:sourceStep><con:sourcePath>initiateResponseDetailsMap.GSS_REFERENCE_ID</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifyLogin</con:targetStep><con:targetPath>verifyDetailMap.GSS_REFERENCE_ID</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="restrequest" name="VerifyLogin" id="3580d7cf-a2ce-498c-a48d-0182259f837f"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/verify" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="VerifyLogin" id="ae8cc01d-5b14-46b5-8fa6-6207c40ac5af" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request><![CDATA[{
   "verifyDetailMap": {"GSS_REFERENCE_ID": "9E0E039D9EF74CBEAE197B809996C007"},
   "gssRequestHeader":    {
      "serviceContext":       {
         "USER_AGENT": "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
         "APPLICATION": "B.NET"
      },
      "auditContext":       {
         "MODULE_ID": "B.Net Login Module",
         "IS_FINANCIAL_TRANSACTION": "false",
         "CLIENT_IP_ADDRESS": "35.53.180.6"
      },
      "requestContext":       {
         "REQUEST_TIMESTAMP": "2011-06-14T04:12:36BST",
         "REQUEST_TRACKING_ID": "REQ10001",
         "CALLBACK_URL": "https://bnet.barclays.com/",
         "GSS_NONCE": "917d71d1-4919-4fee-bd39-ee5b7bec9b3c"
      },
      "securityContext": "eyJQVVJOX1RZUEUiOiJwa2kiLCJQVVJOIjoiOTk4MDAwMDAwMDg4MDQwMDAwNTAiLCJVU0VSX0FHRU5UIjoiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgNi4xOyBXT1c2NDsgVHJpZGVudC83LjA7IEFTOyBydjoxMS4wKSBsaWtlIEdlY2tvIiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIkRFVklDRV9UWVBFX0NPREUiOiJTQyIsIlJFR0lPTiI6IkdCIiwiR1NTX1JFRkVSRU5DRV9JRCI6IjlFMEUwMzlEOUVGNzRDQkVBRTE5N0I4MDk5OTZDMDA3In0="
   },
   "deviceParamMap":    {
      "HTTP_METHOD": "PUT",
      "HTTP_INPUT_CONTENTS": "Version_Spec=100&amp;Version_Plugin_Major=3&amp;Version_Plugin_Minor=0&amp;Version_Browser_Major=0&amp;Version_Browser_Minor=11&amp;Transaction_ID=7a4a1763-0ac0-4fb7-9d98-e6053e95d191401141426801730&amp;Signature_Data=MIIPZgYJKoZIhvcNAQcCoIIPVzCCD1MCAQExCzAJBgUrDgMCGgUAMIID2wYJKoZIhvcNAQcBoIIDzASCA8hDbGllbnQgTmFtZTogICAgICAgICAgICAgICAgICAgICAgICBURVNUSU5HIENPTVBBTlkgICAgICAgICAgICAgICAgICAgICAgIA0KRG9jdW1lbnQgSUQ6ICAgICAgICAgICAgICAgICAgICAgICAgRjAyNjNBMEUyNDJFNEM5NEI2MEREMjA0RjQ0QjZDQUINClNpZ24gYW5kIFN1Ym1pdCB0aGUgZm9sbG93aW5nIHRyYW5zYWN0aW9ucyAoMSkNCg0KUGF5bWVudCBUeXBlOiAgICAgICAgICAgICAgICAgICAgICAgRG9tZXN0aWMgUGF5bWVudA0KRGVsaXZlcnkgT3B0aW9uOiAgICAgICAgICAgICAgICAgICAgVUsgVGhyZWUgRGF5IFBheW1lbnQNCkRlYml0IEFjY291bnQgQmFuayBJZGVudGlmaWVyOiAgICAgIDA5MDA2Mw0KRGViaXQgQWNjb3VudCBOdW1iZXI6ICAgICAgICAgICAgICAgMDMwNDE0MDENCkRlYml0IEFjY291bnQgQ3VycmVuY3k6ICAgICAgICAgICAgIFBvdW5kIFN0ZXJsaW5nDQpQYXltZW50IEN1cnJlbmN5OiAgICAgICAgICAgICAgICAgICBQb3VuZCBTdGVybGluZw0KUGF5bWVudCBBbW91bnQ6ICAgICAgICAgICAgICAgICAgICAgMjYwMC4wMA0KVHJhbnNhY3Rpb24gUmVmZXJlbmNlIE51bWJlcjogICAgICAgQlgxNTA0MjAwNjkzMjYwNw0KVmFsdWUgRGF0ZTogICAgICAgICAgICAgICAgICAgICAgICAgQXByIDI0LCAyMDE1DQpDdXN0b21lciBSZWZlcmVuY2U6ICAgICAgICAgICAgICAgICAxMjMxMjMxMjMNCk51bWJlciBvZiBjcmVkaXQvZGViaXQgcmVjb3JkczoJICAgIDENCg0KQmVuZWZpY2lhcnkgTmFtZTogICAgICAgICAgICAgICAgICAgMTM0MjM0MjMNCkJlbmVmaWNpYXJ5IEFjY291bnQgQmFuayBJZGVudGlmaWVyOjE4NTAwOA0KQmVuZWZpY2lh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&amp;Signature_Format=PKCS7_basic&amp;IsDetailScrAction=false&amp;pd=F0263A0E242E4C94B60DD204F44B6CAB&amp;gssRefId=7a4a1763-0ac0-4fb7-9d98-e6053e95d191401141426801730&amp;gssStore=true"
   }
}]]></con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/verify</con:originalUri><con:assertion type="GroovyScriptAssertion" id="b2b9bd53-4cd9-4378-ad3e-a47f8bc3793c" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "SUCCESS"
assert jsonMap.gssResponseHeader.responseContext.NEXTACTION == "COMPLETE"</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:properties/></con:testCase><con:testCase id="c7440034-6ca5-471e-bd56-e447e1da0499" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="TestCase 2.9-Login-No_DATA_Found" searchProperties="true"><con:settings/><con:testStep type="restrequest" name="GetDeviceList" id="eaefd81f-156e-4523-88cb-f918b2bd6c79"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/devicelist" methodName="Devicelist" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="GetDeviceList" id="b063e9a0-5f4c-484f-b84a-038d96c080c1" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request>{
	"gssRequestHeader":{
		"serviceContext":{
			"USER_AGENT":"Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
			"APPLICATION":"B.NET"
		},
		"securityContext":null,
		"requestContext":{
			"REQUEST_TIMESTAMP":"2011-06-14T04:12:36BST",
			"REQUEST_TRACKING_ID":"REQ10001",
			"CALLBACK_URL":"https://bnet.barclays.com/"
		},
		"auditContext":{
			"MODULE_ID":"B.Net Login Module",
			"IS_FINANCIAL_TRANSACTION":"false",
			"CLIENT_IP_ADDRESS":"35.53.180.6"
		}
	},
	"deviceRequestMap":{
		"ONLY_ACTIVE":"true",
		"OUTPUT_TYPE":"BOTH"
	}
}</con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/devicelist</con:originalUri><con:assertion type="GroovyScriptAssertion" id="6c166ddf-cdfe-4189-9b56-bea28374973b" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "SUCCESS"
assert jsonMap.deviceInfo[0].DeviceDetailMap.STATUS == "Active"</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-GetDeviceList" id="99864bd5-0405-4e64-995d-11b6c0d047cb"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-SC</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>GetDeviceList</con:sourceStep><con:sourcePath>gssResponseHeader.securityContext</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>InitiateLogin</con:targetStep><con:targetPath>initiateRequestHeader.gssRequestHeader.securityContext</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="restrequest" name="InitiateLogin" id="61b58890-f4b5-4bba-8aa0-96b6485926cf"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/initiate" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="InitiateLogin" id="45730af7-4d98-41bd-a00f-24929dff6304" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request>{
   "transactionItemList": [],
   "preFormattedData": "VGhpcyBpcyBhIHNhbXBsZSBvZiBwcmVmb3JtYXR0ZWQgZGF0YSwgY3JlYXRlZCBvbiAyNy8wMy8yMDE1Lg==",
   "initiateRequestHeader":    {
      "gssRequestHeader":       {
         "serviceContext":          {
            "PURN_TYPE": "pki",
            "PURN": "99800000008804000050",
            "USER_AGENT": "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
            "APPLICATION": "B.NET"
         },
         "auditContext":          {
            "MODULE_ID": "12345678901234567890123456789012345678901",
            "IS_FINANCIAL_TRANSACTION": "false",
            "SUB_MODULE_ID": "eyJVU0VSX0FHRU5UIjoiSUU4IiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IkdCIn0=",
            "SUBMODULE_ID": "eyJVU0VSX0FHRU5UIjoiSUU4IiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IkdCIn0=",
            "CLIENT_IP_ADDRESS": "35.53.180.6"
         },
         "requestContext":          {
            "REQUEST_TIMESTAMP": "2011-06-14T04:12:36BST",
            "REQUEST_TRACKING_ID": "REQ10001",
            "CALLBACK_URL": "https://bnet.barclays.com/"
         },
         "securityContext": "eyJVU0VSX0FHRU5UIjoiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgNi4xOyBXT1c2NDsgVHJpZGVudC83LjA7IEFTOyBydjoxMS4wKSBsaWtlIEdlY2tvIiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IlBVIn0="
      },
      "initiateRequestHeaderDetails":       {
         "FUNCTION_TYPE": "AUTHENTICATE",
         "ACTION_TYPE": "SUBMIT",
         "DEVICE_TYPE_CODE": "SC",
         "OUTPUT_TYPE": "HTML"
      }
   },
   "requestDetailsMap": {}
}</con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/initiate</con:originalUri><con:assertion type="GroovyScriptAssertion" id="3f2a7f7f-4150-4f59-b57e-eddb93b59884" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "SUCCESS"
assert jsonMap.gssResponseHeader.responseContext.NEXTACTION == "VERIFY"</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Login_SecurityContext" id="581567b9-88d6-4a4a-8c7f-c3eb2fcd00bc"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>SGG-SC</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateLogin</con:sourceStep><con:sourcePath>gssResponseHeader.securityContext</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifyLogin</con:targetStep><con:targetPath>gssRequestHeader.securityContext</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Login_GSS-Nonce" id="19086a0c-8ff7-4ab1-aa92-540298818231"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-NONCE</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateLogin</con:sourceStep><con:sourcePath>gssResponseHeader.responseContext.GSS_NONCE</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifyLogin</con:targetStep><con:targetPath>gssRequestHeader.requestContext.GSS_NONCE</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Login_GSS-Ref-ID" id="d4e836ff-43c4-4cf2-8049-44e9ce594327"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-REF-ID</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateLogin</con:sourceStep><con:sourcePath>initiateResponseDetailsMap.GSS_REFERENCE_ID</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifyLogin</con:targetStep><con:targetPath>verifyDetailMap.GSS_REFERENCE_ID</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="restrequest" name="VerifyLogin" id="f036fb31-dc87-40b5-8ff5-36be7b2b2e0c"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/verify" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="VerifyLogin" id="ae8cc01d-5b14-46b5-8fa6-6207c40ac5af" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request><![CDATA[{
   "verifyDetailMap": {"GSS_REFERENCE_ID": "BAE580BC05A541A4B4955F049E012BF5"},
   "gssRequestHeader":    {
      "serviceContext":       {
         "USER_AGENT": "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
         "APPLICATION": "MEHTA"
      },
      "auditContext":       {
         "MODULE_ID": "B.Net Login Module",
         "IS_FINANCIAL_TRANSACTION": "false",
         "CLIENT_IP_ADDRESS": "35.53.180.6"
      },
      "requestContext":       {
         "REQUEST_TIMESTAMP": "2011-06-14T04:12:36BST",
         "REQUEST_TRACKING_ID": "REQ10001",
         "CALLBACK_URL": "https://bnet.barclays.com/",
         "GSS_NONCE": "d9146e70-8764-45fc-871d-a8c5c727fe82"
      },
      "securityContext": "eyJQVVJOX1RZUEUiOiJwa2kiLCJQVVJOIjoiOTk4MDAwMDAwMDg4MDQwMDAwNTAiLCJVU0VSX0FHRU5UIjoiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgNi4xOyBXT1c2NDsgVHJpZGVudC83LjA7IEFTOyBydjoxMS4wKSBsaWtlIEdlY2tvIiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIkRFVklDRV9UWVBFX0NPREUiOiJTQyIsIlJFR0lPTiI6IkdCIiwiR1NTX1JFRkVSRU5DRV9JRCI6IkJBRTU4MEJDMDVBNTQxQTRCNDk1NUYwNDlFMDEyQkY1In0="
   },
   "deviceParamMap":    {
      "HTTP_METHOD": "PUT",
      "HTTP_INPUT_CONTENTS": "Version_Spec=100&amp;Version_Plugin_Major=3&amp;Version_Plugin_Minor=0&amp;Version_Browser_Major=0&amp;Version_Browser_Minor=11&amp;Transaction_ID=7a4a1763-0ac0-4fb7-9d98-e6053e95d191401141426801730&amp;Signature_Data=MIIPZgYJKoZIhvcNAQcCoIIPVzCCD1MCAQExCzAJBgUrDgMCGgUAMIID2wYJKoZIhvcNAQcBoIIDzASCA8hDbGllbnQgTmFtZTogICAgICAgICAgICAgICAgICAgICAgICBURVNUSU5HIENPTVBBTlkgICAgICAgICAgICAgICAgICAgICAgIA0KRG9jdW1lbnQgSUQ6ICAgICAgICAgICAgICAgICAgICAgICAgRjAyNjNBMEUyNDJFNEM5NEI2MEREMjA0RjQ0QjZDQUINClNpZ24gYW5kIFN1Ym1pdCB0aGUgZm9sbG93aW5nIHRyYW5zYWN0aW9ucyAoMSkNCg0KUGF5bWVudCBUeXBlOiAgICAgICAgICAgICAgICAgICAgICAgRG9tZXN0aWMgUGF5bWVudA0KRGVsaXZlcnkgT3B0aW9uOiAgICAgICAgICAgICAgICAgICAgVUsgVGhyZWUgRGF5IFBheW1lbnQNCkRlYml0IEFjY291bnQgQmFuayBJZGVudGlmaWVyOiAgICAgIDA5MDA2Mw0KRGViaXQgQWNjb3VudCBOdW1iZXI6ICAgICAgICAgICAgICAgMDMwNDE0MDENCkRlYml0IEFjY291bnQgQ3VycmVuY3k6ICAgICAgICAgICAgIFBvdW5kIFN0ZXJsaW5nDQpQYXltZW50IEN1cnJlbmN5OiAgICAgICAgICAgICAgICAgICBQb3VuZCBTdGVybGluZw0KUGF5bWVudCBBbW91bnQ6ICAgICAgICAgICAgICAgICAgICAgMjYwMC4wMA0KVHJhbnNhY3Rpb24gUmVmZXJlbmNlIE51bWJlcjogICAgICAgQlgxNTA0MjAwNjkzMjYwNw0KVmFsdWUgRGF0ZTogICAgICAgICAgICAgICAgICAgICAgICAgQXByIDI0LCAyMDE1DQpDdXN0b21lciBSZWZlcmVuY2U6ICAgICAgICAgICAgICAgICAxMjMxMjMxMjMNCk51bWJlciBvZiBjcmVkaXQvZGViaXQgcmVjb3JkczoJICAgIDENCg0KQmVuZWZpY2lhcnkgTmFtZTogICAgICAgICAgICAgICAgICAgMTM0MjM0MjMNCkJlbmVmaWNpYXJ5IEFjY291bnQgQmFuayBJZGVudGlmaWVyOjE4NTAwOA0KQmVuZWZpY2lh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&amp;Signature_Format=PKCS7_basic&amp;IsDetailScrAction=false&amp;pd=F0263A0E242E4C94B60DD204F44B6CAB&amp;gssRefId=7a4a1763-0ac0-4fb7-9d98-e6053e95d191401141426801730&amp;gssStore=true"
   }
}]]></con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/verify</con:originalUri><con:assertion type="GroovyScriptAssertion" id="b2b9bd53-4cd9-4378-ad3e-a47f8bc3793c" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "ERROR"


assert jsonMap.gssResponseHeader.gssError.errorCode == "NO_DATA_FOUND"


assert jsonMap.gssResponseHeader.gssError.errorMsg == "No devices supporting the coarse grained filter"
</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:properties/></con:testCase><con:testCase id="24655953-4289-4d4b-b532-4da3488d9a07" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="TestCase 2.10-Login-Insufficient_Parameter" searchProperties="true"><con:settings/><con:testStep type="restrequest" name="GetDeviceList" id="8c46fa38-29aa-4d58-99d5-ed9756401afe"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/devicelist" methodName="Devicelist" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="GetDeviceList" id="b063e9a0-5f4c-484f-b84a-038d96c080c1" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request>{
	"gssRequestHeader":{
		"serviceContext":{
			"USER_AGENT":"Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
			"APPLICATION":"B.NET"
		},
		"securityContext":null,
		"requestContext":{
			"REQUEST_TIMESTAMP":"2011-06-14T04:12:36BST",
			"REQUEST_TRACKING_ID":"REQ10001",
			"CALLBACK_URL":"https://bnet.barclays.com/"
		},
		"auditContext":{
			"MODULE_ID":"B.Net Login Module",
			"IS_FINANCIAL_TRANSACTION":"false",
			"CLIENT_IP_ADDRESS":"35.53.180.6"
		}
	},
	"deviceRequestMap":{
		"ONLY_ACTIVE":"true",
		"OUTPUT_TYPE":"BOTH"
	}
}</con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/devicelist</con:originalUri><con:assertion type="GroovyScriptAssertion" id="6c166ddf-cdfe-4189-9b56-bea28374973b" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "SUCCESS"
assert jsonMap.deviceInfo[0].DeviceDetailMap.STATUS == "Active"</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-GetDeviceList" id="537233ef-0b5b-4626-ba84-a8b3d0c90c42"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-SC</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>GetDeviceList</con:sourceStep><con:sourcePath>gssResponseHeader.securityContext</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>InitiateLogin</con:targetStep><con:targetPath>initiateRequestHeader.gssRequestHeader.securityContext</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="restrequest" name="InitiateLogin" id="1cb1b253-5c44-4c1e-a5d5-548c560f7bff"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/initiate" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="InitiateLogin" id="45730af7-4d98-41bd-a00f-24929dff6304" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request>{
   "transactionItemList": [],
   "preFormattedData": "VGhpcyBpcyBhIHNhbXBsZSBvZiBwcmVmb3JtYXR0ZWQgZGF0YSwgY3JlYXRlZCBvbiAyNy8wMy8yMDE1Lg==",
   "initiateRequestHeader":    {
      "gssRequestHeader":       {
         "serviceContext":          {
            "": "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
            "PURN_TYPE": "pki",
            "PURN": "99800000008804000050",
            "APPLICATION": "B.NET"
         },
         "auditContext":          {
            "MODULE_ID": "12345678901234567890123456789012345678901",
            "IS_FINANCIAL_TRANSACTION": "false",
            "SUB_MODULE_ID": "eyJVU0VSX0FHRU5UIjoiSUU4IiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IkdCIn0=",
            "SUBMODULE_ID": "eyJVU0VSX0FHRU5UIjoiSUU4IiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IkdCIn0=",
            "CLIENT_IP_ADDRESS": "35.53.180.6"
         },
         "requestContext":          {
            "REQUEST_TIMESTAMP": "2011-06-14T04:12:36BST",
            "REQUEST_TRACKING_ID": "REQ10001",
            "CALLBACK_URL": "https://bnet.barclays.com/"
         },
         "securityContext": "eyJVU0VSX0FHRU5UIjoiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgNi4xOyBXT1c2NDsgVHJpZGVudC83LjA7IEFTOyBydjoxMS4wKSBsaWtlIEdlY2tvIiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IlBVIn0="
      },
      "initiateRequestHeaderDetails":       {
         "FUNCTION_TYPE": "AUTHENTICATE",
         "ACTION_TYPE": "SUBMIT",
         "DEVICE_TYPE_CODE": "SC",
         "OUTPUT_TYPE": "HTML"
      }
   },
   "requestDetailsMap": {}
}</con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/initiate</con:originalUri><con:assertion type="GroovyScriptAssertion" id="3f2a7f7f-4150-4f59-b57e-eddb93b59884" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "ERROR"


assert jsonMap.gssResponseHeader.gssError.errorCode == "INSUFFICIENT_PARAMETERS"


assert jsonMap.gssResponseHeader.gssError.errorMsg == "The mandatory field USER_AGENT is missing or its value is empty  in ServiceContext"
</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Login_SecurityContext" id="e74b196a-9269-4602-bcbc-79f60c343bb2"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>SGG-SC</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateLogin</con:sourceStep><con:sourcePath>gssResponseHeader.securityContext</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifyLogin</con:targetStep><con:targetPath>gssRequestHeader.securityContext</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Login_GSS-Nonce" id="2d0334c7-5981-4c9c-932c-c7f02dc45fb4"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-NONCE</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateLogin</con:sourceStep><con:sourcePath>gssResponseHeader.responseContext.GSS_NONCE</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifyLogin</con:targetStep><con:targetPath>gssRequestHeader.requestContext.GSS_NONCE</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Login_GSS-Ref-ID" id="95891203-d339-40bf-b341-6d552c3a62f6" disabled="true"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-REF-ID</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateLogin</con:sourceStep><con:sourcePath>initiateResponseDetailsMap.GSS_REFERENCE_ID</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifyLogin</con:targetStep><con:targetPath>verifyDetailMap.GSS_REFERENCE_ID</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="restrequest" name="VerifyLogin" id="ad9cba22-e51b-4399-a027-d70ef9370c4e"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/verify" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="VerifyLogin" id="ae8cc01d-5b14-46b5-8fa6-6207c40ac5af" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request><![CDATA[{
   "verifyDetailMap": {"GSS_REFERENCE_ID": "6250F2C3CAE14C5A8C7099F9DC938950"},
   "gssRequestHeader":    {
      "serviceContext":       {
         "": "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
         "APPLICATION": "B.NET"
      },
      "auditContext":       {
         "MODULE_ID": "B.Net Login Module",
         "IS_FINANCIAL_TRANSACTION": "false",
         "CLIENT_IP_ADDRESS": "35.53.180.6"
      },
      "requestContext":       {
         "REQUEST_TIMESTAMP": "2011-06-14T04:12:36BST",
         "REQUEST_TRACKING_ID": "REQ10001",
         "CALLBACK_URL": "https://bnet.barclays.com/",
         "GSS_NONCE": "bcfec9eb-8bfc-4e58-8b29-0858a4a64c49"
      },
      "securityContext": "eyJQVVJOX1RZUEUiOiJwa2kiLCJQVVJOIjoiOTk4MDAwMDAwMDg4MDQwMDAwNTAiLCJVU0VSX0FHRU5UIjoiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgNi4xOyBXT1c2NDsgVHJpZGVudC83LjA7IEFTOyBydjoxMS4wKSBsaWtlIEdlY2tvIiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIkRFVklDRV9UWVBFX0NPREUiOiJTQyIsIlJFR0lPTiI6IkdCIiwiR1NTX1JFRkVSRU5DRV9JRCI6IjYyNTBGMkMzQ0FFMTRDNUE4QzcwOTlGOURDOTM4OTUwIn0="
   },
   "deviceParamMap":    {
      "HTTP_METHOD": "PUT",
      "HTTP_INPUT_CONTENTS": "Version_Spec=100&amp;Version_Plugin_Major=3&amp;Version_Plugin_Minor=0&amp;Version_Browser_Major=0&amp;Version_Browser_Minor=11&amp;Transaction_ID=7a4a1763-0ac0-4fb7-9d98-e6053e95d191401141426801730&amp;Signature_Data=MIIPZgYJKoZIhvcNAQcCoIIPVzCCD1MCAQExCzAJBgUrDgMCGgUAMIID2wYJKoZIhvcNAQcBoIIDzASCA8hDbGllbnQgTmFtZTogICAgICAgICAgICAgICAgICAgICAgICBURVNUSU5HIENPTVBBTlkgICAgICAgICAgICAgICAgICAgICAgIA0KRG9jdW1lbnQgSUQ6ICAgICAgICAgICAgICAgICAgICAgICAgRjAyNjNBMEUyNDJFNEM5NEI2MEREMjA0RjQ0QjZDQUINClNpZ24gYW5kIFN1Ym1pdCB0aGUgZm9sbG93aW5nIHRyYW5zYWN0aW9ucyAoMSkNCg0KUGF5bWVudCBUeXBlOiAgICAgICAgICAgICAgICAgICAgICAgRG9tZXN0aWMgUGF5bWVudA0KRGVsaXZlcnkgT3B0aW9uOiAgICAgICAgICAgICAgICAgICAgVUsgVGhyZWUgRGF5IFBheW1lbnQNCkRlYml0IEFjY291bnQgQmFuayBJZGVudGlmaWVyOiAgICAgIDA5MDA2Mw0KRGViaXQgQWNjb3VudCBOdW1iZXI6ICAgICAgICAgICAgICAgMDMwNDE0MDENCkRlYml0IEFjY291bnQgQ3VycmVuY3k6ICAgICAgICAgICAgIFBvdW5kIFN0ZXJsaW5nDQpQYXltZW50IEN1cnJlbmN5OiAgICAgICAgICAgICAgICAgICBQb3VuZCBTdGVybGluZw0KUGF5bWVudCBBbW91bnQ6ICAgICAgICAgICAgICAgICAgICAgMjYwMC4wMA0KVHJhbnNhY3Rpb24gUmVmZXJlbmNlIE51bWJlcjogICAgICAgQlgxNTA0MjAwNjkzMjYwNw0KVmFsdWUgRGF0ZTogICAgICAgICAgICAgICAgICAgICAgICAgQXByIDI0LCAyMDE1DQpDdXN0b21lciBSZWZlcmVuY2U6ICAgICAgICAgICAgICAgICAxMjMxMjMxMjMNCk51bWJlciBvZiBjcmVkaXQvZGViaXQgcmVjb3JkczoJICAgIDENCg0KQmVuZWZpY2lhcnkgTmFtZTogICAgICAgICAgICAgICAgICAgMTM0MjM0MjMNCkJlbmVmaWNpYXJ5IEFjY291bnQgQmFuayBJZGVudGlmaWVyOjE4NTAwOA0KQmVuZWZpY2lh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&amp;Signature_Format=PKCS7_basic&amp;IsDetailScrAction=false&amp;pd=F0263A0E242E4C94B60DD204F44B6CAB&amp;gssRefId=7a4a1763-0ac0-4fb7-9d98-e6053e95d191401141426801730&amp;gssStore=true"
   }
}]]></con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/verify</con:originalUri><con:assertion type="GroovyScriptAssertion" id="b2b9bd53-4cd9-4378-ad3e-a47f8bc3793c" name="Script Assertion" disabled="true"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "ERROR"


assert jsonMap.gssResponseHeader.gssError.errorCode == "INSUFFICIENT_PARAMETERS"


assert jsonMap.gssResponseHeader.gssError.errorMsg == "The mandatory field USER_AGENT is missing or its value is empty  in RequestContext"
</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:properties/></con:testCase><con:testCase id="517b80c7-1644-4c61-9858-31e769a2b9a3" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="TestCase 2.11-Login-IncorrectObjetc" searchProperties="true"><con:settings/><con:testStep type="restrequest" name="GetDeviceList" id="58763c41-52fa-4601-beed-fe7125a65230"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/devicelist" methodName="Devicelist" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="GetDeviceList" id="b063e9a0-5f4c-484f-b84a-038d96c080c1" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request>{
	"gssRequestHeader":{
		"serviceContext":{
			"USER_AGENT":"Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
			"APPLICATION":"B.NET"
		},
		"securityContext":null,
		"requestContext":{
			"REQUEST_TIMESTAMP":"2011-06-14T04:12:36BST",
			"REQUEST_TRACKING_ID":"REQ10001",
			"CALLBACK_URL":"https://bnet.barclays.com/"
		},
		"auditContext":{
			"MODULE_ID":"B.Net Login Module",
			"IS_FINANCIAL_TRANSACTION":"false",
			"CLIENT_IP_ADDRESS":"35.53.180.6"
		}
	},
	"deviceRequestMap":{
		"ONLY_ACTIVE":"true",
		"OUTPUT_TYPE":"BOTH"
	}
}</con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/devicelist</con:originalUri><con:assertion type="GroovyScriptAssertion" id="6c166ddf-cdfe-4189-9b56-bea28374973b" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "SUCCESS"
assert jsonMap.deviceInfo[0].DeviceDetailMap.STATUS == "Active"</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-GetDeviceList" id="b435cf26-69f0-4b48-bc80-53502af437bf"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-SC</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>GetDeviceList</con:sourceStep><con:sourcePath>gssResponseHeader.securityContext</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>InitiateLogin</con:targetStep><con:targetPath>initiateRequestHeader.gssRequestHeader.securityContext</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="restrequest" name="InitiateLogin" id="0944a5e2-d7e9-4418-8739-9616f08b5317"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/initiate" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="InitiateLogin" id="45730af7-4d98-41bd-a00f-24929dff6304" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request>{
   "transactionItemList": [],
   "preFormattedData": "VGhpcyBpcyBhIHNhbXBsZSBvZiBwcmVmb3JtYXR0ZWQgZGF0YSwgY3JlYXRlZCBvbiAyNy8wMy8yMDE1Lg==",
   "initiateRequestHeader":    {
      "gssRequestHeader":       {
         "serviceContext":          {
            "PURN_TYPE": "pki",
            "USER_AGENT": "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
            "PURN": "99800000008804000050",
            "APPLICATION": "B.NET"
         },
         "auditContext":          {
            "MODULE_ID": "12345678901234567890123456789012345678901",
            "IS_FINANCIAL_TRANSACTION": "false",
            "SUB_MODULE_ID": "eyJVU0VSX0FHRU5UIjoiSUU4IiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IkdCIn0=",
            "SUBMODULE_ID": "eyJVU0VSX0FHRU5UIjoiSUU4IiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IkdCIn0=",
            "CLIENT_IP_ADDRESS": "35.53.180.6"
         },
         "requestContext":          {
            "REQUEST_TIMESTAMP": "2011-06-14T04:12:36BST",
            "REQUEST_TRACKING_ID": "REQ10001",
            "CALLBACK_URL": "https://bnet.barclays.com/"
         },
         "securityContext": "eyJVU0VSX0FHRU5UIjoiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgNi4xOyBXT1c2NDsgVHJpZGVudC83LjA7IEFTOyBydjoxMS4wKSBsaWtlIEdlY2tvIiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IlBVIn0="
      },
      "initiateRequestHeaderDetails":       {
         "FUNCTION_TYPE": "AUTHENTICATE",
         "ACTION_TYPE": "SUBMIT",
         "DEVICE_TYPE_CODE": "SC",
         "OUTPUT_TYPE": "HTML"
      }
   },
   "requestDetailsMap": {}
}</con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/initiate</con:originalUri><con:assertion type="GroovyScriptAssertion" id="3f2a7f7f-4150-4f59-b57e-eddb93b59884" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "SUCCESS"
assert jsonMap.gssResponseHeader.responseContext.NEXTACTION == "VERIFY"</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Login_SecurityContext" id="c82b68c3-14d5-4781-9961-195addcbabdb"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>SGG-SC</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateLogin</con:sourceStep><con:sourcePath>gssResponseHeader.securityContext</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifyLogin</con:targetStep><con:targetPath>gssRequestHeader.securityContext</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Login_GSS-Nonce" id="038b954c-0474-4f6d-b0da-46a7068f5543" disabled="true"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-NONCE</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateLogin</con:sourceStep><con:sourcePath>gssResponseHeader.responseContext.GSS_NONCE</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifyLogin</con:targetStep><con:targetPath>gssRequestHeader.requestContext.GSS_NONCE</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Login_GSS-Ref-ID" id="1303cbc2-fd44-4379-afab-c63e2ff6c413" disabled="true"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-REF-ID</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateLogin</con:sourceStep><con:sourcePath>initiateResponseDetailsMap.GSS_REFERENCE_ID</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifyLogin</con:targetStep><con:targetPath>verifyDetailMap.GSS_REFERENCE_ID</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="restrequest" name="VerifyLogin" id="cf4672cc-5057-4b9d-920d-d82aa039b251"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/verify" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="VerifyLogin" id="ae8cc01d-5b14-46b5-8fa6-6207c40ac5af" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request><![CDATA[{
   "verifyDetailMap": {"GSS_REFERENCE_ID": "46016D2261964A5E8D5BA439F56A57A9"},
   "gssRequestHeader":    {
      "serviceContext":       {
         "USER_AGENT": "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
         "APPLICATION": "B.NET"
      },
      "auditContext":       {
         "MODULE_ID": "B.Net Login Module",
         "IS_FINANCIAL_TRANSACTION": "false",
         "CLIENT_IP_ADDRESS": "35.53.180.6"
      },
      "securityContext": "eyJQVVJOX1RZUEUiOiJwa2kiLCJQVVJOIjoiOTk4MDAwMDAwMDg4MDQwMDAwNTAiLCJVU0VSX0FHRU5UIjoiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgNi4xOyBXT1c2NDsgVHJpZGVudC83LjA7IEFTOyBydjoxMS4wKSBsaWtlIEdlY2tvIiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIkRFVklDRV9UWVBFX0NPREUiOiJTQyIsIlJFR0lPTiI6IkdCIiwiR1NTX1JFRkVSRU5DRV9JRCI6IjMxODkyRjA5MzhFQTQ4NDA4QTJFOTdCQTkxOTUzQTEyIn0=",
      "-requestContext":       {
         "REQUEST_TIMESTAMP": "2011-06-14T04:12:36BST",
         "REQUEST_TRACKING_ID": "REQ10001",
         "CALLBACK_URL": "https://bnet.barclays.com/",
         "GSS_NONCE": "8c028017-83ec-4393-894b-3e9e2087c40e"
      }
   },
   "deviceParamMap":    {
      "HTTP_METHOD": "PUT",
      "HTTP_INPUT_CONTENTS": "Version_Spec=100&amp;Version_Plugin_Major=3&amp;Version_Plugin_Minor=0&amp;Version_Browser_Major=0&amp;Version_Browser_Minor=11&amp;Transaction_ID=7a4a1763-0ac0-4fb7-9d98-e6053e95d191401141426801730&amp;Signature_Data=MIIPZgYJKoZIhvcNAQcCoIIPVzCCD1MCAQExCzAJBgUrDgMCGgUAMIID2wYJKoZIhvcNAQcBoIIDzASCA8hDbGllbnQgTmFtZTogICAgICAgICAgICAgICAgICAgICAgICBURVNUSU5HIENPTVBBTlkgICAgICAgICAgICAgICAgICAgICAgIA0KRG9jdW1lbnQgSUQ6ICAgICAgICAgICAgICAgICAgICAgICAgRjAyNjNBMEUyNDJFNEM5NEI2MEREMjA0RjQ0QjZDQUINClNpZ24gYW5kIFN1Ym1pdCB0aGUgZm9sbG93aW5nIHRyYW5zYWN0aW9ucyAoMSkNCg0KUGF5bWVudCBUeXBlOiAgICAgICAgICAgICAgICAgICAgICAgRG9tZXN0aWMgUGF5bWVudA0KRGVsaXZlcnkgT3B0aW9uOiAgICAgICAgICAgICAgICAgICAgVUsgVGhyZWUgRGF5IFBheW1lbnQNCkRlYml0IEFjY291bnQgQmFuayBJZGVudGlmaWVyOiAgICAgIDA5MDA2Mw0KRGViaXQgQWNjb3VudCBOdW1iZXI6ICAgICAgICAgICAgICAgMDMwNDE0MDENCkRlYml0IEFjY291bnQgQ3VycmVuY3k6ICAgICAgICAgICAgIFBvdW5kIFN0ZXJsaW5nDQpQYXltZW50IEN1cnJlbmN5OiAgICAgICAgICAgICAgICAgICBQb3VuZCBTdGVybGluZw0KUGF5bWVudCBBbW91bnQ6ICAgICAgICAgICAgICAgICAgICAgMjYwMC4wMA0KVHJhbnNhY3Rpb24gUmVmZXJlbmNlIE51bWJlcjogICAgICAgQlgxNTA0MjAwNjkzMjYwNw0KVmFsdWUgRGF0ZTogICAgICAgICAgICAgICAgICAgICAgICAgQXByIDI0LCAyMDE1DQpDdXN0b21lciBSZWZlcmVuY2U6ICAgICAgICAgICAgICAgICAxMjMxMjMxMjMNCk51bWJlciBvZiBjcmVkaXQvZGViaXQgcmVjb3JkczoJICAgIDENCg0KQmVuZWZpY2lhcnkgTmFtZTogICAgICAgICAgICAgICAgICAgMTM0MjM0MjMNCkJlbmVmaWNpYXJ5IEFjY291bnQgQmFuayBJZGVudGlmaWVyOjE4NTAwOA0KQmVuZWZpY2lh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&amp;Signature_Format=PKCS7_basic&amp;IsDetailScrAction=false&amp;pd=F0263A0E242E4C94B60DD204F44B6CAB&amp;gssRefId=7a4a1763-0ac0-4fb7-9d98-e6053e95d191401141426801730&amp;gssStore=true"
   }
}]]></con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/verify</con:originalUri><con:assertion type="GroovyScriptAssertion" id="b2b9bd53-4cd9-4378-ad3e-a47f8bc3793c" name="Script Assertion" disabled="true"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "SUCCESS"
assert jsonMap.gssResponseHeader.responseContext.NEXTACTION == "COMPLETE"</scriptText></con:configuration></con:assertion><con:assertion type="Simple NotContains" id="1350b3d8-39e6-4cd5-a887-f2b92b320d9a" name="Not Contains"><con:configuration><token>SUCCESS</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:properties/></con:testCase><con:testCase id="bf7a3ada-1333-48f3-b10b-9f9b8c9c54d4" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="TestCase 2.12-Login-ILLEGAL_DATA_MODIFICATION" searchProperties="true"><con:settings/><con:testStep type="restrequest" name="GetDeviceList" id="c5285ea5-20ab-4999-ac07-263c1d906dfa"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/devicelist" methodName="Devicelist" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="GetDeviceList" id="b063e9a0-5f4c-484f-b84a-038d96c080c1" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request>{
	"gssRequestHeader":{
		"serviceContext":{
			"USER_AGENT":"Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
			"APPLICATION":"B.NET"
		},
		"securityContext":null,
		"requestContext":{
			"REQUEST_TIMESTAMP":"2011-06-14T04:12:36BST",
			"REQUEST_TRACKING_ID":"REQ10001",
			"CALLBACK_URL":"https://bnet.barclays.com/"
		},
		"auditContext":{
			"MODULE_ID":"B.Net Login Module",
			"IS_FINANCIAL_TRANSACTION":"false",
			"CLIENT_IP_ADDRESS":"35.53.180.6"
		}
	},
	"deviceRequestMap":{
		"ONLY_ACTIVE":"true",
		"OUTPUT_TYPE":"BOTH"
	}
}</con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/devicelist</con:originalUri><con:assertion type="GroovyScriptAssertion" id="6c166ddf-cdfe-4189-9b56-bea28374973b" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "SUCCESS"
assert jsonMap.deviceInfo[0].DeviceDetailMap.STATUS == "Active"</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-GetDeviceList" id="4f3edf94-77d7-4e93-a562-ec5646c225c9"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-SC</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>GetDeviceList</con:sourceStep><con:sourcePath>gssResponseHeader.securityContext</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>InitiateLogin</con:targetStep><con:targetPath>initiateRequestHeader.gssRequestHeader.securityContext</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="restrequest" name="InitiateLogin" id="15ece08b-4682-4146-80cd-d18da89b2269"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/initiate" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="InitiateLogin" id="45730af7-4d98-41bd-a00f-24929dff6304" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request>{
   "transactionItemList": [],
   "preFormattedData": "VGhpcyBpcyBhIHNhbXBsZSBvZiBwcmVmb3JtYXR0ZWQgZGF0YSwgY3JlYXRlZCBvbiAyNy8wMy8yMDE1Lg==",
   "initiateRequestHeader":    {
      "gssRequestHeader":       {
         "serviceContext":          {
            "PURN_TYPE": "pki",
            "PURN": "99800000008804000050",
            "USER_AGENT": "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
            "APPLICATION": "B.NET"
         },
         "auditContext":          {
            "MODULE_ID": "12345678901234567890123456789012345678901",
            "IS_FINANCIAL_TRANSACTION": "false",
            "SUB_MODULE_ID": "eyJVU0VSX0FHRU5UIjoiSUU4IiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IkdCIn0=",
            "SUBMODULE_ID": "eyJVU0VSX0FHRU5UIjoiSUU4IiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IkdCIn0=",
            "CLIENT_IP_ADDRESS": "35.53.180.6"
         },
         "requestContext":          {
            "REQUEST_TIMESTAMP": "2011-06-14T04:12:36BST",
            "REQUEST_TRACKING_ID": "REQ10001",
            "CALLBACK_URL": "https://bnet.barclays.com/"
         },
         "securityContext": "eyJVU0VSX0FHRU5UIjoiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgNi4xOyBXT1c2NDsgVHJpZGVudC83LjA7IEFTOyBydjoxMS4wKSBsaWtlIEdlY2tvIiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IlBVIn0="
      },
      "initiateRequestHeaderDetails":       {
         "FUNCTION_TYPE": "AUTHENTICATE",
         "ACTION_TYPE": "SUBMIT",
         "DEVICE_TYPE_CODE": "FV",
         "OUTPUT_TYPE": "HTML"
      }
   },
   "requestDetailsMap": {}
}</con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/initiate</con:originalUri><con:assertion type="GroovyScriptAssertion" id="3f2a7f7f-4150-4f59-b57e-eddb93b59884" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "SUCCESS"
assert jsonMap.gssResponseHeader.responseContext.NEXTACTION == "VERIFY"</scriptText></con:configuration></con:assertion><con:assertion type="Simple NotContains" id="8e764f2a-08c4-484a-ae2c-e00938057b31" name="Not Contains" disabled="true"><con:configuration><token>SUCCESS</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Login_SecurityContext" id="b62336b5-76f1-43c4-90ac-37240ef7304d"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>SGG-SC</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateLogin</con:sourceStep><con:sourcePath>gssResponseHeader.securityContext</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifyLogin</con:targetStep><con:targetPath>gssRequestHeader.securityContext</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Login_GSS-Nonce" id="87f6b2e2-5a31-48ce-9205-7f67f3844a4f"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-NONCE</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateLogin</con:sourceStep><con:sourcePath>gssResponseHeader.responseContext.GSS_NONCE</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifyLogin</con:targetStep><con:targetPath>gssRequestHeader.requestContext.GSS_NONCE</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Login_GSS-Ref-ID" id="54f177c0-a62d-4c6f-b8e8-0cfdfe4adb17"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-REF-ID</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateLogin</con:sourceStep><con:sourcePath>initiateResponseDetailsMap.GSS_REFERENCE_ID</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifyLogin</con:targetStep><con:targetPath>verifyDetailMap.GSS_REFERENCE_ID</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="restrequest" name="VerifyLogin" id="74e4dada-b933-461c-af59-e044e04f4d0a"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/verify" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="VerifyLogin" id="ae8cc01d-5b14-46b5-8fa6-6207c40ac5af" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request><![CDATA[{
   "verifyDetailMap": {"GSS_REFERENCE_ID": "D5F7D535D601435895E16B5AB3929D11"},
   "gssRequestHeader":    {
      "serviceContext":       {
         "USER_AGENT": "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
         "APPLICATION": "B.NET"
      },
      "auditContext":       {
         "MODULE_ID": "B.Net Login Module",
         "IS_FINANCIAL_TRANSACTION": "false",
         "CLIENT_IP_ADDRESS": "35.53.180.6"
      },
      "requestContext":       {
         "REQUEST_TIMESTAMP": "2011-06-14T04:12:36BST",
         "REQUEST_TRACKING_ID": "REQ10001",
         "CALLBACK_URL": "https://bnet.barclays.com/",
         "GSS_NONCE": "e4812870-4734-4b8a-ad04-f2d92cd6f4c0"
      },
      "securityContext": "eyJQVVJOX1RZUEUiOiJwa2kiLCJQVVJOIjoiOTk4MDAwMDAwMDg4MDQwMDAwNTAiLCJVU0VSX0FHRU5UIjoiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgNi4xOyBXT1c2NDsgVHJpZGVudC83LjA7IEFTOyBydjoxMS4wKSBsaWtlIEdlY2tvIiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIkRFVklDRV9UWVBFX0NPREUiOiJGViIsIlJFR0lPTiI6IkdCIiwiR1NTX1JFRkVSRU5DRV9JRCI6IkQ1RjdENTM1RDYwMTQzNTg5NUUxNkI1QUIzOTI5RDExIn0="
   },
   "deviceParamMap":    {
      "HTTP_METHOD": "PUT",
      "HTTP_INPUT_CONTENTS": "Version_Spec=100&amp;Version_Plugin_Major=3&amp;Version_Plugin_Minor=0&amp;Version_Browser_Major=0&amp;Version_Browser_Minor=11&amp;Transaction_ID=7a4a1763-0ac0-4fb7-9d98-e6053e95d191401141426801730&amp;Signature_Data=MIIPZgYJKoZIhvcNAQcCoIIPVzCCD1MCAQExCzAJBgUrDgMCGgUAMIID2wYJKoZIhvcNAQcBoIIDzASCA8hDbGllbnQgTmFtZTogICAgICAgICAgICAgICAgICAgICAgICBURVNUSU5HIENPTVBBTlkgICAgICAgICAgICAgICAgICAgICAgIA0KRG9jdW1lbnQgSUQ6ICAgICAgICAgICAgICAgICAgICAgICAgRjAyNjNBMEUyNDJFNEM5NEI2MEREMjA0RjQ0QjZDQUINClNpZ24gYW5kIFN1Ym1pdCB0aGUgZm9sbG93aW5nIHRyYW5zYWN0aW9ucyAoMSkNCg0KUGF5bWVudCBUeXBlOiAgICAgICAgICAgICAgICAgICAgICAgRG9tZXN0aWMgUGF5bWVudA0KRGVsaXZlcnkgT3B0aW9uOiAgICAgICAgICAgICAgICAgICAgVUsgVGhyZWUgRGF5IFBheW1lbnQNCkRlYml0IEFjY291bnQgQmFuayBJZGVudGlmaWVyOiAgICAgIDA5MDA2Mw0KRGViaXQgQWNjb3VudCBOdW1iZXI6ICAgICAgICAgICAgICAgMDMwNDE0MDENCkRlYml0IEFjY291bnQgQ3VycmVuY3k6ICAgICAgICAgICAgIFBvdW5kIFN0ZXJsaW5nDQpQYXltZW50IEN1cnJlbmN5OiAgICAgICAgICAgICAgICAgICBQb3VuZCBTdGVybGluZw0KUGF5bWVudCBBbW91bnQ6ICAgICAgICAgICAgICAgICAgICAgMjYwMC4wMA0KVHJhbnNhY3Rpb24gUmVmZXJlbmNlIE51bWJlcjogICAgICAgQlgxNTA0MjAwNjkzMjYwNw0KVmFsdWUgRGF0ZTogICAgICAgICAgICAgICAgICAgICAgICAgQXByIDI0LCAyMDE1DQpDdXN0b21lciBSZWZlcmVuY2U6ICAgICAgICAgICAgICAgICAxMjMxMjMxMjMNCk51bWJlciBvZiBjcmVkaXQvZGViaXQgcmVjb3JkczoJICAgIDENCg0KQmVuZWZpY2lhcnkgTmFtZTogICAgICAgICAgICAgICAgICAgMTM0MjM0MjMNCkJlbmVmaWNpYXJ5IEFjY291bnQgQmFuayBJZGVudGlmaWVyOjE4NTAwOA0KQmVuZWZpY2lh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&amp;Signature_Format=PKCS7_basic&amp;IsDetailScrAction=false&amp;pd=F0263A0E242E4C94B60DD204F44B6CAB&amp;gssRefId=7a4a1763-0ac0-4fb7-9d98-e6053e95d191401141426801730&amp;gssStore=true"
   }
}]]></con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/verify</con:originalUri><con:assertion type="GroovyScriptAssertion" id="b2b9bd53-4cd9-4378-ad3e-a47f8bc3793c" name="Script Assertion" disabled="true"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "SUCCESS"
assert jsonMap.gssResponseHeader.responseContext.NEXTACTION == "COMPLETE"</scriptText></con:configuration></con:assertion><con:assertion type="Simple NotContains" id="fcfc605e-23f2-411c-99ff-97c4fb8ca583" name="Not Contains"><con:configuration><token>SUCCESS</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:properties/></con:testCase><con:testCase id="3f2c63f3-ef0b-490f-9481-90a4d8f8c163" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="TestCase 3.1-Signing-HappyFlow" searchProperties="true"><con:settings/><con:testStep type="restrequest" name="GetDeviceList" id="3db956f2-f9c3-4e0f-975b-f50522c2ead4"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/devicelist" methodName="Devicelist" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="GetDeviceList" id="b063e9a0-5f4c-484f-b84a-038d96c080c1" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request>{
	"gssRequestHeader":{
		"serviceContext":{
			"USER_AGENT":"Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
			"APPLICATION":"B.NET"
		},
		"securityContext":null,
		"requestContext":{
			"REQUEST_TIMESTAMP":"2011-06-14T04:12:36BST",
			"REQUEST_TRACKING_ID":"REQ10001",
			"CALLBACK_URL":"https://bnet.barclays.com/"
		},
		"auditContext":{
			"MODULE_ID":"B.Net Login Module",
			"IS_FINANCIAL_TRANSACTION":"false",
			"CLIENT_IP_ADDRESS":"35.53.180.6"
		}
	},
	"deviceRequestMap":{
		"ONLY_ACTIVE":"true",
		"OUTPUT_TYPE":"BOTH"
	}
}</con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/devicelist</con:originalUri><con:assertion type="GroovyScriptAssertion" id="6c166ddf-cdfe-4189-9b56-bea28374973b" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "SUCCESS"
assert jsonMap.deviceInfo[0].DeviceDetailMap.STATUS == "Active"</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-GetDeviceList" id="7e914b13-2140-4724-8dc8-ac581b7b5178"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-SC</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>GetDeviceList</con:sourceStep><con:sourcePath>gssResponseHeader.securityContext</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>InitiateLogin</con:targetStep><con:targetPath>initiateRequestHeader.gssRequestHeader.securityContext</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="restrequest" name="InitiateLogin" id="ea7ef23c-2649-496b-8845-225cc66bf089"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/initiate" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="InitiateLogin" id="45730af7-4d98-41bd-a00f-24929dff6304" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request>{
   "transactionItemList": [],
   "preFormattedData": "VGhpcyBpcyBhIHNhbXBsZSBvZiBwcmVmb3JtYXR0ZWQgZGF0YSwgY3JlYXRlZCBvbiAyNy8wMy8yMDE1Lg==",
   "initiateRequestHeader":    {
      "gssRequestHeader":       {
         "serviceContext":          {
            "PURN_TYPE": "pki",
            "USER_AGENT": "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
            "PURN": "99800000008804000050",
            "APPLICATION": "B.NET"
         },
         "auditContext":          {
            "MODULE_ID": "12345678901234567890123456789012345678901",
            "IS_FINANCIAL_TRANSACTION": "false",
            "SUB_MODULE_ID": "eyJVU0VSX0FHRU5UIjoiSUU4IiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IkdCIn0=",
            "SUBMODULE_ID": "eyJVU0VSX0FHRU5UIjoiSUU4IiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IkdCIn0=",
            "CLIENT_IP_ADDRESS": "35.53.180.6"
         },
         "requestContext":          {
            "REQUEST_TIMESTAMP": "2011-06-14T04:12:36BST",
            "REQUEST_TRACKING_ID": "REQ10001",
            "CALLBACK_URL": "https://bnet.barclays.com/"
         },
         "securityContext": "eyJVU0VSX0FHRU5UIjoiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgNi4xOyBXT1c2NDsgVHJpZGVudC83LjA7IEFTOyBydjoxMS4wKSBsaWtlIEdlY2tvIiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IlBVIn0="
      },
      "initiateRequestHeaderDetails":       {
         "FUNCTION_TYPE": "AUTHENTICATE",
         "ACTION_TYPE": "SUBMIT",
         "DEVICE_TYPE_CODE": "SC",
         "OUTPUT_TYPE": "HTML"
      }
   },
   "requestDetailsMap": {}
}</con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/initiate</con:originalUri><con:assertion type="GroovyScriptAssertion" id="3f2a7f7f-4150-4f59-b57e-eddb93b59884" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "SUCCESS"
assert jsonMap.gssResponseHeader.responseContext.NEXTACTION == "VERIFY"</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Login_SecurityContext" id="56bc5091-6c26-4684-858e-bd88f7fe3976"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>SGG-SC</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateLogin</con:sourceStep><con:sourcePath>gssResponseHeader.securityContext</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifyLogin</con:targetStep><con:targetPath>gssRequestHeader.securityContext</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Login_GSS-Nonce" id="dacccabc-4883-412c-afa2-6edce077682f"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-NONCE</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateLogin</con:sourceStep><con:sourcePath>gssResponseHeader.responseContext.GSS_NONCE</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifyLogin</con:targetStep><con:targetPath>gssRequestHeader.requestContext.GSS_NONCE</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Login_GSS-Ref-ID" id="ec939997-4b5c-4de6-935a-935c7db430b2"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-REF-ID</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateLogin</con:sourceStep><con:sourcePath>initiateResponseDetailsMap.GSS_REFERENCE_ID</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifyLogin</con:targetStep><con:targetPath>verifyDetailMap.GSS_REFERENCE_ID</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="restrequest" name="VerifyLogin" id="9d93700f-4fae-4d38-9d6c-e9655adc615e"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/verify" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="VerifyLogin" id="ae8cc01d-5b14-46b5-8fa6-6207c40ac5af" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request><![CDATA[{
   "verifyDetailMap": {"GSS_REFERENCE_ID": "4EF51C6701F746FBB1F2EF726A662725"},
   "gssRequestHeader":    {
      "serviceContext":       {
         "USER_AGENT": "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
         "APPLICATION": "B.NET"
      },
      "auditContext":       {
         "MODULE_ID": "B.Net Login Module",
         "IS_FINANCIAL_TRANSACTION": "false",
         "CLIENT_IP_ADDRESS": "35.53.180.6"
      },
      "requestContext":       {
         "REQUEST_TIMESTAMP": "2011-06-14T04:12:36BST",
         "REQUEST_TRACKING_ID": "REQ10001",
         "CALLBACK_URL": "https://bnet.barclays.com/",
         "GSS_NONCE": "de647c8e-cdfe-4e61-8e64-bc4cc4c9c4ba"
      },
      "securityContext": "eyJQVVJOX1RZUEUiOiJwa2kiLCJQVVJOIjoiOTk4MDAwMDAwMDg4MDQwMDAwNTAiLCJVU0VSX0FHRU5UIjoiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgNi4xOyBXT1c2NDsgVHJpZGVudC83LjA7IEFTOyBydjoxMS4wKSBsaWtlIEdlY2tvIiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIkRFVklDRV9UWVBFX0NPREUiOiJTQyIsIlJFR0lPTiI6IkdCIiwiR1NTX1JFRkVSRU5DRV9JRCI6IjRFRjUxQzY3MDFGNzQ2RkJCMUYyRUY3MjZBNjYyNzI1In0="
   },
   "deviceParamMap":    {
      "HTTP_METHOD": "PUT",
      "HTTP_INPUT_CONTENTS": "Version_Spec=100&amp;Version_Plugin_Major=3&amp;Version_Plugin_Minor=0&amp;Version_Browser_Major=0&amp;Version_Browser_Minor=11&amp;Transaction_ID=7a4a1763-0ac0-4fb7-9d98-e6053e95d191401141426801730&amp;Signature_Data=MIIPZgYJKoZIhvcNAQcCoIIPVzCCD1MCAQExCzAJBgUrDgMCGgUAMIID2wYJKoZIhvcNAQcBoIIDzASCA8hDbGllbnQgTmFtZTogICAgICAgICAgICAgICAgICAgICAgICBURVNUSU5HIENPTVBBTlkgICAgICAgICAgICAgICAgICAgICAgIA0KRG9jdW1lbnQgSUQ6ICAgICAgICAgICAgICAgICAgICAgICAgRjAyNjNBMEUyNDJFNEM5NEI2MEREMjA0RjQ0QjZDQUINClNpZ24gYW5kIFN1Ym1pdCB0aGUgZm9sbG93aW5nIHRyYW5zYWN0aW9ucyAoMSkNCg0KUGF5bWVudCBUeXBlOiAgICAgICAgICAgICAgICAgICAgICAgRG9tZXN0aWMgUGF5bWVudA0KRGVsaXZlcnkgT3B0aW9uOiAgICAgICAgICAgICAgICAgICAgVUsgVGhyZWUgRGF5IFBheW1lbnQNCkRlYml0IEFjY291bnQgQmFuayBJZGVudGlmaWVyOiAgICAgIDA5MDA2Mw0KRGViaXQgQWNjb3VudCBOdW1iZXI6ICAgICAgICAgICAgICAgMDMwNDE0MDENCkRlYml0IEFjY291bnQgQ3VycmVuY3k6ICAgICAgICAgICAgIFBvdW5kIFN0ZXJsaW5nDQpQYXltZW50IEN1cnJlbmN5OiAgICAgICAgICAgICAgICAgICBQb3VuZCBTdGVybGluZw0KUGF5bWVudCBBbW91bnQ6ICAgICAgICAgICAgICAgICAgICAgMjYwMC4wMA0KVHJhbnNhY3Rpb24gUmVmZXJlbmNlIE51bWJlcjogICAgICAgQlgxNTA0MjAwNjkzMjYwNw0KVmFsdWUgRGF0ZTogICAgICAgICAgICAgICAgICAgICAgICAgQXByIDI0LCAyMDE1DQpDdXN0b21lciBSZWZlcmVuY2U6ICAgICAgICAgICAgICAgICAxMjMxMjMxMjMNCk51bWJlciBvZiBjcmVkaXQvZGViaXQgcmVjb3JkczoJICAgIDENCg0KQmVuZWZpY2lhcnkgTmFtZTogICAgICAgICAgICAgICAgICAgMTM0MjM0MjMNCkJlbmVmaWNpYXJ5IEFjY291bnQgQmFuayBJZGVudGlmaWVyOjE4NTAwOA0KQmVuZWZpY2lh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&amp;Signature_Format=PKCS7_basic&amp;IsDetailScrAction=false&amp;pd=F0263A0E242E4C94B60DD204F44B6CAB&amp;gssRefId=7a4a1763-0ac0-4fb7-9d98-e6053e95d191401141426801730&amp;gssStore=true"
   }
}]]></con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/verify</con:originalUri><con:assertion type="GroovyScriptAssertion" id="b2b9bd53-4cd9-4378-ad3e-a47f8bc3793c" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "SUCCESS"
assert jsonMap.gssResponseHeader.responseContext.NEXTACTION == "COMPLETE"</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Signing_SecurityContext" id="d4993167-2cd9-4adc-b544-376f1f62d8e4"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>SGG-SC</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>VerifyLogin</con:sourceStep><con:sourcePath>gssResponseHeader.securityContext</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>InitiateSigning</con:targetStep><con:targetPath>initiateRequestHeader.gssRequestHeader.securityContext</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="restrequest" name="InitiateSigning" id="6a60e380-9cfe-41cd-aea2-a2a3d4cd9081"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/initiate" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="InitiateSigning" id="45730af7-4d98-41bd-a00f-24929dff6304" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request>{
   "transactionItemList": [],
   "preFormattedData": "VGhpcyBpcyBhIHNhbXBsZSBvZiBwcmVmb3JtYXR0ZWQgZGF0YSwgY3JlYXRlZCBvbiAyNy8wMy8yMDE1Lg==",
   "initiateRequestHeader":    {
      "gssRequestHeader":       {
         "serviceContext":          {
            "PURN_TYPE": "pki",
            "PURN": "99800000008804000050",
            "USER_AGENT": "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
            "APPLICATION": "B.NET"
         },
         "auditContext":          {
            "MODULE_ID": "12345678901234567890123456789012345678901",
            "IS_FINANCIAL_TRANSACTION": "false",
            "SUB_MODULE_ID": "eyJVU0VSX0FHRU5UIjoiSUU4IiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IkdCIn0=",
            "SUBMODULE_ID": "eyJVU0VSX0FHRU5UIjoiSUU4IiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IkdCIn0=",
            "CLIENT_IP_ADDRESS": "35.53.180.6"
         },
         "requestContext":          {
            "REQUEST_TIMESTAMP": "2011-06-14T04:12:36BST",
            "REQUEST_TRACKING_ID": "REQ10001",
            "CALLBACK_URL": "https://bnet.barclays.com/"
         },
         "securityContext": "eyJQVVJOX1RZUEUiOiJwa2kiLCJQVVJOIjoiOTk4MDAwMDAwMDg4MDQwMDAwNTAiLCJVU0VSX0FHRU5UIjoiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgNi4xOyBXT1c2NDsgVHJpZGVudC83LjA7IEFTOyBydjoxMS4wKSBsaWtlIEdlY2tvIiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIkRFVklDRV9UWVBFX0NPREUiOiJTQyIsIlJFR0lPTiI6IkdCIiwiR1NTX1JFRkVSRU5DRV9JRCI6IjRFRjUxQzY3MDFGNzQ2RkJCMUYyRUY3MjZBNjYyNzI1IiwiQ0xJRU5UX05BTUUiOiJCYXJjbGF5cyBjb3JwIExpbWl0ZWQgVEQiLCJVU0VSX05BTUUiOiJKZXNpY2ExMCBhbGJhMTAiLCJERVZJQ0VfQUxJQVMiOiJTQyBBbGlhcyIsIlVTRVJfU1RBVFVTIjoiQUNUSVZFIn0="
      },
      "initiateRequestHeaderDetails":       {
         "FUNCTION_TYPE": "SIGN-TRANSACTIONS",
         "ACTION_TYPE": "SUBMIT",
         "DEVICE_TYPE_CODE": "SC",
         "OUTPUT_TYPE": "HTML"
      }
   },
   "requestDetailsMap": {}
}</con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/initiate</con:originalUri><con:assertion type="GroovyScriptAssertion" id="71871115-a758-42aa-9198-a94e0a41ea66" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "SUCCESS"
assert jsonMap.gssResponseHeader.responseContext.NEXTACTION == "VERIFY"</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Signing_SecurityContext1" id="0824f74d-b933-459c-88e7-d6e630124a9d"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>SGG-SC</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateSigning</con:sourceStep><con:sourcePath>gssResponseHeader.securityContext</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifySigning</con:targetStep><con:targetPath>gssRequestHeader.securityContext</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Signing_GSS-Nonce1" id="809c7605-f61a-4ca2-b3a1-35dbec6ba303"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-NONCE</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateSigning</con:sourceStep><con:sourcePath>gssResponseHeader.responseContext.GSS_NONCE</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifySigning</con:targetStep><con:targetPath>gssRequestHeader.requestContext.GSS_NONCE</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Signing_GSS-Ref-ID1" id="e36e36fd-7281-411c-89f0-bae76c864538"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-REF-ID</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateSigning</con:sourceStep><con:sourcePath>initiateResponseDetailsMap.GSS_REFERENCE_ID</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifySigning</con:targetStep><con:targetPath>verifyDetailMap.GSS_REFERENCE_ID
</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="restrequest" name="VerifySigning" id="0526e6be-d917-4ebd-a7d9-57028ae16789"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/verify" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="VerifySigning" id="ae8cc01d-5b14-46b5-8fa6-6207c40ac5af" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request><![CDATA[{
   "verifyDetailMap": {"GSS_REFERENCE_ID": "B963089AFC6743FFA426E31F2E4854D3"},
   "gssRequestHeader":    {
      "serviceContext":       {
         "USER_AGENT": "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
         "APPLICATION": "B.NET"
      },
      "auditContext":       {
         "MODULE_ID": "B.Net Login Module",
         "IS_FINANCIAL_TRANSACTION": "false",
         "CLIENT_IP_ADDRESS": "35.53.180.6"
      },
      "requestContext":       {
         "REQUEST_TIMESTAMP": "2011-06-14T04:12:36BST",
         "REQUEST_TRACKING_ID": "REQ10001",
         "CALLBACK_URL": "https://bnet.barclays.com/",
         "GSS_NONCE": "1d602a18-dccc-4bfb-857a-37d7208221ed"
      },
      "securityContext": "eyJQVVJOX1RZUEUiOiJwa2kiLCJVU0VSX05BTUUiOiJKZXNpY2ExMCBhbGJhMTAiLCJDTElFTlRfTkFNRSI6IkJhcmNsYXlzIGNvcnAgTGltaXRlZCBURCIsIlVTRVJfQUdFTlQiOiJNb3ppbGxhLzUuMCAoV2luZG93cyBOVCA2LjE7IFdPVzY0OyBUcmlkZW50LzcuMDsgQVM7IHJ2OjExLjApIGxpa2UgR2Vja28iLCJQVVJOIjoiOTk4MDAwMDAwMDg4MDQwMDAwNTAiLCJBUFBMSUNBVElPTiI6IkIuTkVUIiwiREVWSUNFX0FMSUFTIjoiU0MgQWxpYXMiLCJERVZJQ0VfVFlQRV9DT0RFIjoiU0MiLCJSRUdJT04iOiJHQiIsIlVTRVJfU1RBVFVTIjoiQUNUSVZFIiwiR1NTX1JFRkVSRU5DRV9JRCI6IkI5NjMwODlBRkM2NzQzRkZBNDI2RTMxRjJFNDg1NEQzIn0="
   },
   "deviceParamMap":    {
      "HTTP_METHOD": "PUT",
      "HTTP_INPUT_CONTENTS": "Version_Spec=100&amp;Version_Plugin_Major=3&amp;Version_Plugin_Minor=0&amp;Version_Browser_Major=0&amp;Version_Browser_Minor=11&amp;Transaction_ID=7a4a1763-0ac0-4fb7-9d98-e6053e95d191401141426801730&amp;Signature_Data=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&amp;Signature_Format=PKCS7_basic&amp;IsDetailScrAction=false&amp;pd=F0263A0E242E4C94B60DD204F44B6CAB&amp;gssRefId=7a4a1763-0ac0-4fb7-9d98-e6053e95d191401141426801730&amp;gssStore=true"
   }
}]]></con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/verify</con:originalUri><con:assertion type="GroovyScriptAssertion" id="351aafb0-2bc2-4ea1-8f84-b53498b9502b" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "SUCCESS"
assert jsonMap.gssResponseHeader.responseContext.NEXTACTION == "COMPLETE"</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:properties/></con:testCase><con:testCase id="314df6de-cfc6-4e0e-888a-ebe35446e310" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="TestCase 3.2-Signing-ReplayAttack" searchProperties="true"><con:settings/><con:testStep type="restrequest" name="GetDeviceList" id="69dbc92f-612b-401e-85ea-15e1b864147b"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/devicelist" methodName="Devicelist" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="GetDeviceList" id="b063e9a0-5f4c-484f-b84a-038d96c080c1" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request>{
	"gssRequestHeader":{
		"serviceContext":{
			"USER_AGENT":"Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
			"APPLICATION":"B.NET"
		},
		"securityContext":null,
		"requestContext":{
			"REQUEST_TIMESTAMP":"2011-06-14T04:12:36BST",
			"REQUEST_TRACKING_ID":"REQ10001",
			"CALLBACK_URL":"https://bnet.barclays.com/"
		},
		"auditContext":{
			"MODULE_ID":"B.Net Login Module",
			"IS_FINANCIAL_TRANSACTION":"false",
			"CLIENT_IP_ADDRESS":"35.53.180.6"
		}
	},
	"deviceRequestMap":{
		"ONLY_ACTIVE":"true",
		"OUTPUT_TYPE":"BOTH"
	}
}</con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/devicelist</con:originalUri><con:assertion type="GroovyScriptAssertion" id="6c166ddf-cdfe-4189-9b56-bea28374973b" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "SUCCESS"
assert jsonMap.deviceInfo[0].DeviceDetailMap.STATUS == "Active"</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-GetDeviceList" id="656b805d-ceb7-4157-8a94-21fbb5a7b9a5"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-SC</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>GetDeviceList</con:sourceStep><con:sourcePath>gssResponseHeader.securityContext</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>InitiateLogin</con:targetStep><con:targetPath>initiateRequestHeader.gssRequestHeader.securityContext</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="restrequest" name="InitiateLogin" id="5576d663-da8e-41af-84f0-ae2102c7a13e"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/initiate" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="InitiateLogin" id="45730af7-4d98-41bd-a00f-24929dff6304" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request>{
   "transactionItemList": [],
   "preFormattedData": "VGhpcyBpcyBhIHNhbXBsZSBvZiBwcmVmb3JtYXR0ZWQgZGF0YSwgY3JlYXRlZCBvbiAyNy8wMy8yMDE1Lg==",
   "initiateRequestHeader":    {
      "gssRequestHeader":       {
         "serviceContext":          {
            "PURN_TYPE": "pki",
            "USER_AGENT": "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
            "PURN": "99800000008804000050",
            "APPLICATION": "B.NET"
         },
         "auditContext":          {
            "MODULE_ID": "12345678901234567890123456789012345678901",
            "IS_FINANCIAL_TRANSACTION": "false",
            "SUB_MODULE_ID": "eyJVU0VSX0FHRU5UIjoiSUU4IiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IkdCIn0=",
            "SUBMODULE_ID": "eyJVU0VSX0FHRU5UIjoiSUU4IiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IkdCIn0=",
            "CLIENT_IP_ADDRESS": "35.53.180.6"
         },
         "requestContext":          {
            "REQUEST_TIMESTAMP": "2011-06-14T04:12:36BST",
            "REQUEST_TRACKING_ID": "REQ10001",
            "CALLBACK_URL": "https://bnet.barclays.com/"
         },
         "securityContext": "eyJVU0VSX0FHRU5UIjoiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgNi4xOyBXT1c2NDsgVHJpZGVudC83LjA7IEFTOyBydjoxMS4wKSBsaWtlIEdlY2tvIiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IlBVIn0="
      },
      "initiateRequestHeaderDetails":       {
         "FUNCTION_TYPE": "AUTHENTICATE",
         "ACTION_TYPE": "SUBMIT",
         "DEVICE_TYPE_CODE": "SC",
         "OUTPUT_TYPE": "HTML"
      }
   },
   "requestDetailsMap": {}
}</con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/initiate</con:originalUri><con:assertion type="GroovyScriptAssertion" id="3f2a7f7f-4150-4f59-b57e-eddb93b59884" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "SUCCESS"
assert jsonMap.gssResponseHeader.responseContext.NEXTACTION == "VERIFY"</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Login_SecurityContext" id="55d8df87-c70f-44d7-a590-7e66d7393e9e"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>SGG-SC</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateLogin</con:sourceStep><con:sourcePath>gssResponseHeader.securityContext</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifyLogin</con:targetStep><con:targetPath>gssRequestHeader.securityContext</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Login_GSS-Nonce" id="464646bd-4634-4b29-99bc-c38a8fbda521"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-NONCE</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateLogin</con:sourceStep><con:sourcePath>gssResponseHeader.responseContext.GSS_NONCE</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifyLogin</con:targetStep><con:targetPath>gssRequestHeader.requestContext.GSS_NONCE</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Login_GSS-Ref-ID" id="65d8e7cf-efce-474b-9f87-fe2210751acf"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-REF-ID</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateLogin</con:sourceStep><con:sourcePath>initiateResponseDetailsMap.GSS_REFERENCE_ID</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifyLogin</con:targetStep><con:targetPath>verifyDetailMap.GSS_REFERENCE_ID</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="restrequest" name="VerifyLogin" id="3eb2ebb5-55c0-4e00-b570-bbd0e22fc79e"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/verify" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="VerifyLogin" id="ae8cc01d-5b14-46b5-8fa6-6207c40ac5af" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request><![CDATA[{
   "verifyDetailMap": {"GSS_REFERENCE_ID": "EA9D155A9B554E6FB3B165B465C96DF3"},
   "gssRequestHeader":    {
      "serviceContext":       {
         "USER_AGENT": "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
         "APPLICATION": "B.NET"
      },
      "auditContext":       {
         "MODULE_ID": "B.Net Login Module",
         "IS_FINANCIAL_TRANSACTION": "false",
         "CLIENT_IP_ADDRESS": "35.53.180.6"
      },
      "requestContext":       {
         "REQUEST_TIMESTAMP": "2011-06-14T04:12:36BST",
         "REQUEST_TRACKING_ID": "REQ10001",
         "CALLBACK_URL": "https://bnet.barclays.com/",
         "GSS_NONCE": "12c025a3-4690-4725-9f25-90caee553e5d"
      },
      "securityContext": "eyJQVVJOX1RZUEUiOiJwa2kiLCJQVVJOIjoiOTk4MDAwMDAwMDg4MDQwMDAwNTAiLCJVU0VSX0FHRU5UIjoiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgNi4xOyBXT1c2NDsgVHJpZGVudC83LjA7IEFTOyBydjoxMS4wKSBsaWtlIEdlY2tvIiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIkRFVklDRV9UWVBFX0NPREUiOiJTQyIsIlJFR0lPTiI6IkdCIiwiR1NTX1JFRkVSRU5DRV9JRCI6IkVBOUQxNTVBOUI1NTRFNkZCM0IxNjVCNDY1Qzk2REYzIn0="
   },
   "deviceParamMap":    {
      "HTTP_METHOD": "PUT",
      "HTTP_INPUT_CONTENTS": "Version_Spec=100&amp;Version_Plugin_Major=3&amp;Version_Plugin_Minor=0&amp;Version_Browser_Major=0&amp;Version_Browser_Minor=11&amp;Transaction_ID=7a4a1763-0ac0-4fb7-9d98-e6053e95d191401141426801730&amp;Signature_Data=MIIPZgYJKoZIhvcNAQcCoIIPVzCCD1MCAQExCzAJBgUrDgMCGgUAMIID2wYJKoZIhvcNAQcBoIIDzASCA8hDbGllbnQgTmFtZTogICAgICAgICAgICAgICAgICAgICAgICBURVNUSU5HIENPTVBBTlkgICAgICAgICAgICAgICAgICAgICAgIA0KRG9jdW1lbnQgSUQ6ICAgICAgICAgICAgICAgICAgICAgICAgRjAyNjNBMEUyNDJFNEM5NEI2MEREMjA0RjQ0QjZDQUINClNpZ24gYW5kIFN1Ym1pdCB0aGUgZm9sbG93aW5nIHRyYW5zYWN0aW9ucyAoMSkNCg0KUGF5bWVudCBUeXBlOiAgICAgICAgICAgICAgICAgICAgICAgRG9tZXN0aWMgUGF5bWVudA0KRGVsaXZlcnkgT3B0aW9uOiAgICAgICAgICAgICAgICAgICAgVUsgVGhyZWUgRGF5IFBheW1lbnQNCkRlYml0IEFjY291bnQgQmFuayBJZGVudGlmaWVyOiAgICAgIDA5MDA2Mw0KRGViaXQgQWNjb3VudCBOdW1iZXI6ICAgICAgICAgICAgICAgMDMwNDE0MDENCkRlYml0IEFjY291bnQgQ3VycmVuY3k6ICAgICAgICAgICAgIFBvdW5kIFN0ZXJsaW5nDQpQYXltZW50IEN1cnJlbmN5OiAgICAgICAgICAgICAgICAgICBQb3VuZCBTdGVybGluZw0KUGF5bWVudCBBbW91bnQ6ICAgICAgICAgICAgICAgICAgICAgMjYwMC4wMA0KVHJhbnNhY3Rpb24gUmVmZXJlbmNlIE51bWJlcjogICAgICAgQlgxNTA0MjAwNjkzMjYwNw0KVmFsdWUgRGF0ZTogICAgICAgICAgICAgICAgICAgICAgICAgQXByIDI0LCAyMDE1DQpDdXN0b21lciBSZWZlcmVuY2U6ICAgICAgICAgICAgICAgICAxMjMxMjMxMjMNCk51bWJlciBvZiBjcmVkaXQvZGViaXQgcmVjb3JkczoJICAgIDENCg0KQmVuZWZpY2lhcnkgTmFtZTogICAgICAgICAgICAgICAgICAgMTM0MjM0MjMNCkJlbmVmaWNpYXJ5IEFjY291bnQgQmFuayBJZGVudGlmaWVyOjE4NTAwOA0KQmVuZWZpY2lh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&amp;Signature_Format=PKCS7_basic&amp;IsDetailScrAction=false&amp;pd=F0263A0E242E4C94B60DD204F44B6CAB&amp;gssRefId=7a4a1763-0ac0-4fb7-9d98-e6053e95d191401141426801730&amp;gssStore=true"
   }
}]]></con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/verify</con:originalUri><con:assertion type="GroovyScriptAssertion" id="b2b9bd53-4cd9-4378-ad3e-a47f8bc3793c" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "SUCCESS"
assert jsonMap.gssResponseHeader.responseContext.NEXTACTION == "COMPLETE"</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Signing_SecurityContext" id="d9093290-75e7-4de9-bf3d-2c8eb58ecb7a"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>SGG-SC</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>VerifyLogin</con:sourceStep><con:sourcePath>gssResponseHeader.securityContext</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>InitiateSigning</con:targetStep><con:targetPath>initiateRequestHeader.gssRequestHeader.securityContext</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="restrequest" name="InitiateSigning" id="acefb2f9-77f6-4e09-bc87-a3fcf02aa4c9"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/initiate" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="InitiateSigning" id="45730af7-4d98-41bd-a00f-24929dff6304" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request>{
   "transactionItemList": [],
   "preFormattedData": "VGhpcyBpcyBhIHNhbXBsZSBvZiBwcmVmb3JtYXR0ZWQgZGF0YSwgY3JlYXRlZCBvbiAyNy8wMy8yMDE1Lg==",
   "initiateRequestHeader":    {
      "gssRequestHeader":       {
         "serviceContext":          {
            "PURN_TYPE": "pki",
            "PURN": "99800000008804000050",
            "USER_AGENT": "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
            "APPLICATION": "B.NET"
         },
         "auditContext":          {
            "MODULE_ID": "12345678901234567890123456789012345678901",
            "IS_FINANCIAL_TRANSACTION": "false",
            "SUB_MODULE_ID": "eyJVU0VSX0FHRU5UIjoiSUU4IiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IkdCIn0=",
            "SUBMODULE_ID": "eyJVU0VSX0FHRU5UIjoiSUU4IiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IkdCIn0=",
            "CLIENT_IP_ADDRESS": "35.53.180.6"
         },
         "requestContext":          {
            "REQUEST_TIMESTAMP": "2011-06-14T04:12:36BST",
            "REQUEST_TRACKING_ID": "REQ10001",
            "CALLBACK_URL": "https://bnet.barclays.com/"
         },
         "securityContext": "eyJQVVJOX1RZUEUiOiJwa2kiLCJQVVJOIjoiOTk4MDAwMDAwMDg4MDQwMDAwNTAiLCJVU0VSX0FHRU5UIjoiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgNi4xOyBXT1c2NDsgVHJpZGVudC83LjA7IEFTOyBydjoxMS4wKSBsaWtlIEdlY2tvIiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIkRFVklDRV9UWVBFX0NPREUiOiJTQyIsIlJFR0lPTiI6IkdCIiwiR1NTX1JFRkVSRU5DRV9JRCI6IkVBOUQxNTVBOUI1NTRFNkZCM0IxNjVCNDY1Qzk2REYzIiwiQ0xJRU5UX05BTUUiOiJCYXJjbGF5cyBjb3JwIExpbWl0ZWQgVEQiLCJVU0VSX05BTUUiOiJKZXNpY2ExMCBhbGJhMTAiLCJERVZJQ0VfQUxJQVMiOiJTQyBBbGlhcyIsIlVTRVJfU1RBVFVTIjoiQUNUSVZFIn0="
      },
      "initiateRequestHeaderDetails":       {
         "FUNCTION_TYPE": "SIGN-TRANSACTIONS",
         "ACTION_TYPE": "SUBMIT",
         "DEVICE_TYPE_CODE": "SC",
         "OUTPUT_TYPE": "HTML"
      }
   },
   "requestDetailsMap": {}
}</con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/initiate</con:originalUri><con:assertion type="GroovyScriptAssertion" id="71871115-a758-42aa-9198-a94e0a41ea66" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "SUCCESS"
assert jsonMap.gssResponseHeader.responseContext.NEXTACTION == "VERIFY"</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Signing_SecurityContext1" id="1bae8d2a-9aec-4de1-8f04-42a22ea39096"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>SGG-SC</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateSigning</con:sourceStep><con:sourcePath>gssResponseHeader.securityContext</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifySigning</con:targetStep><con:targetPath>gssRequestHeader.securityContext</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Signing_GSS-Nonce1" id="a0c31dd2-8052-4fd6-8d34-9a3702d96e57"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-NONCE</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateSigning</con:sourceStep><con:sourcePath>gssResponseHeader.responseContext.GSS_NONCE</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifySigning</con:targetStep><con:targetPath>gssRequestHeader.requestContext.GSS_NONCE</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Signing_GSS-Ref-ID1" id="35727679-bf4b-4247-b55d-ae5c2c8f8674"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-REF-ID</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateSigning</con:sourceStep><con:sourcePath>initiateResponseDetailsMap.GSS_REFERENCE_ID</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifySigning</con:targetStep><con:targetPath>verifyDetailMap.GSS_REFERENCE_ID
</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="restrequest" name="VerifySigning" id="57c16428-0d35-4bd2-b3e4-24e1f490b078"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/verify" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="VerifySigning" id="ae8cc01d-5b14-46b5-8fa6-6207c40ac5af" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request><![CDATA[{
   "verifyDetailMap": {"GSS_REFERENCE_ID": "F2EFDE7124B64211A7010E7948315E72"},
   "gssRequestHeader":    {
      "serviceContext":       {
         "USER_AGENT": "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
         "APPLICATION": "B.NET"
      },
      "auditContext":       {
         "MODULE_ID": "B.Net Login Module",
         "IS_FINANCIAL_TRANSACTION": "false",
         "CLIENT_IP_ADDRESS": "35.53.180.6"
      },
      "requestContext":       {
         "REQUEST_TIMESTAMP": "2011-06-14T04:12:36BST",
         "REQUEST_TRACKING_ID": "REQ10001",
         "CALLBACK_URL": "https://bnet.barclays.com/",
         "GSS_NONCE": "b4c55305-d1d9-4c3d-a630-ed27a4ea63e7"
      },
      "securityContext": "eyJQVVJOX1RZUEUiOiJwa2kiLCJVU0VSX05BTUUiOiJKZXNpY2ExMCBhbGJhMTAiLCJDTElFTlRfTkFNRSI6IkJhcmNsYXlzIGNvcnAgTGltaXRlZCBURCIsIlVTRVJfQUdFTlQiOiJNb3ppbGxhLzUuMCAoV2luZG93cyBOVCA2LjE7IFdPVzY0OyBUcmlkZW50LzcuMDsgQVM7IHJ2OjExLjApIGxpa2UgR2Vja28iLCJQVVJOIjoiOTk4MDAwMDAwMDg4MDQwMDAwNTAiLCJBUFBMSUNBVElPTiI6IkIuTkVUIiwiREVWSUNFX0FMSUFTIjoiU0MgQWxpYXMiLCJERVZJQ0VfVFlQRV9DT0RFIjoiU0MiLCJSRUdJT04iOiJHQiIsIlVTRVJfU1RBVFVTIjoiQUNUSVZFIiwiR1NTX1JFRkVSRU5DRV9JRCI6IkYyRUZERTcxMjRCNjQyMTFBNzAxMEU3OTQ4MzE1RTcyIn0="
   },
   "deviceParamMap":    {
      "HTTP_METHOD": "PUT",
      "HTTP_INPUT_CONTENTS": "Version_Spec=100&amp;Version_Plugin_Major=3&amp;Version_Plugin_Minor=0&amp;Version_Browser_Major=0&amp;Version_Browser_Minor=11&amp;Transaction_ID=7a4a1763-0ac0-4fb7-9d98-e6053e95d191401141426801730&amp;Signature_Data=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&amp;Signature_Format=PKCS7_basic&amp;IsDetailScrAction=false&amp;pd=F0263A0E242E4C94B60DD204F44B6CAB&amp;gssRefId=7a4a1763-0ac0-4fb7-9d98-e6053e95d191401141426801730&amp;gssStore=true"
   }
}]]></con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/verify</con:originalUri><con:assertion type="GroovyScriptAssertion" id="351aafb0-2bc2-4ea1-8f84-b53498b9502b" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "SUCCESS"
assert jsonMap.gssResponseHeader.responseContext.NEXTACTION == "COMPLETE"</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="transfer" name="Copy of Property Transfer-Signing_SecurityContext1" id="cc233bd3-8c34-4ae9-a0b9-b869342500ff"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>SGG-SC</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>VerifySigning</con:sourceStep><con:sourcePath>gssResponseHeader.securityContext</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifySigning-Replay</con:targetStep><con:targetPath>gssRequestHeader.securityContext</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="transfer" name="Copy of Property Transfer-Signing_GSS-Nonce1" id="af82d332-f43c-4f98-948d-25b41a7b3e38"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-NONCE</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateSigning</con:sourceStep><con:sourcePath>gssResponseHeader.responseContext.GSS_NONCE</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifySigning</con:targetStep><con:targetPath>gssRequestHeader.requestContext.GSS_NONCE</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="transfer" name="Copy of Property Transfer-Signing_GSS-Ref-ID1" id="a5b9c423-973d-4922-88d0-fe6a13d4f9ba"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-REF-ID</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateSigning</con:sourceStep><con:sourcePath>initiateResponseDetailsMap.GSS_REFERENCE_ID</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifySigning</con:targetStep><con:targetPath>verifyDetailMap.GSS_REFERENCE_ID
</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="restrequest" name="VerifySigning-Replay" id="d8c82d05-054f-4762-89c9-5df27bf43d23"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/verify" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="VerifySigning-Replay" id="ae8cc01d-5b14-46b5-8fa6-6207c40ac5af" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request><![CDATA[{
   "verifyDetailMap": {"GSS_REFERENCE_ID": "F0558868FFAF4185B5CBFC4D63AF0FE0"},
   "gssRequestHeader":    {
      "serviceContext":       {
         "USER_AGENT": "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
         "APPLICATION": "B.NET"
      },
      "auditContext":       {
         "MODULE_ID": "B.Net Login Module",
         "IS_FINANCIAL_TRANSACTION": "false",
         "CLIENT_IP_ADDRESS": "35.53.180.6"
      },
      "requestContext":       {
         "REQUEST_TIMESTAMP": "2011-06-14T04:12:36BST",
         "REQUEST_TRACKING_ID": "REQ10001",
         "CALLBACK_URL": "https://bnet.barclays.com/",
         "GSS_NONCE": "f9394a41-9eb4-46e9-a3a1-7223dc21a6fe"
      },
      "securityContext": "eyJQVVJOX1RZUEUiOiJwa2kiLCJVU0VSX05BTUUiOiJKYW1lcyBNYXJrIEFsYmVydCIsIkNMSUVOVF9OQU1FIjoiU21hcnQgU3lzdGVtcyBJbnRlcm5hdGlvbmFsIiwiVVNFUl9BR0VOVCI6Ik1vemlsbGEvNS4wIChXaW5kb3dzIE5UIDYuMTsgV09XNjQ7IFRyaWRlbnQvNy4wOyBBUzsgcnY6MTEuMCkgbGlrZSBHZWNrbyIsIlBVUk4iOiI5OTgwMDAwMDAwODgwNDAwMDA1MCIsIkFQUExJQ0FUSU9OIjoiQi5ORVQiLCJERVZJQ0VfQUxJQVMiOiJPZmZpY2VHZW1hbHRvIiwiREVWSUNFX1RZUEVfQ09ERSI6IlNDIiwiUkVHSU9OIjoiR0IiLCJVU0VSX1NUQVRVUyI6IkFjdGl2ZSIsIkdTU19SRUZFUkVOQ0VfSUQiOiI4MTJENEVCQzA0RDA0NERDOTI3QTZDOTRGNzA2RUY2RSJ9"
   },
   "deviceParamMap":    {
      "HTTP_METHOD": "PUT",
      "HTTP_INPUT_CONTENTS": "Version_Spec=100&amp;Version_Plugin_Major=3&amp;Version_Plugin_Minor=0&amp;Version_Browser_Major=0&amp;Version_Browser_Minor=11&amp;Transaction_ID=7a4a1763-0ac0-4fb7-9d98-e6053e95d191401141426801730&amp;Signature_Data=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&amp;Signature_Format=PKCS7_basic&amp;IsDetailScrAction=false&amp;pd=F0263A0E242E4C94B60DD204F44B6CAB&amp;gssRefId=7a4a1763-0ac0-4fb7-9d98-e6053e95d191401141426801730&amp;gssStore=true"
   }
}]]></con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/verify</con:originalUri><con:assertion type="GroovyScriptAssertion" id="351aafb0-2bc2-4ea1-8f84-b53498b9502b" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "ERROR"


assert jsonMap.gssResponseHeader.gssError.errorCode == "INVALID_REFERENCE_ID"


assert jsonMap.gssResponseHeader.gssError.errorMsg == "Reference id is invalid or null"
</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:properties/></con:testCase><con:testCase id="d623a0af-03d7-49b7-86de-66c8bf4a774f" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="TestCase 3.3-Signing-Invalid_Ref_ID" searchProperties="true"><con:settings/><con:testStep type="restrequest" name="GetDeviceList" id="12fd341d-97e9-4bfb-b419-b49349c1d3ce"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/devicelist" methodName="Devicelist" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="GetDeviceList" id="b063e9a0-5f4c-484f-b84a-038d96c080c1" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request>{
	"gssRequestHeader":{
		"serviceContext":{
			"USER_AGENT":"Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
			"APPLICATION":"B.NET"
		},
		"securityContext":null,
		"requestContext":{
			"REQUEST_TIMESTAMP":"2011-06-14T04:12:36BST",
			"REQUEST_TRACKING_ID":"REQ10001",
			"CALLBACK_URL":"https://bnet.barclays.com/"
		},
		"auditContext":{
			"MODULE_ID":"B.Net Login Module",
			"IS_FINANCIAL_TRANSACTION":"false",
			"CLIENT_IP_ADDRESS":"35.53.180.6"
		}
	},
	"deviceRequestMap":{
		"ONLY_ACTIVE":"true",
		"OUTPUT_TYPE":"BOTH"
	}
}</con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/devicelist</con:originalUri><con:assertion type="GroovyScriptAssertion" id="6c166ddf-cdfe-4189-9b56-bea28374973b" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "SUCCESS"
assert jsonMap.deviceInfo[0].DeviceDetailMap.STATUS == "Active"</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-GetDeviceList" id="5e7c6768-3ab9-4bc7-974f-f955bf913513"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-SC</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>GetDeviceList</con:sourceStep><con:sourcePath>gssResponseHeader.securityContext</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>InitiateLogin</con:targetStep><con:targetPath>initiateRequestHeader.gssRequestHeader.securityContext</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="restrequest" name="InitiateLogin" id="e8fac105-8945-45f2-aa1e-eaf728d5fb59"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/initiate" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="InitiateLogin" id="45730af7-4d98-41bd-a00f-24929dff6304" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request>{
   "transactionItemList": [],
   "preFormattedData": "VGhpcyBpcyBhIHNhbXBsZSBvZiBwcmVmb3JtYXR0ZWQgZGF0YSwgY3JlYXRlZCBvbiAyNy8wMy8yMDE1Lg==",
   "initiateRequestHeader":    {
      "gssRequestHeader":       {
         "serviceContext":          {
            "PURN_TYPE": "pki",
            "PURN": "99800000008804000050",
            "USER_AGENT": "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
            "APPLICATION": "B.NET"
         },
         "auditContext":          {
            "MODULE_ID": "12345678901234567890123456789012345678901",
            "IS_FINANCIAL_TRANSACTION": "false",
            "SUB_MODULE_ID": "eyJVU0VSX0FHRU5UIjoiSUU4IiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IkdCIn0=",
            "SUBMODULE_ID": "eyJVU0VSX0FHRU5UIjoiSUU4IiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IkdCIn0=",
            "CLIENT_IP_ADDRESS": "35.53.180.6"
         },
         "requestContext":          {
            "REQUEST_TIMESTAMP": "2011-06-14T04:12:36BST",
            "REQUEST_TRACKING_ID": "REQ10001",
            "CALLBACK_URL": "https://bnet.barclays.com/"
         },
         "securityContext": "eyJVU0VSX0FHRU5UIjoiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgNi4xOyBXT1c2NDsgVHJpZGVudC83LjA7IEFTOyBydjoxMS4wKSBsaWtlIEdlY2tvIiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IlBVIn0="
      },
      "initiateRequestHeaderDetails":       {
         "FUNCTION_TYPE": "SIGN-TRANSACTIONS",
         "ACTION_TYPE": "SUBMIT",
         "DEVICE_TYPE_CODE": "SC",
         "OUTPUT_TYPE": "HTML"
      }
   },
   "requestDetailsMap": {}
}</con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/initiate</con:originalUri><con:assertion type="GroovyScriptAssertion" id="3f2a7f7f-4150-4f59-b57e-eddb93b59884" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "SUCCESS"
assert jsonMap.gssResponseHeader.responseContext.NEXTACTION == "VERIFY"</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Login_SecurityContext" id="be992c50-7fb9-450b-9529-30e183bd1f85"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>SGG-SC</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateLogin</con:sourceStep><con:sourcePath>gssResponseHeader.securityContext</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifyLogin</con:targetStep><con:targetPath>gssRequestHeader.securityContext</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Login_GSS-Nonce" id="1dff7083-f68e-436e-b5a1-e9acb4b86cc6"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-NONCE</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateLogin</con:sourceStep><con:sourcePath>gssResponseHeader.responseContext.GSS_NONCE</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifyLogin</con:targetStep><con:targetPath>gssRequestHeader.requestContext.GSS_NONCE</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Login_GSS-Ref-ID" id="c8800678-0655-4967-a743-8f2aff3d2694" disabled="true"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-REF-ID</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateLogin</con:sourceStep><con:sourcePath>initiateResponseDetailsMap.GSS_REFERENCE_ID</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifyLogin</con:targetStep><con:targetPath>verifyDetailMap.GSS_REFERENCE_ID</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="restrequest" name="VerifyLogin" id="11d2a8e5-e9cd-4cf6-9589-1810ecde7ec4"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/verify" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="VerifyLogin" id="ae8cc01d-5b14-46b5-8fa6-6207c40ac5af" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request><![CDATA[{
   "verifyDetailMap": {"GSS_REFERENCE_ID": "3A9612BD91D64C80AACA5701A3568128"},
   "gssRequestHeader":    {
      "serviceContext":       {
         "USER_AGENT": "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
         "APPLICATION": "B.NET"
      },
      "auditContext":       {
         "MODULE_ID": "B.Net Login Module",
         "IS_FINANCIAL_TRANSACTION": "false",
         "CLIENT_IP_ADDRESS": "35.53.180.6"
      },
      "requestContext":       {
         "REQUEST_TIMESTAMP": "2011-06-14T04:12:36BST",
         "REQUEST_TRACKING_ID": "REQ10001",
         "CALLBACK_URL": "https://bnet.barclays.com/",
         "GSS_NONCE": "9ec19592-4481-45f4-8ff3-cc3be0fa2b8f"
      },
      "securityContext": "eyJQVVJOX1RZUEUiOiJwa2kiLCJQVVJOIjoiOTk4MDAwMDAwMDg4MDQwMDAwNTAiLCJVU0VSX05BTUUiOiJKZXNpY2ExMCBhbGJhMTAiLCJDTElFTlRfTkFNRSI6IkJhcmNsYXlzIGNvcnAgTGltaXRlZCBURCIsIlVTRVJfQUdFTlQiOiJNb3ppbGxhLzUuMCAoV2luZG93cyBOVCA2LjE7IFdPVzY0OyBUcmlkZW50LzcuMDsgQVM7IHJ2OjExLjApIGxpa2UgR2Vja28iLCJBUFBMSUNBVElPTiI6IkIuTkVUIiwiREVWSUNFX1RZUEVfQ09ERSI6IlNDIiwiREVWSUNFX0FMSUFTIjoiU0MgQWxpYXMiLCJSRUdJT04iOiJHQiIsIlVTRVJfU1RBVFVTIjoiQUNUSVZFIiwiR1NTX1JFRkVSRU5DRV9JRCI6IjA2NUYwRTI5QkEyQzQwODA5QzlENEUyQkYzNjU0NjNEIn0="
   },
   "deviceParamMap":    {
      "HTTP_METHOD": "PUT",
      "HTTP_INPUT_CONTENTS": "Version_Spec=100&amp;Version_Plugin_Major=3&amp;Version_Plugin_Minor=0&amp;Version_Browser_Major=0&amp;Version_Browser_Minor=11&amp;Transaction_ID=7a4a1763-0ac0-4fb7-9d98-e6053e95d191401141426801730&amp;Signature_Data=MIIPZgYJKoZIhvcNAQcCoIIPVzCCD1MCAQExCzAJBgUrDgMCGgUAMIID2wYJKoZIhvcNAQcBoIIDzASCA8hDbGllbnQgTmFtZTogICAgICAgICAgICAgICAgICAgICAgICBURVNUSU5HIENPTVBBTlkgICAgICAgICAgICAgICAgICAgICAgIA0KRG9jdW1lbnQgSUQ6ICAgICAgICAgICAgICAgICAgICAgICAgRjAyNjNBMEUyNDJFNEM5NEI2MEREMjA0RjQ0QjZDQUINClNpZ24gYW5kIFN1Ym1pdCB0aGUgZm9sbG93aW5nIHRyYW5zYWN0aW9ucyAoMSkNCg0KUGF5bWVudCBUeXBlOiAgICAgICAgICAgICAgICAgICAgICAgRG9tZXN0aWMgUGF5bWVudA0KRGVsaXZlcnkgT3B0aW9uOiAgICAgICAgICAgICAgICAgICAgVUsgVGhyZWUgRGF5IFBheW1lbnQNCkRlYml0IEFjY291bnQgQmFuayBJZGVudGlmaWVyOiAgICAgIDA5MDA2Mw0KRGViaXQgQWNjb3VudCBOdW1iZXI6ICAgICAgICAgICAgICAgMDMwNDE0MDENCkRlYml0IEFjY291bnQgQ3VycmVuY3k6ICAgICAgICAgICAgIFBvdW5kIFN0ZXJsaW5nDQpQYXltZW50IEN1cnJlbmN5OiAgICAgICAgICAgICAgICAgICBQb3VuZCBTdGVybGluZw0KUGF5bWVudCBBbW91bnQ6ICAgICAgICAgICAgICAgICAgICAgMjYwMC4wMA0KVHJhbnNhY3Rpb24gUmVmZXJlbmNlIE51bWJlcjogICAgICAgQlgxNTA0MjAwNjkzMjYwNw0KVmFsdWUgRGF0ZTogICAgICAgICAgICAgICAgICAgICAgICAgQXByIDI0LCAyMDE1DQpDdXN0b21lciBSZWZlcmVuY2U6ICAgICAgICAgICAgICAgICAxMjMxMjMxMjMNCk51bWJlciBvZiBjcmVkaXQvZGViaXQgcmVjb3JkczoJICAgIDENCg0KQmVuZWZpY2lhcnkgTmFtZTogICAgICAgICAgICAgICAgICAgMTM0MjM0MjMNCkJlbmVmaWNpYXJ5IEFjY291bnQgQmFuayBJZGVudGlmaWVyOjE4NTAwOA0KQmVuZWZpY2lh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&amp;Signature_Format=PKCS7_basic&amp;IsDetailScrAction=false&amp;pd=F0263A0E242E4C94B60DD204F44B6CAB&amp;gssRefId=7a4a1763-0ac0-4fb7-9d98-e6053e95d191401141426801730&amp;gssStore=true"
   }
}]]></con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/verify</con:originalUri><con:assertion type="GroovyScriptAssertion" id="b2b9bd53-4cd9-4378-ad3e-a47f8bc3793c" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "ERROR"


assert jsonMap.gssResponseHeader.gssError.errorCode == "INVALID_REFERENCE_ID"


assert jsonMap.gssResponseHeader.gssError.errorMsg == "Reference id is invalid or null"
</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:properties/></con:testCase><con:testCase id="a4ab2928-b2a0-4ec9-bc5e-42716648c52b" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="TestCase 3.4-Signing-Invalid_Nonce" searchProperties="true"><con:settings/><con:testStep type="restrequest" name="GetDeviceList" id="52ea8f0e-bbd7-4021-82c1-88db25b9be95"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/devicelist" methodName="Devicelist" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="GetDeviceList" id="b063e9a0-5f4c-484f-b84a-038d96c080c1" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request>{
	"gssRequestHeader":{
		"serviceContext":{
			"USER_AGENT":"Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
			"APPLICATION":"B.NET"
		},
		"securityContext":null,
		"requestContext":{
			"REQUEST_TIMESTAMP":"2011-06-14T04:12:36BST",
			"REQUEST_TRACKING_ID":"REQ10001",
			"CALLBACK_URL":"https://bnet.barclays.com/"
		},
		"auditContext":{
			"MODULE_ID":"B.Net Login Module",
			"IS_FINANCIAL_TRANSACTION":"false",
			"CLIENT_IP_ADDRESS":"35.53.180.6"
		}
	},
	"deviceRequestMap":{
		"ONLY_ACTIVE":"true",
		"OUTPUT_TYPE":"BOTH"
	}
}</con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/devicelist</con:originalUri><con:assertion type="GroovyScriptAssertion" id="6c166ddf-cdfe-4189-9b56-bea28374973b" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "SUCCESS"
assert jsonMap.deviceInfo[0].DeviceDetailMap.STATUS == "Active"</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-GetDeviceList" id="6174a3aa-b60a-4b3b-85ba-a1df59f9bd3a"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-SC</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>GetDeviceList</con:sourceStep><con:sourcePath>gssResponseHeader.securityContext</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>InitiateLogin</con:targetStep><con:targetPath>initiateRequestHeader.gssRequestHeader.securityContext</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="restrequest" name="InitiateLogin" id="76a9ce25-4f88-4efd-b08d-255cf26d8c2a"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/initiate" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="InitiateLogin" id="45730af7-4d98-41bd-a00f-24929dff6304" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request>{
   "transactionItemList": [],
   "preFormattedData": "VGhpcyBpcyBhIHNhbXBsZSBvZiBwcmVmb3JtYXR0ZWQgZGF0YSwgY3JlYXRlZCBvbiAyNy8wMy8yMDE1Lg==",
   "initiateRequestHeader":    {
      "gssRequestHeader":       {
         "serviceContext":          {
            "PURN_TYPE": "pki",
            "PURN": "99800000008804000050",
            "USER_AGENT": "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
            "APPLICATION": "B.NET"
         },
         "auditContext":          {
            "MODULE_ID": "12345678901234567890123456789012345678901",
            "IS_FINANCIAL_TRANSACTION": "false",
            "SUB_MODULE_ID": "eyJVU0VSX0FHRU5UIjoiSUU4IiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IkdCIn0=",
            "SUBMODULE_ID": "eyJVU0VSX0FHRU5UIjoiSUU4IiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IkdCIn0=",
            "CLIENT_IP_ADDRESS": "35.53.180.6"
         },
         "requestContext":          {
            "REQUEST_TIMESTAMP": "2011-06-14T04:12:36BST",
            "REQUEST_TRACKING_ID": "REQ10001",
            "CALLBACK_URL": "https://bnet.barclays.com/"
         },
         "securityContext": "eyJVU0VSX0FHRU5UIjoiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgNi4xOyBXT1c2NDsgVHJpZGVudC83LjA7IEFTOyBydjoxMS4wKSBsaWtlIEdlY2tvIiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IlBVIn0="
      },
      "initiateRequestHeaderDetails":       {
         "FUNCTION_TYPE": "SIGN-TRANSACTIONS",
         "ACTION_TYPE": "SUBMIT",
         "DEVICE_TYPE_CODE": "SC",
         "OUTPUT_TYPE": "HTML"
      }
   },
   "requestDetailsMap": {}
}</con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/initiate</con:originalUri><con:assertion type="GroovyScriptAssertion" id="3f2a7f7f-4150-4f59-b57e-eddb93b59884" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "SUCCESS"
assert jsonMap.gssResponseHeader.responseContext.NEXTACTION == "VERIFY"</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Login_SecurityContext" id="edf17f66-f325-45ab-89fd-9c6a2c8aab72"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>SGG-SC</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateLogin</con:sourceStep><con:sourcePath>gssResponseHeader.securityContext</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifyLogin</con:targetStep><con:targetPath>gssRequestHeader.securityContext</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Login_GSS-Nonce" id="eba37757-57ba-4bb5-a1a7-b7b7ad19b729" disabled="true"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-NONCE</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateLogin</con:sourceStep><con:sourcePath>gssResponseHeader.responseContext.GSS_NONCE</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifyLogin</con:targetStep><con:targetPath>gssRequestHeader.requestContext.GSS_NONCE</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Login_GSS-Ref-ID" id="e4a423f2-ea04-414e-92f4-17b92f1b040a"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-REF-ID</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateLogin</con:sourceStep><con:sourcePath>initiateResponseDetailsMap.GSS_REFERENCE_ID</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifyLogin</con:targetStep><con:targetPath>verifyDetailMap.GSS_REFERENCE_ID</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="restrequest" name="VerifyLogin" id="30ac70b2-958f-4143-bd82-56a6ec78ba3a"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/verify" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="VerifyLogin" id="ae8cc01d-5b14-46b5-8fa6-6207c40ac5af" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request><![CDATA[{
   "verifyDetailMap": {"GSS_REFERENCE_ID": "01374A3175084CB9B8CF592A40B1FFA9"},
   "gssRequestHeader":    {
      "serviceContext":       {
         "USER_AGENT": "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
         "APPLICATION": "B.NET"
      },
      "auditContext":       {
         "MODULE_ID": "B.Net Login Module",
         "IS_FINANCIAL_TRANSACTION": "false",
         "CLIENT_IP_ADDRESS": "35.53.180.6"
      },
      "requestContext":       {
         "REQUEST_TIMESTAMP": "2011-06-14T04:12:36BST",
         "REQUEST_TRACKING_ID": "REQ10001",
         "CALLBACK_URL": "https://bnet.barclays.com/",
         "GSS_NONCE": "3d11623a-6c84-4060-979f-53df099e14d0"
      },
      "securityContext": "eyJQVVJOX1RZUEUiOiJwa2kiLCJQVVJOIjoiOTk4MDAwMDAwMDg4MDQwMDAwNTAiLCJVU0VSX05BTUUiOiJKZXNpY2ExMCBhbGJhMTAiLCJDTElFTlRfTkFNRSI6IkJhcmNsYXlzIGNvcnAgTGltaXRlZCBURCIsIlVTRVJfQUdFTlQiOiJNb3ppbGxhLzUuMCAoV2luZG93cyBOVCA2LjE7IFdPVzY0OyBUcmlkZW50LzcuMDsgQVM7IHJ2OjExLjApIGxpa2UgR2Vja28iLCJBUFBMSUNBVElPTiI6IkIuTkVUIiwiREVWSUNFX1RZUEVfQ09ERSI6IlNDIiwiREVWSUNFX0FMSUFTIjoiU0MgQWxpYXMiLCJSRUdJT04iOiJHQiIsIlVTRVJfU1RBVFVTIjoiQUNUSVZFIiwiR1NTX1JFRkVSRU5DRV9JRCI6IjAxMzc0QTMxNzUwODRDQjlCOENGNTkyQTQwQjFGRkE5In0="
   },
   "deviceParamMap":    {
      "HTTP_METHOD": "PUT",
      "HTTP_INPUT_CONTENTS": "Version_Spec=100&amp;Version_Plugin_Major=3&amp;Version_Plugin_Minor=0&amp;Version_Browser_Major=0&amp;Version_Browser_Minor=11&amp;Transaction_ID=7a4a1763-0ac0-4fb7-9d98-e6053e95d191401141426801730&amp;Signature_Data=MIIPZgYJKoZIhvcNAQcCoIIPVzCCD1MCAQExCzAJBgUrDgMCGgUAMIID2wYJKoZIhvcNAQcBoIIDzASCA8hDbGllbnQgTmFtZTogICAgICAgICAgICAgICAgICAgICAgICBURVNUSU5HIENPTVBBTlkgICAgICAgICAgICAgICAgICAgICAgIA0KRG9jdW1lbnQgSUQ6ICAgICAgICAgICAgICAgICAgICAgICAgRjAyNjNBMEUyNDJFNEM5NEI2MEREMjA0RjQ0QjZDQUINClNpZ24gYW5kIFN1Ym1pdCB0aGUgZm9sbG93aW5nIHRyYW5zYWN0aW9ucyAoMSkNCg0KUGF5bWVudCBUeXBlOiAgICAgICAgICAgICAgICAgICAgICAgRG9tZXN0aWMgUGF5bWVudA0KRGVsaXZlcnkgT3B0aW9uOiAgICAgICAgICAgICAgICAgICAgVUsgVGhyZWUgRGF5IFBheW1lbnQNCkRlYml0IEFjY291bnQgQmFuayBJZGVudGlmaWVyOiAgICAgIDA5MDA2Mw0KRGViaXQgQWNjb3VudCBOdW1iZXI6ICAgICAgICAgICAgICAgMDMwNDE0MDENCkRlYml0IEFjY291bnQgQ3VycmVuY3k6ICAgICAgICAgICAgIFBvdW5kIFN0ZXJsaW5nDQpQYXltZW50IEN1cnJlbmN5OiAgICAgICAgICAgICAgICAgICBQb3VuZCBTdGVybGluZw0KUGF5bWVudCBBbW91bnQ6ICAgICAgICAgICAgICAgICAgICAgMjYwMC4wMA0KVHJhbnNhY3Rpb24gUmVmZXJlbmNlIE51bWJlcjogICAgICAgQlgxNTA0MjAwNjkzMjYwNw0KVmFsdWUgRGF0ZTogICAgICAgICAgICAgICAgICAgICAgICAgQXByIDI0LCAyMDE1DQpDdXN0b21lciBSZWZlcmVuY2U6ICAgICAgICAgICAgICAgICAxMjMxMjMxMjMNCk51bWJlciBvZiBjcmVkaXQvZGViaXQgcmVjb3JkczoJICAgIDENCg0KQmVuZWZpY2lhcnkgTmFtZTogICAgICAgICAgICAgICAgICAgMTM0MjM0MjMNCkJlbmVmaWNpYXJ5IEFjY291bnQgQmFuayBJZGVudGlmaWVyOjE4NTAwOA0KQmVuZWZpY2lh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&amp;Signature_Format=PKCS7_basic&amp;IsDetailScrAction=false&amp;pd=F0263A0E242E4C94B60DD204F44B6CAB&amp;gssRefId=7a4a1763-0ac0-4fb7-9d98-e6053e95d191401141426801730&amp;gssStore=true"
   }
}]]></con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/verify</con:originalUri><con:assertion type="GroovyScriptAssertion" id="b2b9bd53-4cd9-4378-ad3e-a47f8bc3793c" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "ERROR"


assert jsonMap.gssResponseHeader.gssError.errorCode == "ILLEGAL_DATA_MODIFICATION"


assert jsonMap.gssResponseHeader.gssError.errorMsg == "User tried to modify Nonce"
</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:properties/></con:testCase><con:testCase id="4490152c-8255-4ddf-8abc-9754348fdca6" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="TestCase 3.5-Signing-Invalid_Security_Context" searchProperties="true"><con:settings/><con:testStep type="restrequest" name="GetDeviceList" id="bf17ac1e-5f1f-4305-9168-4b0e2c642fe5" disabled="true"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/devicelist" methodName="Devicelist" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="GetDeviceList" id="b063e9a0-5f4c-484f-b84a-038d96c080c1" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request>{
	"gssRequestHeader":{
		"serviceContext":{
			"USER_AGENT":"Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
			"APPLICATION":"B.NET"
		},
		"securityContext":null,
		"requestContext":{
			"REQUEST_TIMESTAMP":"2011-06-14T04:12:36BST",
			"REQUEST_TRACKING_ID":"REQ10001",
			"CALLBACK_URL":"https://bnet.barclays.com/"
		},
		"auditContext":{
			"MODULE_ID":"B.Net Login Module",
			"IS_FINANCIAL_TRANSACTION":"false",
			"CLIENT_IP_ADDRESS":"35.53.180.6"
		}
	},
	"deviceRequestMap":{
		"ONLY_ACTIVE":"true",
		"OUTPUT_TYPE":"BOTH"
	}
}</con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/devicelist</con:originalUri><con:assertion type="GroovyScriptAssertion" id="6c166ddf-cdfe-4189-9b56-bea28374973b" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "SUCCESS"
assert jsonMap.deviceInfo[0].DeviceDetailMap.STATUS == "Active"</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-GetDeviceList" id="f64fb1ed-19c9-4d95-bc78-395e0ab9b3d3" disabled="true"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-SC</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>GetDeviceList</con:sourceStep><con:sourcePath>gssResponseHeader.securityContext</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>InitiateLogin</con:targetStep><con:targetPath>initiateRequestHeader.gssRequestHeader.securityContext</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="restrequest" name="InitiateLogin" id="a26b6968-5661-4e3d-bc34-fb8cfec0bdbc"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/initiate" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="InitiateLogin" id="45730af7-4d98-41bd-a00f-24929dff6304" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request>{
   "transactionItemList": [],
   "preFormattedData": "VGhpcyBpcyBhIHNhbXBsZSBvZiBwcmVmb3JtYXR0ZWQgZGF0YSwgY3JlYXRlZCBvbiAyNy8wMy8yMDE1Lg==",
   "initiateRequestHeader":    {
      "gssRequestHeader":       {
         "serviceContext":          {
            "PURN_TYPE": "pki",
            "USER_AGENT": "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
            "PURN": "99800000008804000050",
            "APPLICATION": "B.NET"
         },
         "auditContext":          {
            "MODULE_ID": "12345678901234567890123456789012345678901",
            "IS_FINANCIAL_TRANSACTION": "false",
            "SUB_MODULE_ID": "eyJVU0VSX0FHRU5UIjoiSUU4IiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IkdCIn0=",
            "SUBMODULE_ID": "eyJVU0VSX0FHRU5UIjoiSUU4IiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IkdCIn0=",
            "CLIENT_IP_ADDRESS": "35.53.180.6"
         },
         "requestContext":          {
            "REQUEST_TIMESTAMP": "2011-06-14T04:12:36BST",
            "REQUEST_TRACKING_ID": "REQ10001",
            "CALLBACK_URL": "https://bnet.barclays.com/"
         },
         "securityContext": "eyJVU0VSX0FHRU5UIjoiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgNi4xOyBXT1c2NDsgVHJpZGVudC83LjA7IEFTOyBydjoxMS4wKSBsaWtlIEdlY2tvIiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IkdCIn0="
      },
      "initiateRequestHeaderDetails":       {
         "FUNCTION_TYPE": "SIGN-TRANSACTIONS",
         "ACTION_TYPE": "SUBMIT",
         "DEVICE_TYPE_CODE": "SC",
         "OUTPUT_TYPE": "HTML"
      }
   },
   "requestDetailsMap": {}
}</con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/initiate</con:originalUri><con:assertion type="GroovyScriptAssertion" id="3f2a7f7f-4150-4f59-b57e-eddb93b59884" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "SUCCESS"
assert jsonMap.gssResponseHeader.responseContext.NEXTACTION == "VERIFY"</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Login_SecurityContext" id="1187c5b0-4c2e-4057-847c-ca6c6dee3d77" disabled="true"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>SGG-SC</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateLogin</con:sourceStep><con:sourcePath>gssResponseHeader.securityContext</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifyLogin</con:targetStep><con:targetPath>gssRequestHeader.securityContext</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Login_GSS-Nonce" id="00e6adba-ac08-4afb-aa2c-32b0a7f345f5"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-NONCE</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateLogin</con:sourceStep><con:sourcePath>gssResponseHeader.responseContext.GSS_NONCE</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifyLogin</con:targetStep><con:targetPath>gssRequestHeader.requestContext.GSS_NONCE</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Login_GSS-Ref-ID" id="010fd9ab-fc42-4eae-a951-15c6ca5cdce3"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-REF-ID</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateLogin</con:sourceStep><con:sourcePath>initiateResponseDetailsMap.GSS_REFERENCE_ID</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifyLogin</con:targetStep><con:targetPath>verifyDetailMap.GSS_REFERENCE_ID</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="restrequest" name="VerifyLogin" id="f0e8553e-80cc-4dbb-ab8a-257caf3c5b9b"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/verify" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="VerifyLogin" id="ae8cc01d-5b14-46b5-8fa6-6207c40ac5af" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request><![CDATA[{
   "verifyDetailMap": {"GSS_REFERENCE_ID": "4F521F87C0F34BC58FA605A5D58C9040"},
   "gssRequestHeader":    {
      "serviceContext":       {
         "USER_AGENT": "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
         "APPLICATION": "B.NET"
      },
      "auditContext":       {
         "MODULE_ID": "B.Net Login Module",
         "IS_FINANCIAL_TRANSACTION": "false",
         "CLIENT_IP_ADDRESS": "35.53.180.6"
      },
      "requestContext":       {
         "REQUEST_TIMESTAMP": "2011-06-14T04:12:36BST",
         "REQUEST_TRACKING_ID": "REQ10001",
         "CALLBACK_URL": "https://bnet.barclays.com/",
         "GSS_NONCE": "3ccde1d0-e7b9-468f-88ee-da54b159c83e"
      },
      "securityContext": "eyJQVVJOX1RZUEUiOiJwa2kiLCJQVVJOIjoiOTk4MDAwMDAwMDg4MDQwMDAwNTAiLCJVU0VSX0FHRU5UIjoiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgNi4xOyBXT1c2NDsgVHJpZGVudC83LjA7IEFTOyBydjoxMS4wKSBsaWtlIEdlY2tvIiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIkRFVklDRV9UWVBFX0NPREUiOiJGViIsIlJFR0lPTiI6IkdCIiwiR1NTX1JFRkVSRU5DRV9JRCI6IjNBOTYxMkJEOTFENjRDODBBQUNBNTcwMUEzNTY4MTI4In0="
   },
   "deviceParamMap":    {
      "HTTP_METHOD": "PUT",
      "HTTP_INPUT_CONTENTS": "Version_Spec=100&amp;Version_Plugin_Major=3&amp;Version_Plugin_Minor=0&amp;Version_Browser_Major=0&amp;Version_Browser_Minor=11&amp;Transaction_ID=7a4a1763-0ac0-4fb7-9d98-e6053e95d191401141426801730&amp;Signature_Data=MIIPZgYJKoZIhvcNAQcCoIIPVzCCD1MCAQExCzAJBgUrDgMCGgUAMIID2wYJKoZIhvcNAQcBoIIDzASCA8hDbGllbnQgTmFtZTogICAgICAgICAgICAgICAgICAgICAgICBURVNUSU5HIENPTVBBTlkgICAgICAgICAgICAgICAgICAgICAgIA0KRG9jdW1lbnQgSUQ6ICAgICAgICAgICAgICAgICAgICAgICAgRjAyNjNBMEUyNDJFNEM5NEI2MEREMjA0RjQ0QjZDQUINClNpZ24gYW5kIFN1Ym1pdCB0aGUgZm9sbG93aW5nIHRyYW5zYWN0aW9ucyAoMSkNCg0KUGF5bWVudCBUeXBlOiAgICAgICAgICAgICAgICAgICAgICAgRG9tZXN0aWMgUGF5bWVudA0KRGVsaXZlcnkgT3B0aW9uOiAgICAgICAgICAgICAgICAgICAgVUsgVGhyZWUgRGF5IFBheW1lbnQNCkRlYml0IEFjY291bnQgQmFuayBJZGVudGlmaWVyOiAgICAgIDA5MDA2Mw0KRGViaXQgQWNjb3VudCBOdW1iZXI6ICAgICAgICAgICAgICAgMDMwNDE0MDENCkRlYml0IEFjY291bnQgQ3VycmVuY3k6ICAgICAgICAgICAgIFBvdW5kIFN0ZXJsaW5nDQpQYXltZW50IEN1cnJlbmN5OiAgICAgICAgICAgICAgICAgICBQb3VuZCBTdGVybGluZw0KUGF5bWVudCBBbW91bnQ6ICAgICAgICAgICAgICAgICAgICAgMjYwMC4wMA0KVHJhbnNhY3Rpb24gUmVmZXJlbmNlIE51bWJlcjogICAgICAgQlgxNTA0MjAwNjkzMjYwNw0KVmFsdWUgRGF0ZTogICAgICAgICAgICAgICAgICAgICAgICAgQXByIDI0LCAyMDE1DQpDdXN0b21lciBSZWZlcmVuY2U6ICAgICAgICAgICAgICAgICAxMjMxMjMxMjMNCk51bWJlciBvZiBjcmVkaXQvZGViaXQgcmVjb3JkczoJICAgIDENCg0KQmVuZWZpY2lhcnkgTmFtZTogICAgICAgICAgICAgICAgICAgMTM0MjM0MjMNCkJlbmVmaWNpYXJ5IEFjY291bnQgQmFuayBJZGVudGlmaWVyOjE4NTAwOA0KQmVuZWZpY2lh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&amp;Signature_Format=PKCS7_basic&amp;IsDetailScrAction=false&amp;pd=F0263A0E242E4C94B60DD204F44B6CAB&amp;gssRefId=7a4a1763-0ac0-4fb7-9d98-e6053e95d191401141426801730&amp;gssStore=true"
   }
}]]></con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/verify</con:originalUri><con:assertion type="GroovyScriptAssertion" id="b2b9bd53-4cd9-4378-ad3e-a47f8bc3793c" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "ERROR"


assert jsonMap.gssResponseHeader.gssError.errorCode == "ILLEGAL_DATA_MODIFICATION"


assert jsonMap.gssResponseHeader.gssError.errorMsg == "User tried to modify SecurityContext"
</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:properties/></con:testCase><con:testCase id="2914bc27-ce93-4563-9317-9925855d7f41" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="TestCase 3.6-Signing-DATA_NOT_RETRIEVED" searchProperties="true"><con:settings/><con:testStep type="restrequest" name="GetDeviceList" id="a80eb514-d1b8-44e8-a4c4-01c66dd53d8c" disabled="true"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/devicelist" methodName="Devicelist" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="GetDeviceList" id="b063e9a0-5f4c-484f-b84a-038d96c080c1" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request>{
	"gssRequestHeader":{
		"serviceContext":{
			"USER_AGENT":"Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
			"APPLICATION":"B.NET"
		},
		"securityContext":null,
		"requestContext":{
			"REQUEST_TIMESTAMP":"2011-06-14T04:12:36BST",
			"REQUEST_TRACKING_ID":"REQ10001",
			"CALLBACK_URL":"https://bnet.barclays.com/"
		},
		"auditContext":{
			"MODULE_ID":"B.Net Login Module",
			"IS_FINANCIAL_TRANSACTION":"false",
			"CLIENT_IP_ADDRESS":"35.53.180.6"
		}
	},
	"deviceRequestMap":{
		"ONLY_ACTIVE":"true",
		"OUTPUT_TYPE":"BOTH"
	}
}</con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/devicelist</con:originalUri><con:assertion type="GroovyScriptAssertion" id="6c166ddf-cdfe-4189-9b56-bea28374973b" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "SUCCESS"
assert jsonMap.deviceInfo[0].DeviceDetailMap.STATUS == "Active"</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-GetDeviceList" id="3883cd1e-499b-4091-bc41-b112bffd8652" disabled="true"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-SC</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>GetDeviceList</con:sourceStep><con:sourcePath>gssResponseHeader.securityContext</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>InitiateLogin</con:targetStep><con:targetPath>initiateRequestHeader.gssRequestHeader.securityContext</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="restrequest" name="InitiateLogin" id="60df5f9e-653a-4267-8cc2-2a0e54657389"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/initiate" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="InitiateLogin" id="45730af7-4d98-41bd-a00f-24929dff6304" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request>{
   "transactionItemList": [],
   "preFormattedData": "VGhpcyBpcyBhIHNhbXBsZSBvZiBwcmVmb3JtYXR0ZWQgZGF0YSwgY3JlYXRlZCBvbiAyNy8wMy8yMDE1Lg==",
   "initiateRequestHeader":    {
      "gssRequestHeader":       {
         "serviceContext":          {
            "PURN_TYPE": "pki",
            "USER_AGENT": "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
            "PURN": "99800000008804000050",
            "APPLICATION": "B.NET"
         },
         "auditContext":          {
            "MODULE_ID": "12345678901234567890123456789012345678901",
            "IS_FINANCIAL_TRANSACTION": "false",
            "SUB_MODULE_ID": "eyJVU0VSX0FHRU5UIjoiSUU4IiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IkdCIn0=",
            "SUBMODULE_ID": "eyJVU0VSX0FHRU5UIjoiSUU4IiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IkdCIn0=",
            "CLIENT_IP_ADDRESS": "35.53.180.6"
         },
         "requestContext":          {
            "REQUEST_TIMESTAMP": "2011-06-14T04:12:36BST",
            "REQUEST_TRACKING_ID": "REQ10001",
            "CALLBACK_URL": "https://bnet.barclays.com/"
         },
         "securityContext": "eyJVU0VSX0FHRU5UIjoiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgNi4xOyBXT1c2NDsgVHJpZGVudC83LjA7IEFTOyBydjoxMS4wKSBsaWtlIEdlY2tvIiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IkdCIn0="
      },
      "initiateRequestHeaderDetails":       {
         "FUNCTION_TYPE": "SIGN-TRANSACTIONS",
         "ACTION_TYPE": "SUBMIT",
         "DEVICE_TYPE_CODE": "SC",
         "OUTPUT_TYPE": "HTML"
      }
   },
   "requestDetailsMap": {}
}</con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/initiate</con:originalUri><con:assertion type="GroovyScriptAssertion" id="3f2a7f7f-4150-4f59-b57e-eddb93b59884" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "SUCCESS"
assert jsonMap.gssResponseHeader.responseContext.NEXTACTION == "VERIFY"</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Login_SecurityContext" id="a175cb20-7629-4ed7-b858-557c83d3b714"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>SGG-SC</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateLogin</con:sourceStep><con:sourcePath>gssResponseHeader.securityContext</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifyLogin</con:targetStep><con:targetPath>gssRequestHeader.securityContext</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Login_GSS-Nonce" id="18ec9ac6-f2ff-4295-9f15-cbb42a693905"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-NONCE</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateLogin</con:sourceStep><con:sourcePath>gssResponseHeader.responseContext.GSS_NONCE</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifyLogin</con:targetStep><con:targetPath>gssRequestHeader.requestContext.GSS_NONCE</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Login_GSS-Ref-ID" id="ef0fbb7e-e11d-4a0c-a9d5-7030b058a275"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-REF-ID</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateLogin</con:sourceStep><con:sourcePath>initiateResponseDetailsMap.GSS_REFERENCE_ID</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifyLogin</con:targetStep><con:targetPath>verifyDetailMap.GSS_REFERENCE_ID</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="restrequest" name="VerifyLogin" id="4077a0f3-758b-4710-b58f-c0cd85708a45"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/verify" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="VerifyLogin" id="ae8cc01d-5b14-46b5-8fa6-6207c40ac5af" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request><![CDATA[{
   "verifyDetailMap": {"GSS_REFERENCE_ID": "0ED6FE0228E34B4FA28839BD128156E5"},
   "gssRequestHeader":    {
      "serviceContext":       {
         "USER_AGENT": "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
         "APPLICATION": "B.NET"
      },
      "auditContext":       {
         "MODULE_ID": "B.Net Login Module",
         "IS_FINANCIAL_TRANSACTION": "false",
         "CLIENT_IP_ADDRESS": "35.53.180.6"
      },
      "requestContext":       {
         "REQUEST_TIMESTAMP": "2011-06-14T04:12:36BST",
         "REQUEST_TRACKING_ID": "REQ10001",
         "CALLBACK_URL": "https://bnet.barclays.com/",
         "GSS_NONCE": "f25aab94-9309-4c71-b3b6-b0df247f50c0"
      },
      "securityContext": "eyJQVVJOX1RZUEUiOiJwa2kiLCJQVVJOIjoiOTk4MDAwMDAwMDg4MDQwMDAwNTAiLCJVU0VSX05BTUUiOiJKZXNpY2ExMCBhbGJhMTAiLCJDTElFTlRfTkFNRSI6IkJhcmNsYXlzIGNvcnAgTGltaXRlZCBURCIsIlVTRVJfQUdFTlQiOiJNb3ppbGxhLzUuMCAoV2luZG93cyBOVCA2LjE7IFdPVzY0OyBUcmlkZW50LzcuMDsgQVM7IHJ2OjExLjApIGxpa2UgR2Vja28iLCJBUFBMSUNBVElPTiI6IkIuTkVUIiwiREVWSUNFX1RZUEVfQ09ERSI6IlNDIiwiREVWSUNFX0FMSUFTIjoiU0MgQWxpYXMiLCJSRUdJT04iOiJHQiIsIlVTRVJfU1RBVFVTIjoiQUNUSVZFIiwiR1NTX1JFRkVSRU5DRV9JRCI6IjBFRDZGRTAyMjhFMzRCNEZBMjg4MzlCRDEyODE1NkU1In0="
   },
   "deviceParamMap":    {
      "HTTP_METHOD": "PUT",
      "HTTP_INPUT_CONTENTS": "Version_Spec=100&amp;Version_Plugin_Major=3&amp;Version_Plugin_Minor=0&amp;Version_Browser_Major=0&amp;Version_Browser_Minor=11&amp;Transaction_ID=7a4a1763-0ac0-4fb7-9d98-e6053e95d191401141426801730&amp;Signature_DataICAgICAgICAgICAgICAgICAgICAgICBURVNUSU5HIENPTVBBTlkgICAgICAgICAgICAgICAgICAgICAgIA0KRG9jdW1lbnQgSUQ6ICAgICAgICAgICAgICAgICAgICAgICAgRjAyNjNBMEUyNDJFNEM5NEI2MEREMjA0RjQ0QjZDQUINClNpZ24gYW5kIFN1Ym1pdCB0aGUgZm9sbG93aW5nIHRyYW5zYWN0aW9ucyAoMSkNCg0KUGF5bWVudCBUeXBlOiAgICAgICAgICAgICAgICAgICAgICAgRG9tZXN0aWMgUGF5bWVudA0KRGVsaXZlcnkgT3B0aW9uOiAgICAgICAgICAgICAgICAgICAgVUsgVGhyZWUgRGF5IFBheW1lbnQNCkRlYml0IEFjY291bnQgQmFuayBJZGVudGlmaWVyOiAgICAgIDA5MDA2Mw0KRGViaXQgQWNjb3VudCBOdW1iZXI6ICAgICAgICAgICAgICAgMDMwNDE0MDENCkRlYml0IEFjY291bnQgQ3VycmVuY3k6ICAgICAgICAgICAgIFBvdW5kIFN0ZXJsaW5nDQpQYXltZW50IEN1cnJlbmN5OiAgICAgICAgICAgICAgICAgICBQb3VuZCBTdGVybGluZw0KUGF5bWVudCBBbW91bnQ6ICAgICAgICAgICAgICAgICAgICAgMjYwMC4wMA0KVHJhbnNhY3Rpb24gUmVmZXJlbmNlIE51bWJlcjogICAgICAgQlgxNTA0MjAwNjkzMjYwNw0KVmFsdWUgRGF0ZTogICAgICAgICAgICAgICAgICAgICAgICAgQXByIDI0LCAyMDE1DQpDdXN0b21lciBSZWZlcmVuY2U6ICAgICAgICAgICAgICAgICAxMjMxMjMxMjMNCk51bWJlciBvZiBjcmVkaXQvZGViaXQgcmVjb3JkczoJICAgIDENCg0KQmVuZWZpY2lhcnkgTmFtZTogICAgICAgICAgICAgICAgICAgMTM0MjM0MjMNCkJlbmVmaWNpYXJ5IEFjY291bnQgQmFuayBJZGVudGlmaWVyOjE4NTAwOA0KQmVuZWZpY2lhcnkgQWNjb3VudCBOdW1iZXI6ICAgICAgICAgNDE4NTAwODMNCkJlbmVmaWNpYXJ5IEFtb3VudDogICAgICAgICAgICAgICAgIDI2MDANCjdhNGExNzYzLTBhYzAtNGZiNy05ZDk4LWU2MDUzZTk1ZDE5MTQwMTE0MTQyNjgwMTczMKCCCUMwggU0MIIEHKADAgECAhA6YmZ//4I32+H5ZOey1hKUMA0GCSqGSIb3DQEBBQUAMH4xGjAYBgNVBAoTEUJhcmNsYXlzIEJhbmsgUExDMS8wLQYDVQQLEyZUZXN0IEJ1c2luZXNzIEN1c3RvbWVyIElkZW50aXR5IENBICg4KTEvMC0GA1UEAxMmVGVzdCBCdXNpbmVzcyBDdXN0b21lciBJZGVudGl0eSBDQSAoOCkwHhcNMTQxMjAxMDAwMDAwWhcNMTUxMjAxMjM1OTU5WjCBlDEaMBgGA1UEChQRQmFyY2xheXMgQmFuayBQTEMxJDAiBgNVBAsUG1BVUk4gLSA5OTgwMDAwMDAwMzM3NjAwMDE0NzERMA8GA1UECxQIQ05VTSAtIDMxJDAiBgNVBAsUG0NPUkcgLSBCQklCIFRlc3QgQ3VzdG9tZXIgODEXMBUGA1UEAxMOU2ltb24gTG9uZy1DMTQwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQCkH/yo2X1ZjDeWBOEIM1gyKn/bFk0VOc1KFxGMsef+YH5Ei0lHhh1+hd9KP7XyP7BaS+mg0zVLQypo2QkbWAW5zKOWGQxtPnudpbUv8W/qccQxkh5FxTf5C/If4jlrOGRbHdhMQUpExmY6yyaZPRUfP96CRqop/oMkySVbmyz/UCfKxtUMGilZ2UEybMFyQ1R+iBHh2Vjd9B1UK4OGpW3Xe3lJiFTs3pcSEzyXNDtanj6/AY70zOGQP3Y2wteC+/qHWsjkYOIZTgS+Ix7IFYF5UYkb1ZpA9SRqG/uitOe8PMIMrPdtnrRrAo8PtXwdeMt1gl807c1Fk+rh0VdG5kihAgMBAAGjggGVMIIBkTAfBgNVHSMEGDAWgBQ/p0Fsz+NCm5biPKgjjsD/Crss0jALBgNVHQ8EBAMCBsAwgfQGA1UdIASB7DCB6TCB5gYNKoY6AAG+0HcCAQMBAjCB1DCB0QYIKwYBBQUHAgIwgcQagcFUaGlzIGNlcnRpZmljYXRlIGlzIGlzc3VlZCBieSBCYXJjbGF5cyBCYW5rIFBMQywgd2hpY2ggaGFzIG5vIGxpYWJpbGl0eSB1bmRlciBpdCBvdGhlciB0aGFuIHRvIHBlcnNvbnMgd2hvIGhhdmUgZW50ZXJlZCBpbnRvLCBhbmQgdGhlbiBvbmx5IHRvIHRoZSBleHRlbnQgc2V0IG91dCBpbiwgYW4gYWdyZWVtZW50IHdpdGggQmFyY2xheXMuMCAGA1UdEQQZMBeBFW5vbWFpbEBiYXJjbGF5cy5jby51azBIBggrBgEFBQcBAQQ8MDowOAYIKwYBBQUHMAGGLGh0dHA6Ly9iYXJjbGF5cy1jdXN0b21lci1vY3NwMS50cnVzdHdpc2UuY29tMA0GCSqGSIb3DQEBBQUAA4IBAQAFphM8+WKenB9GoqloNaO6RpndZTBc6IQI+gwtxzQy4GODSf21XT80NeJ+ILJOX06s6l1yD19Oun9Oq+JQH4i8bpwCGCkKHhDjkNPKqUwazJUqNMGdEquhDS7wBPFaKiRhi9Yt4e/XH+1RgknaIr4ycOwfl6cRJIvtvj8GT3We7KL8Se79xBI/9iTh9ZydRM4ogsGA35F/m908ZRihsWNwtW5rFrtH73u7bw5DEEgXU/rUfBi/el7sb4S04d9KpPAsXywItYVPcMS2DRo68sIrmMcPChR2+2VCN/AcrMH0MO1tBcS8WFwNJW/balbGzwkQkZutxDgli/3a1zmyBYyEMIIEBzCCAu+gAwIBAgIQDto9k4DjI9KU5ecJ4WKArjANBgkqhkiG9w0BAQUFADBSMRowGAYDVQQKExFCYXJjbGF5cyBCYW5rIFBMQzEZMBcGA1UECxMQVGVzdCBSb290IENBICg0KTEZMBcGA1UEAxMQVGVzdCBSb290IENBICg0KTAeFw0xMTA1MTIwMDAwMDBaFw0yMDA1MTEyMzU5NTlaMH4xGjAYBgNVBAoTEUJhcmNsYXlzIEJhbmsgUExDMS8wLQYDVQQLEyZUZXN0IEJ1c2luZXNzIEN1c3RvbWVyIElkZW50aXR5IENBICg4KTEvMC0GA1UEAxMmVGVzdCBCdXNpbmVzcyBDdXN0b21lciBJZGVudGl0eSBDQSAoOCkwggEgMA0GCSqGSIb3DQEBAQUAA4IBDQAwggEIAoIBAQC4n4QmJvQ33SlBY8ntgfkU4VxuhcfVbwhWCSzUkcm55qm4E9/wE3LgZePJrsOFUprQ4AC7Rhj+OIBEQQQO8sLeszTjONmBVrmVhxzA7gV9398DFgLK5nes7CelgMCnmXWXeO/U0lmdLlOfaDUBL6iWU8MVo1TkrpNT+I2/l3MlD3WsJHnefDMl37eiFNDqXUXy8Iv9GePDxx7iBs8Z6atBj6GAsqkwRLtp8AlBHbrWsWjFQf1dJtPkNAbJ09VcpFxmo0yV2MfDTcFz5z/dxwVjvlGIchIZKXwDY3I7S3JiGII+wfA9dWiwhRDDbop7BlfDyHcDE+bPsn3rQHLST3DVAgEDo4GuMIGrMBIGA1UdEwEB/wQIMAYBAf8CAQAwDgYDVR0PAQH/BAQDAgEGMBoGA1UdIAQTMBEwDwYNKoY6AAG+0HcCAQMBATApBgNVHREEIjAgpB4wHDEaMBgGA1UEAxMRQmFyYzIwNDhQcml2MS0yMTEwHQYDVR0OBBYEFD+nQWzP40KbluI8qCOOwP8KuyzSMB8GA1UdIwQYMBaAFN3sdhm9PUbW6oKN+HUKbyF+XpViMA0GCSqGSIb3DQEBBQUAA4IBAQBNXt7nrGVd0X1HtwBZchnQc3FSF1kcYEJTpgxHCWYM/GLh/PUQzaQLRexFAkrWMZHBP7ex6csqDI2wxDE2jgeqqwYlIPDHgEkx70mcxBVyqgYnuznFwr4PFhHmE1HQe99iFm8fusgfcLq74ApldIRY0RHVhIgRDjP6jVoCqSyWwI/zeefNRaZrtmmFZbuKMaWJEdFFYFAILRmXpcgRZGBJNrl/0S35D4pwuSPuZRV+goR396GGu1XrHefS2Eg+n178zU9yNgAQyfx3m6Yoy/ldZ8gR5iLBnPaE/ZkkytHdIQ6iDKhQCrjT6UFedXGSllfwbGyXNCLOEC0vM0JEi2I/MYICGTCCAhUCAQEwgZIwfjEaMBgGA1UEChMRQmFyY2xheXMgQmFuayBQTEMxLzAtBgNVBAsTJlRlc3QgQnVzaW5lc3MgQ3VzdG9tZXIgSWRlbnRpdHkgQ0EgKDgpMS8wLQYDVQQDEyZUZXN0IEJ1c2luZXNzIEN1c3RvbWVyIElkZW50aXR5IENBICg4KQIQOmJmf/+CN9vh+WTnstYSlDAJBgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0BCQUxDxcNMTUwNDIyMTg1ODUzWjAjBgkqhkiG9w0BCQQxFgQUZH6wNd0r0TuJCaBLbmm2XtlDKtswDQYJKoZIhvcNAQEBBQAEggEAhwtKJqTfubCgpnHphq8t43hRYj0eBhytA9NFmGKtUExv8lUFLC+flWEtQrQmIM4wozF0alDbzJhmT9NWpfkxmTNX3ASmqtuGt8o/ZEmjr/JIzauJFBkk4hTxLwW6HHBqo4fAAVHeyS2aVfXOoCbtPGn9VXbWivgvUDFYpWlsHG5J/rgdUsl0tjG54LfGgFIMuRG+ZUsaU2ncnLLMh0Elm+6Gg4mAxBlLss+r/cNaOgZlqgNfsIKd7yXS8c3xC5c2g3qEsPWHXrxmNsVyV8w2/EiOHqQKMkvpzOmzs+SrEKKZg+VasWs/CMNVH2L+Roo+3CCdZCfcNoOr5iK2EwpSsQ==&amp;Signature_Format=PKCS7_basic&amp;IsDetailScrAction=false&amp;pd=F0263A0E242E4C94B60DD204F44B6CAB&amp;gssRefId=7a4a1763-0ac0-4fb7-9d98-e6053e95d191401141426801730&amp;gssStore=true"
   }
}]]></con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/verify</con:originalUri><con:assertion type="GroovyScriptAssertion" id="b2b9bd53-4cd9-4378-ad3e-a47f8bc3793c" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "ERROR"


assert jsonMap.gssResponseHeader.gssError.errorCode == "DATA_NOT_RETRIEVED"


assert jsonMap.gssResponseHeader.gssError.errorMsg == "NO Signature DATA Present"
</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:properties/></con:testCase><con:testCase id="c2140f93-0412-49c0-9983-effc57df85d5" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="TestCase 3.7-Signing-No_DATA_Found" searchProperties="true"><con:settings/><con:testStep type="restrequest" name="GetDeviceList" id="484cdfbe-8f5c-4ab0-a7c7-4db9f55e6202"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/devicelist" methodName="Devicelist" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="GetDeviceList" id="b063e9a0-5f4c-484f-b84a-038d96c080c1" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request>{
	"gssRequestHeader":{
		"serviceContext":{
			"USER_AGENT":"Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
			"APPLICATION":"B.NET"
		},
		"securityContext":null,
		"requestContext":{
			"REQUEST_TIMESTAMP":"2011-06-14T04:12:36BST",
			"REQUEST_TRACKING_ID":"REQ10001",
			"CALLBACK_URL":"https://bnet.barclays.com/"
		},
		"auditContext":{
			"MODULE_ID":"B.Net Login Module",
			"IS_FINANCIAL_TRANSACTION":"false",
			"CLIENT_IP_ADDRESS":"35.53.180.6"
		}
	},
	"deviceRequestMap":{
		"ONLY_ACTIVE":"true",
		"OUTPUT_TYPE":"BOTH"
	}
}</con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/devicelist</con:originalUri><con:assertion type="GroovyScriptAssertion" id="6c166ddf-cdfe-4189-9b56-bea28374973b" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "SUCCESS"
assert jsonMap.deviceInfo[0].DeviceDetailMap.STATUS == "Active"</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-GetDeviceList" id="0431312a-a8fc-4f43-a6ef-d27766da8266"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-SC</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>GetDeviceList</con:sourceStep><con:sourcePath>gssResponseHeader.securityContext</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>InitiateLogin</con:targetStep><con:targetPath>initiateRequestHeader.gssRequestHeader.securityContext</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="restrequest" name="InitiateLogin" id="750f4308-8a25-494b-852d-65931db10210"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/initiate" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="InitiateLogin" id="45730af7-4d98-41bd-a00f-24929dff6304" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request>{
   "transactionItemList": [],
   "preFormattedData": "VGhpcyBpcyBhIHNhbXBsZSBvZiBwcmVmb3JtYXR0ZWQgZGF0YSwgY3JlYXRlZCBvbiAyNy8wMy8yMDE1Lg==",
   "initiateRequestHeader":    {
      "gssRequestHeader":       {
         "serviceContext":          {
            "PURN_TYPE": "pki",
            "PURN": "99800000008804000050",
            "USER_AGENT": "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
            "APPLICATION": "B.NET"
         },
         "auditContext":          {
            "MODULE_ID": "12345678901234567890123456789012345678901",
            "IS_FINANCIAL_TRANSACTION": "false",
            "SUB_MODULE_ID": "eyJVU0VSX0FHRU5UIjoiSUU4IiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IkdCIn0=",
            "SUBMODULE_ID": "eyJVU0VSX0FHRU5UIjoiSUU4IiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IkdCIn0=",
            "CLIENT_IP_ADDRESS": "35.53.180.6"
         },
         "requestContext":          {
            "REQUEST_TIMESTAMP": "2011-06-14T04:12:36BST",
            "REQUEST_TRACKING_ID": "REQ10001",
            "CALLBACK_URL": "https://bnet.barclays.com/"
         },
         "securityContext": "eyJVU0VSX0FHRU5UIjoiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgNi4xOyBXT1c2NDsgVHJpZGVudC83LjA7IEFTOyBydjoxMS4wKSBsaWtlIEdlY2tvIiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IlBVIn0="
      },
      "initiateRequestHeaderDetails":       {
         "FUNCTION_TYPE": "SIGN-TRANSACTIONS",
         "ACTION_TYPE": "SUBMIT",
         "DEVICE_TYPE_CODE": "SC",
         "OUTPUT_TYPE": "HTML"
      }
   },
   "requestDetailsMap": {}
}</con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/initiate</con:originalUri><con:assertion type="GroovyScriptAssertion" id="3f2a7f7f-4150-4f59-b57e-eddb93b59884" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "SUCCESS"
assert jsonMap.gssResponseHeader.responseContext.NEXTACTION == "VERIFY"</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Login_SecurityContext" id="fca09009-1534-4eeb-bced-a2d0b1ccee26"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>SGG-SC</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateLogin</con:sourceStep><con:sourcePath>gssResponseHeader.securityContext</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifyLogin</con:targetStep><con:targetPath>gssRequestHeader.securityContext</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Login_GSS-Nonce" id="f82a74b8-39a5-4c44-b041-67c66a047816"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-NONCE</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateLogin</con:sourceStep><con:sourcePath>gssResponseHeader.responseContext.GSS_NONCE</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifyLogin</con:targetStep><con:targetPath>gssRequestHeader.requestContext.GSS_NONCE</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Login_GSS-Ref-ID" id="181a8b83-f3ae-4d0a-abba-9a08574cb44d"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-REF-ID</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateLogin</con:sourceStep><con:sourcePath>initiateResponseDetailsMap.GSS_REFERENCE_ID</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifyLogin</con:targetStep><con:targetPath>verifyDetailMap.GSS_REFERENCE_ID</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="restrequest" name="VerifyLogin" id="bfac6985-c7e7-4472-8432-11fc08afdd14"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/verify" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="VerifyLogin" id="ae8cc01d-5b14-46b5-8fa6-6207c40ac5af" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request><![CDATA[{
   "verifyDetailMap": {"GSS_REFERENCE_ID": "97BBE810F3104A0EBFA50173BDB9C21E"},
   "gssRequestHeader":    {
      "serviceContext":       {
         "USER_AGENT": "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
         "APPLICATION": "MEHTA"
      },
      "auditContext":       {
         "MODULE_ID": "B.Net Login Module",
         "IS_FINANCIAL_TRANSACTION": "false",
         "CLIENT_IP_ADDRESS": "35.53.180.6"
      },
      "requestContext":       {
         "REQUEST_TIMESTAMP": "2011-06-14T04:12:36BST",
         "REQUEST_TRACKING_ID": "REQ10001",
         "CALLBACK_URL": "https://bnet.barclays.com/",
         "GSS_NONCE": "ebf54189-90c8-4b12-a5d7-3db495957f0a"
      },
      "securityContext": "eyJQVVJOX1RZUEUiOiJwa2kiLCJQVVJOIjoiOTk4MDAwMDAwMDg4MDQwMDAwNTAiLCJVU0VSX05BTUUiOiJKZXNpY2ExMCBhbGJhMTAiLCJDTElFTlRfTkFNRSI6IkJhcmNsYXlzIGNvcnAgTGltaXRlZCBURCIsIlVTRVJfQUdFTlQiOiJNb3ppbGxhLzUuMCAoV2luZG93cyBOVCA2LjE7IFdPVzY0OyBUcmlkZW50LzcuMDsgQVM7IHJ2OjExLjApIGxpa2UgR2Vja28iLCJBUFBMSUNBVElPTiI6IkIuTkVUIiwiREVWSUNFX1RZUEVfQ09ERSI6IlNDIiwiREVWSUNFX0FMSUFTIjoiU0MgQWxpYXMiLCJSRUdJT04iOiJHQiIsIlVTRVJfU1RBVFVTIjoiQUNUSVZFIiwiR1NTX1JFRkVSRU5DRV9JRCI6Ijk3QkJFODEwRjMxMDRBMEVCRkE1MDE3M0JEQjlDMjFFIn0="
   },
   "deviceParamMap":    {
      "HTTP_METHOD": "PUT",
      "HTTP_INPUT_CONTENTS": "Version_Spec=100&amp;Version_Plugin_Major=3&amp;Version_Plugin_Minor=0&amp;Version_Browser_Major=0&amp;Version_Browser_Minor=11&amp;Transaction_ID=7a4a1763-0ac0-4fb7-9d98-e6053e95d191401141426801730&amp;Signature_Data=MIIPZgYJKoZIhvcNAQcCoIIPVzCCD1MCAQExCzAJBgUrDgMCGgUAMIID2wYJKoZIhvcNAQcBoIIDzASCA8hDbGllbnQgTmFtZTogICAgICAgICAgICAgICAgICAgICAgICBURVNUSU5HIENPTVBBTlkgICAgICAgICAgICAgICAgICAgICAgIA0KRG9jdW1lbnQgSUQ6ICAgICAgICAgICAgICAgICAgICAgICAgRjAyNjNBMEUyNDJFNEM5NEI2MEREMjA0RjQ0QjZDQUINClNpZ24gYW5kIFN1Ym1pdCB0aGUgZm9sbG93aW5nIHRyYW5zYWN0aW9ucyAoMSkNCg0KUGF5bWVudCBUeXBlOiAgICAgICAgICAgICAgICAgICAgICAgRG9tZXN0aWMgUGF5bWVudA0KRGVsaXZlcnkgT3B0aW9uOiAgICAgICAgICAgICAgICAgICAgVUsgVGhyZWUgRGF5IFBheW1lbnQNCkRlYml0IEFjY291bnQgQmFuayBJZGVudGlmaWVyOiAgICAgIDA5MDA2Mw0KRGViaXQgQWNjb3VudCBOdW1iZXI6ICAgICAgICAgICAgICAgMDMwNDE0MDENCkRlYml0IEFjY291bnQgQ3VycmVuY3k6ICAgICAgICAgICAgIFBvdW5kIFN0ZXJsaW5nDQpQYXltZW50IEN1cnJlbmN5OiAgICAgICAgICAgICAgICAgICBQb3VuZCBTdGVybGluZw0KUGF5bWVudCBBbW91bnQ6ICAgICAgICAgICAgICAgICAgICAgMjYwMC4wMA0KVHJhbnNhY3Rpb24gUmVmZXJlbmNlIE51bWJlcjogICAgICAgQlgxNTA0MjAwNjkzMjYwNw0KVmFsdWUgRGF0ZTogICAgICAgICAgICAgICAgICAgICAgICAgQXByIDI0LCAyMDE1DQpDdXN0b21lciBSZWZlcmVuY2U6ICAgICAgICAgICAgICAgICAxMjMxMjMxMjMNCk51bWJlciBvZiBjcmVkaXQvZGViaXQgcmVjb3JkczoJICAgIDENCg0KQmVuZWZpY2lhcnkgTmFtZTogICAgICAgICAgICAgICAgICAgMTM0MjM0MjMNCkJlbmVmaWNpYXJ5IEFjY291bnQgQmFuayBJZGVudGlmaWVyOjE4NTAwOA0KQmVuZWZpY2lh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&amp;Signature_Format=PKCS7_basic&amp;IsDetailScrAction=false&amp;pd=F0263A0E242E4C94B60DD204F44B6CAB&amp;gssRefId=7a4a1763-0ac0-4fb7-9d98-e6053e95d191401141426801730&amp;gssStore=true"
   }
}]]></con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/verify</con:originalUri><con:assertion type="GroovyScriptAssertion" id="b2b9bd53-4cd9-4378-ad3e-a47f8bc3793c" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "ERROR"


assert jsonMap.gssResponseHeader.gssError.errorCode == "NO_DATA_FOUND"


assert jsonMap.gssResponseHeader.gssError.errorMsg == "No devices supporting the coarse grained filter"
</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:properties/></con:testCase><con:testCase id="782bb331-24e4-4162-8da9-9be6796976a6" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="TestCase 3.8-Signing-Insufficient_Parameter" searchProperties="true"><con:settings/><con:testStep type="restrequest" name="GetDeviceList" id="062a62f5-f2ec-4623-8872-b0fb41b32a98"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/devicelist" methodName="Devicelist" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="GetDeviceList" id="b063e9a0-5f4c-484f-b84a-038d96c080c1" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request>{
	"gssRequestHeader":{
		"serviceContext":{
			"USER_AGENT":"Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
			"APPLICATION":"B.NET"
		},
		"securityContext":null,
		"requestContext":{
			"REQUEST_TIMESTAMP":"2011-06-14T04:12:36BST",
			"REQUEST_TRACKING_ID":"REQ10001",
			"CALLBACK_URL":"https://bnet.barclays.com/"
		},
		"auditContext":{
			"MODULE_ID":"B.Net Login Module",
			"IS_FINANCIAL_TRANSACTION":"false",
			"CLIENT_IP_ADDRESS":"35.53.180.6"
		}
	},
	"deviceRequestMap":{
		"ONLY_ACTIVE":"true",
		"OUTPUT_TYPE":"BOTH"
	}
}</con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/devicelist</con:originalUri><con:assertion type="GroovyScriptAssertion" id="6c166ddf-cdfe-4189-9b56-bea28374973b" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "SUCCESS"
assert jsonMap.deviceInfo[0].DeviceDetailMap.STATUS == "Active"</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-GetDeviceList" id="bae54659-cef2-4c9b-a9eb-255a2b130d18"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-SC</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>GetDeviceList</con:sourceStep><con:sourcePath>gssResponseHeader.securityContext</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>InitiateLogin</con:targetStep><con:targetPath>initiateRequestHeader.gssRequestHeader.securityContext</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="restrequest" name="InitiateLogin" id="793f5d27-10a9-4407-aa7c-2c4663731e1c"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/initiate" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="InitiateLogin" id="45730af7-4d98-41bd-a00f-24929dff6304" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request>{
   "transactionItemList": [],
   "preFormattedData": "VGhpcyBpcyBhIHNhbXBsZSBvZiBwcmVmb3JtYXR0ZWQgZGF0YSwgY3JlYXRlZCBvbiAyNy8wMy8yMDE1Lg==",
   "initiateRequestHeader":    {
      "gssRequestHeader":       {
         "serviceContext":          {
            "": "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
            "PURN_TYPE": "pki",
            "PURN": "99800000008804000050",
            "APPLICATION": "B.NET"
         },
         "auditContext":          {
            "MODULE_ID": "12345678901234567890123456789012345678901",
            "IS_FINANCIAL_TRANSACTION": "false",
            "SUB_MODULE_ID": "eyJVU0VSX0FHRU5UIjoiSUU4IiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IkdCIn0=",
            "SUBMODULE_ID": "eyJVU0VSX0FHRU5UIjoiSUU4IiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IkdCIn0=",
            "CLIENT_IP_ADDRESS": "35.53.180.6"
         },
         "requestContext":          {
            "REQUEST_TIMESTAMP": "2011-06-14T04:12:36BST",
            "REQUEST_TRACKING_ID": "REQ10001",
            "CALLBACK_URL": "https://bnet.barclays.com/"
         },
         "securityContext": "eyJVU0VSX0FHRU5UIjoiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgNi4xOyBXT1c2NDsgVHJpZGVudC83LjA7IEFTOyBydjoxMS4wKSBsaWtlIEdlY2tvIiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IlBVIn0="
      },
      "initiateRequestHeaderDetails":       {
         "FUNCTION_TYPE": "SIGN-TRANSACTIONS",
         "ACTION_TYPE": "SUBMIT",
         "DEVICE_TYPE_CODE": "SC",
         "OUTPUT_TYPE": "HTML"
      }
   },
   "requestDetailsMap": {}
}</con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/initiate</con:originalUri><con:assertion type="GroovyScriptAssertion" id="3f2a7f7f-4150-4f59-b57e-eddb93b59884" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "ERROR"


assert jsonMap.gssResponseHeader.gssError.errorCode == "INSUFFICIENT_PARAMETERS"


assert jsonMap.gssResponseHeader.gssError.errorMsg == "The mandatory field USER_AGENT is missing or its value is empty  in ServiceContext"
</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Login_SecurityContext" id="d79e09b0-2e60-43a6-beba-69665329a332"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>SGG-SC</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateLogin</con:sourceStep><con:sourcePath>gssResponseHeader.securityContext</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifyLogin</con:targetStep><con:targetPath>gssRequestHeader.securityContext</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Login_GSS-Nonce" id="0c9a2e53-fd36-4a17-b048-983fccd00973"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-NONCE</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateLogin</con:sourceStep><con:sourcePath>gssResponseHeader.responseContext.GSS_NONCE</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifyLogin</con:targetStep><con:targetPath>gssRequestHeader.requestContext.GSS_NONCE</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Login_GSS-Ref-ID" id="bfa3a6a8-b4ff-4f67-a924-344536d3d917" disabled="true"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-REF-ID</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateLogin</con:sourceStep><con:sourcePath>initiateResponseDetailsMap.GSS_REFERENCE_ID</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifyLogin</con:targetStep><con:targetPath>verifyDetailMap.GSS_REFERENCE_ID</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="restrequest" name="VerifyLogin" id="2bae0287-49ef-4eff-99a9-29b4f2ecb35f"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/verify" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="VerifyLogin" id="ae8cc01d-5b14-46b5-8fa6-6207c40ac5af" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request><![CDATA[{
   "verifyDetailMap": {"GSS_REFERENCE_ID": "6250F2C3CAE14C5A8C7099F9DC938950"},
   "gssRequestHeader":    {
      "serviceContext":       {
         "": "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
         "APPLICATION": "B.NET"
      },
      "auditContext":       {
         "MODULE_ID": "B.Net Login Module",
         "IS_FINANCIAL_TRANSACTION": "false",
         "CLIENT_IP_ADDRESS": "35.53.180.6"
      },
      "requestContext":       {
         "REQUEST_TIMESTAMP": "2011-06-14T04:12:36BST",
         "REQUEST_TRACKING_ID": "REQ10001",
         "CALLBACK_URL": "https://bnet.barclays.com/",
         "GSS_NONCE": "bcfec9eb-8bfc-4e58-8b29-0858a4a64c49"
      },
      "securityContext": "eyJQVVJOX1RZUEUiOiJwa2kiLCJQVVJOIjoiOTk4MDAwMDAwMDg4MDQwMDAwNTAiLCJVU0VSX0FHRU5UIjoiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgNi4xOyBXT1c2NDsgVHJpZGVudC83LjA7IEFTOyBydjoxMS4wKSBsaWtlIEdlY2tvIiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIkRFVklDRV9UWVBFX0NPREUiOiJTQyIsIlJFR0lPTiI6IkdCIiwiR1NTX1JFRkVSRU5DRV9JRCI6IjYyNTBGMkMzQ0FFMTRDNUE4QzcwOTlGOURDOTM4OTUwIn0="
   },
   "deviceParamMap":    {
      "HTTP_METHOD": "PUT",
      "HTTP_INPUT_CONTENTS": "Version_Spec=100&amp;Version_Plugin_Major=3&amp;Version_Plugin_Minor=0&amp;Version_Browser_Major=0&amp;Version_Browser_Minor=11&amp;Transaction_ID=7a4a1763-0ac0-4fb7-9d98-e6053e95d191401141426801730&amp;Signature_Data=MIIPZgYJKoZIhvcNAQcCoIIPVzCCD1MCAQExCzAJBgUrDgMCGgUAMIID2wYJKoZIhvcNAQcBoIIDzASCA8hDbGllbnQgTmFtZTogICAgICAgICAgICAgICAgICAgICAgICBURVNUSU5HIENPTVBBTlkgICAgICAgICAgICAgICAgICAgICAgIA0KRG9jdW1lbnQgSUQ6ICAgICAgICAgICAgICAgICAgICAgICAgRjAyNjNBMEUyNDJFNEM5NEI2MEREMjA0RjQ0QjZDQUINClNpZ24gYW5kIFN1Ym1pdCB0aGUgZm9sbG93aW5nIHRyYW5zYWN0aW9ucyAoMSkNCg0KUGF5bWVudCBUeXBlOiAgICAgICAgICAgICAgICAgICAgICAgRG9tZXN0aWMgUGF5bWVudA0KRGVsaXZlcnkgT3B0aW9uOiAgICAgICAgICAgICAgICAgICAgVUsgVGhyZWUgRGF5IFBheW1lbnQNCkRlYml0IEFjY291bnQgQmFuayBJZGVudGlmaWVyOiAgICAgIDA5MDA2Mw0KRGViaXQgQWNjb3VudCBOdW1iZXI6ICAgICAgICAgICAgICAgMDMwNDE0MDENCkRlYml0IEFjY291bnQgQ3VycmVuY3k6ICAgICAgICAgICAgIFBvdW5kIFN0ZXJsaW5nDQpQYXltZW50IEN1cnJlbmN5OiAgICAgICAgICAgICAgICAgICBQb3VuZCBTdGVybGluZw0KUGF5bWVudCBBbW91bnQ6ICAgICAgICAgICAgICAgICAgICAgMjYwMC4wMA0KVHJhbnNhY3Rpb24gUmVmZXJlbmNlIE51bWJlcjogICAgICAgQlgxNTA0MjAwNjkzMjYwNw0KVmFsdWUgRGF0ZTogICAgICAgICAgICAgICAgICAgICAgICAgQXByIDI0LCAyMDE1DQpDdXN0b21lciBSZWZlcmVuY2U6ICAgICAgICAgICAgICAgICAxMjMxMjMxMjMNCk51bWJlciBvZiBjcmVkaXQvZGViaXQgcmVjb3JkczoJICAgIDENCg0KQmVuZWZpY2lhcnkgTmFtZTogICAgICAgICAgICAgICAgICAgMTM0MjM0MjMNCkJlbmVmaWNpYXJ5IEFjY291bnQgQmFuayBJZGVudGlmaWVyOjE4NTAwOA0KQmVuZWZpY2lh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&amp;Signature_Format=PKCS7_basic&amp;IsDetailScrAction=false&amp;pd=F0263A0E242E4C94B60DD204F44B6CAB&amp;gssRefId=7a4a1763-0ac0-4fb7-9d98-e6053e95d191401141426801730&amp;gssStore=true"
   }
}]]></con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/verify</con:originalUri><con:assertion type="GroovyScriptAssertion" id="b2b9bd53-4cd9-4378-ad3e-a47f8bc3793c" name="Script Assertion" disabled="true"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "ERROR"


assert jsonMap.gssResponseHeader.gssError.errorCode == "INSUFFICIENT_PARAMETERS"


assert jsonMap.gssResponseHeader.gssError.errorMsg == "The mandatory field USER_AGENT is missing or its value is empty  in RequestContext"
</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:properties/></con:testCase><con:testCase id="31e108a8-1886-4595-80f2-ca07a0315ca8" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="TestCase 3.9-Signing-IncorrectObjetc" searchProperties="true"><con:settings/><con:testStep type="restrequest" name="GetDeviceList" id="ed252c32-8b06-4f46-922d-f66c9902cc91"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/devicelist" methodName="Devicelist" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="GetDeviceList" id="b063e9a0-5f4c-484f-b84a-038d96c080c1" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request>{
	"gssRequestHeader":{
		"serviceContext":{
			"USER_AGENT":"Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
			"APPLICATION":"B.NET"
		},
		"securityContext":null,
		"requestContext":{
			"REQUEST_TIMESTAMP":"2011-06-14T04:12:36BST",
			"REQUEST_TRACKING_ID":"REQ10001",
			"CALLBACK_URL":"https://bnet.barclays.com/"
		},
		"auditContext":{
			"MODULE_ID":"B.Net Login Module",
			"IS_FINANCIAL_TRANSACTION":"false",
			"CLIENT_IP_ADDRESS":"35.53.180.6"
		}
	},
	"deviceRequestMap":{
		"ONLY_ACTIVE":"true",
		"OUTPUT_TYPE":"BOTH"
	}
}</con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/devicelist</con:originalUri><con:assertion type="GroovyScriptAssertion" id="6c166ddf-cdfe-4189-9b56-bea28374973b" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "SUCCESS"
assert jsonMap.deviceInfo[0].DeviceDetailMap.STATUS == "Active"</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-GetDeviceList" id="7f587ab0-5799-40e8-862d-741c0a05f6cc"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-SC</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>GetDeviceList</con:sourceStep><con:sourcePath>gssResponseHeader.securityContext</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>InitiateLogin</con:targetStep><con:targetPath>initiateRequestHeader.gssRequestHeader.securityContext</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="restrequest" name="InitiateLogin" id="ac2e4bbe-5b14-4f6f-b754-ba20ce444c6b"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/initiate" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="InitiateLogin" id="45730af7-4d98-41bd-a00f-24929dff6304" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request>{
   "transactionItemList": [],
   "preFormattedData": "VGhpcyBpcyBhIHNhbXBsZSBvZiBwcmVmb3JtYXR0ZWQgZGF0YSwgY3JlYXRlZCBvbiAyNy8wMy8yMDE1Lg==",
   "initiateRequestHeader":    {
      "gssRequestHeader":       {
         "serviceContext":          {
            "PURN_TYPE": "pki",
            "USER_AGENT": "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
            "PURN": "99800000008804000050",
            "APPLICATION": "B.NET"
         },
         "auditContext":          {
            "MODULE_ID": "12345678901234567890123456789012345678901",
            "IS_FINANCIAL_TRANSACTION": "false",
            "SUB_MODULE_ID": "eyJVU0VSX0FHRU5UIjoiSUU4IiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IkdCIn0=",
            "SUBMODULE_ID": "eyJVU0VSX0FHRU5UIjoiSUU4IiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IkdCIn0=",
            "CLIENT_IP_ADDRESS": "35.53.180.6"
         },
         "requestContext":          {
            "REQUEST_TIMESTAMP": "2011-06-14T04:12:36BST",
            "REQUEST_TRACKING_ID": "REQ10001",
            "CALLBACK_URL": "https://bnet.barclays.com/"
         },
         "securityContext": "eyJVU0VSX0FHRU5UIjoiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgNi4xOyBXT1c2NDsgVHJpZGVudC83LjA7IEFTOyBydjoxMS4wKSBsaWtlIEdlY2tvIiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IlBVIn0="
      },
      "initiateRequestHeaderDetails":       {
         "FUNCTION_TYPE": "SIGN-TRANSACTIONS",
         "ACTION_TYPE": "SUBMIT",
         "DEVICE_TYPE_CODE": "SC",
         "OUTPUT_TYPE": "HTML"
      }
   },
   "requestDetailsMap": {}
}</con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/initiate</con:originalUri><con:assertion type="GroovyScriptAssertion" id="3f2a7f7f-4150-4f59-b57e-eddb93b59884" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "SUCCESS"
assert jsonMap.gssResponseHeader.responseContext.NEXTACTION == "VERIFY"</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Login_SecurityContext" id="729a3df5-87f0-4821-a04a-8b1205f816f9"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>SGG-SC</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateLogin</con:sourceStep><con:sourcePath>gssResponseHeader.securityContext</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifyLogin</con:targetStep><con:targetPath>gssRequestHeader.securityContext</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Login_GSS-Nonce" id="919e9240-b2a6-4813-b1bf-9bfa46e294f2" disabled="true"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-NONCE</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateLogin</con:sourceStep><con:sourcePath>gssResponseHeader.responseContext.GSS_NONCE</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifyLogin</con:targetStep><con:targetPath>gssRequestHeader.requestContext.GSS_NONCE</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Login_GSS-Ref-ID" id="43b1a5c2-3002-4298-961e-907b89ad2639" disabled="true"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-REF-ID</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateLogin</con:sourceStep><con:sourcePath>initiateResponseDetailsMap.GSS_REFERENCE_ID</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifyLogin</con:targetStep><con:targetPath>verifyDetailMap.GSS_REFERENCE_ID</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="restrequest" name="VerifyLogin" id="c954fc42-1493-4e60-b713-44397b971bf2"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/verify" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="VerifyLogin" id="ae8cc01d-5b14-46b5-8fa6-6207c40ac5af" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request><![CDATA[{
   "verifyDetailMap": {"GSS_REFERENCE_ID": "46016D2261964A5E8D5BA439F56A57A9"},
   "gssRequestHeader":    {
      "serviceContext":       {
         "USER_AGENT": "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
         "APPLICATION": "B.NET"
      },
      "auditContext":       {
         "MODULE_ID": "B.Net Login Module",
         "IS_FINANCIAL_TRANSACTION": "false",
         "CLIENT_IP_ADDRESS": "35.53.180.6"
      },
      "securityContext": "eyJQVVJOX1RZUEUiOiJwa2kiLCJQVVJOIjoiOTk4MDAwMDAwMDg4MDQwMDAwNTAiLCJVU0VSX05BTUUiOiJKZXNpY2ExMCBhbGJhMTAiLCJDTElFTlRfTkFNRSI6IkJhcmNsYXlzIGNvcnAgTGltaXRlZCBURCIsIlVTRVJfQUdFTlQiOiJNb3ppbGxhLzUuMCAoV2luZG93cyBOVCA2LjE7IFdPVzY0OyBUcmlkZW50LzcuMDsgQVM7IHJ2OjExLjApIGxpa2UgR2Vja28iLCJBUFBMSUNBVElPTiI6IkIuTkVUIiwiREVWSUNFX1RZUEVfQ09ERSI6IlNDIiwiREVWSUNFX0FMSUFTIjoiU0MgQWxpYXMiLCJSRUdJT04iOiJHQiIsIlVTRVJfU1RBVFVTIjoiQUNUSVZFIiwiR1NTX1JFRkVSRU5DRV9JRCI6IjRFOEYwODA4MzRGMTRENkM4QTZEQTBDQ0U1RENEMUZBIn0=",
      "-requestContext":       {
         "REQUEST_TIMESTAMP": "2011-06-14T04:12:36BST",
         "REQUEST_TRACKING_ID": "REQ10001",
         "CALLBACK_URL": "https://bnet.barclays.com/",
         "GSS_NONCE": "8c028017-83ec-4393-894b-3e9e2087c40e"
      }
   },
   "deviceParamMap":    {
      "HTTP_METHOD": "PUT",
      "HTTP_INPUT_CONTENTS": "Version_Spec=100&amp;Version_Plugin_Major=3&amp;Version_Plugin_Minor=0&amp;Version_Browser_Major=0&amp;Version_Browser_Minor=11&amp;Transaction_ID=7a4a1763-0ac0-4fb7-9d98-e6053e95d191401141426801730&amp;Signature_Data=MIIPZgYJKoZIhvcNAQcCoIIPVzCCD1MCAQExCzAJBgUrDgMCGgUAMIID2wYJKoZIhvcNAQcBoIIDzASCA8hDbGllbnQgTmFtZTogICAgICAgICAgICAgICAgICAgICAgICBURVNUSU5HIENPTVBBTlkgICAgICAgICAgICAgICAgICAgICAgIA0KRG9jdW1lbnQgSUQ6ICAgICAgICAgICAgICAgICAgICAgICAgRjAyNjNBMEUyNDJFNEM5NEI2MEREMjA0RjQ0QjZDQUINClNpZ24gYW5kIFN1Ym1pdCB0aGUgZm9sbG93aW5nIHRyYW5zYWN0aW9ucyAoMSkNCg0KUGF5bWVudCBUeXBlOiAgICAgICAgICAgICAgICAgICAgICAgRG9tZXN0aWMgUGF5bWVudA0KRGVsaXZlcnkgT3B0aW9uOiAgICAgICAgICAgICAgICAgICAgVUsgVGhyZWUgRGF5IFBheW1lbnQNCkRlYml0IEFjY291bnQgQmFuayBJZGVudGlmaWVyOiAgICAgIDA5MDA2Mw0KRGViaXQgQWNjb3VudCBOdW1iZXI6ICAgICAgICAgICAgICAgMDMwNDE0MDENCkRlYml0IEFjY291bnQgQ3VycmVuY3k6ICAgICAgICAgICAgIFBvdW5kIFN0ZXJsaW5nDQpQYXltZW50IEN1cnJlbmN5OiAgICAgICAgICAgICAgICAgICBQb3VuZCBTdGVybGluZw0KUGF5bWVudCBBbW91bnQ6ICAgICAgICAgICAgICAgICAgICAgMjYwMC4wMA0KVHJhbnNhY3Rpb24gUmVmZXJlbmNlIE51bWJlcjogICAgICAgQlgxNTA0MjAwNjkzMjYwNw0KVmFsdWUgRGF0ZTogICAgICAgICAgICAgICAgICAgICAgICAgQXByIDI0LCAyMDE1DQpDdXN0b21lciBSZWZlcmVuY2U6ICAgICAgICAgICAgICAgICAxMjMxMjMxMjMNCk51bWJlciBvZiBjcmVkaXQvZGViaXQgcmVjb3JkczoJICAgIDENCg0KQmVuZWZpY2lhcnkgTmFtZTogICAgICAgICAgICAgICAgICAgMTM0MjM0MjMNCkJlbmVmaWNpYXJ5IEFjY291bnQgQmFuayBJZGVudGlmaWVyOjE4NTAwOA0KQmVuZWZpY2lh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&amp;Signature_Format=PKCS7_basic&amp;IsDetailScrAction=false&amp;pd=F0263A0E242E4C94B60DD204F44B6CAB&amp;gssRefId=7a4a1763-0ac0-4fb7-9d98-e6053e95d191401141426801730&amp;gssStore=true"
   }
}]]></con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/verify</con:originalUri><con:assertion type="GroovyScriptAssertion" id="b2b9bd53-4cd9-4378-ad3e-a47f8bc3793c" name="Script Assertion" disabled="true"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "SUCCESS"
assert jsonMap.gssResponseHeader.responseContext.NEXTACTION == "COMPLETE"</scriptText></con:configuration></con:assertion><con:assertion type="Simple NotContains" id="1350b3d8-39e6-4cd5-a887-f2b92b320d9a" name="Not Contains"><con:configuration><token>SUCCESS</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:properties/></con:testCase><con:testCase id="aa351913-23a3-4f95-83ad-1256041d47cd" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="TestCase 3.10-Signing-ILLEGAL_DATA_MODIFICATION" searchProperties="true"><con:settings/><con:testStep type="restrequest" name="GetDeviceList" id="76927474-5643-45c4-b027-afd41148f985"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/devicelist" methodName="Devicelist" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="GetDeviceList" id="b063e9a0-5f4c-484f-b84a-038d96c080c1" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request>{
	"gssRequestHeader":{
		"serviceContext":{
			"USER_AGENT":"Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
			"APPLICATION":"B.NET"
		},
		"securityContext":null,
		"requestContext":{
			"REQUEST_TIMESTAMP":"2011-06-14T04:12:36BST",
			"REQUEST_TRACKING_ID":"REQ10001",
			"CALLBACK_URL":"https://bnet.barclays.com/"
		},
		"auditContext":{
			"MODULE_ID":"B.Net Login Module",
			"IS_FINANCIAL_TRANSACTION":"false",
			"CLIENT_IP_ADDRESS":"35.53.180.6"
		}
	},
	"deviceRequestMap":{
		"ONLY_ACTIVE":"true",
		"OUTPUT_TYPE":"BOTH"
	}
}</con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/devicelist</con:originalUri><con:assertion type="GroovyScriptAssertion" id="6c166ddf-cdfe-4189-9b56-bea28374973b" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "SUCCESS"
assert jsonMap.deviceInfo[0].DeviceDetailMap.STATUS == "Active"</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-GetDeviceList" id="eadcd1ca-8bb5-4b30-adfb-c4b2014af39c"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-SC</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>GetDeviceList</con:sourceStep><con:sourcePath>gssResponseHeader.securityContext</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>InitiateLogin</con:targetStep><con:targetPath>initiateRequestHeader.gssRequestHeader.securityContext</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="restrequest" name="InitiateLogin" id="50297025-dd7c-4a6e-bd03-bb40cf954124"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/initiate" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="InitiateLogin" id="45730af7-4d98-41bd-a00f-24929dff6304" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request>{
   "transactionItemList": [],
   "preFormattedData": "VGhpcyBpcyBhIHNhbXBsZSBvZiBwcmVmb3JtYXR0ZWQgZGF0YSwgY3JlYXRlZCBvbiAyNy8wMy8yMDE1Lg==",
   "initiateRequestHeader":    {
      "gssRequestHeader":       {
         "serviceContext":          {
            "PURN_TYPE": "pki",
            "USER_AGENT": "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
            "PURN": "99800000008804000050",
            "APPLICATION": "B.NET"
         },
         "auditContext":          {
            "MODULE_ID": "12345678901234567890123456789012345678901",
            "IS_FINANCIAL_TRANSACTION": "false",
            "SUB_MODULE_ID": "eyJVU0VSX0FHRU5UIjoiSUU4IiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IkdCIn0=",
            "SUBMODULE_ID": "eyJVU0VSX0FHRU5UIjoiSUU4IiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IkdCIn0=",
            "CLIENT_IP_ADDRESS": "35.53.180.6"
         },
         "requestContext":          {
            "REQUEST_TIMESTAMP": "2011-06-14T04:12:36BST",
            "REQUEST_TRACKING_ID": "REQ10001",
            "CALLBACK_URL": "https://bnet.barclays.com/"
         },
         "securityContext": "eyJVU0VSX0FHRU5UIjoiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgNi4xOyBXT1c2NDsgVHJpZGVudC83LjA7IEFTOyBydjoxMS4wKSBsaWtlIEdlY2tvIiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IlBVIn0="
      },
      "initiateRequestHeaderDetails":       {
         "FUNCTION_TYPE": "SIGN-TRANSACTIONS",
         "ACTION_TYPE": "SUBMIT",
         "DEVICE_TYPE_CODE": "SC",
         "OUTPUT_TYPE": "HTML"
      }
   },
   "requestDetailsMap": {}
}</con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/initiate</con:originalUri><con:assertion type="GroovyScriptAssertion" id="3f2a7f7f-4150-4f59-b57e-eddb93b59884" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "SUCCESS"
assert jsonMap.gssResponseHeader.responseContext.NEXTACTION == "VERIFY"</scriptText></con:configuration></con:assertion><con:assertion type="Simple NotContains" id="8e764f2a-08c4-484a-ae2c-e00938057b31" name="Not Contains" disabled="true"><con:configuration><token>SUCCESS</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Login_SecurityContext" id="fa0dd1c5-0d5c-4cf9-af80-a3df096f2d2f"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>SGG-SC</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateLogin</con:sourceStep><con:sourcePath>gssResponseHeader.securityContext</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifyLogin</con:targetStep><con:targetPath>gssRequestHeader.securityContext</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Login_GSS-Nonce" id="24a18177-e85a-44fd-ba65-9c4e86421a7c"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-NONCE</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateLogin</con:sourceStep><con:sourcePath>gssResponseHeader.responseContext.GSS_NONCE</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifyLogin</con:targetStep><con:targetPath>gssRequestHeader.requestContext.GSS_NONCE</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Login_GSS-Ref-ID" id="24fa518f-95fe-4bda-9279-48049a7b4fce"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-REF-ID</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateLogin</con:sourceStep><con:sourcePath>initiateResponseDetailsMap.GSS_REFERENCE_ID</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifyLogin</con:targetStep><con:targetPath>verifyDetailMap.GSS_REFERENCE_ID</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="restrequest" name="VerifyLogin" id="f603c622-588f-4cfc-9503-65b7b6bf7b60"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/verify" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="VerifyLogin" id="ae8cc01d-5b14-46b5-8fa6-6207c40ac5af" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request><![CDATA[{
   "verifyDetailMap": {"GSS_REFERENCE_ID": "CA78351AEB894302A1D09EED8ACC2BE5"},
   "gssRequestHeader":    {
      "serviceContext":       {
         "USER_AGENT": "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
         "APPLICATION": "B.NET"
      },
      "auditContext":       {
         "MODULE_ID": "B.Net Login Module",
         "IS_FINANCIAL_TRANSACTION": "false",
         "CLIENT_IP_ADDRESS": "35.53.180.6"
      },
      "requestContext":       {
         "REQUEST_TIMESTAMP": "2011-06-14T04:12:36BST",
         "REQUEST_TRACKING_ID": "REQ10001",
         "CALLBACK_URL": "https://bnet.barclays.com/",
         "GSS_NONCE": "498d9248-03a5-4836-9cd8-db3b33148e73"
      },
      "securityContext": "eyJQVVJOX1RZUEUiOiJwa2kiLCJQVVJOIjoiOTk4MDAwMDAwMDg4MDQwMDAwNTAiLCJVU0VSX05BTUUiOiJKZXNpY2ExMCBhbGJhMTAiLCJDTElFTlRfTkFNRSI6IkJhcmNsYXlzIGNvcnAgTGltaXRlZCBURCIsIlVTRVJfQUdFTlQiOiJNb3ppbGxhLzUuMCAoV2luZG93cyBOVCA2LjE7IFdPVzY0OyBUcmlkZW50LzcuMDsgQVM7IHJ2OjExLjApIGxpa2UgR2Vja28iLCJBUFBMSUNBVElPTiI6IkIuTkVUIiwiREVWSUNFX1RZUEVfQ09ERSI6IlNDIiwiREVWSUNFX0FMSUFTIjoiU0MgQWxpYXMiLCJSRUdJT04iOiJHQiIsIlVTRVJfU1RBVFVTIjoiQUNUSVZFIiwiR1NTX1JFRkVSRU5DRV9JRCI6IkNBNzgzNTFBRUI4OTQzMDJBMUQwOUVFRDhBQ0MyQkU1In0="
   },
   "deviceParamMap":    {
      "HTTP_METHOD": "PUT",
      "HTTP_INPUT_CONTENTS": "Version_Spec=100&amp;Version_Plugin_Major=3&amp;Version_Plugin_Minor=0&amp;Version_Browser_Major=0&amp;Version_Browser_Minor=11&amp;Transaction_ID=7a4a1763-0ac0-4fb7-9d98-e6053e95d191401141426801730&amp;Signature_DataICAgICAgICAgICAgICAgICAgICAgICBURVNUSU5HIENPTVBBTlkgICAgICAgICAgICAgICAgICAgICAgIA0KRG9jdW1lbnQgSUQ6ICAgICAgICAgICAgICAgICAgICAgICAgRjAyNjNBMEUyNDJFNEM5NEI2MEREMjA0RjQ0QjZDQUINClNpZ24gYW5kIFN1Ym1pdCB0aGUgZm9sbG93aW5nIHRyYW5zYWN0aW9ucyAoMSkNCg0KUGF5bWVudCBUeXBlOiAgICAgICAgICAgICAgICAgICAgICAgRG9tZXN0aWMgUGF5bWVudA0KRGVsaXZlcnkgT3B0aW9uOiAgICAgICAgICAgICAgICAgICAgVUsgVGhyZWUgRGF5IFBheW1lbnQNCkRlYml0IEFjY291bnQgQmFuayBJZGVudGlmaWVyOiAgICAgIDA5MDA2Mw0KRGViaXQgQWNjb3VudCBOdW1iZXI6ICAgICAgICAgICAgICAgMDMwNDE0MDENCkRlYml0IEFjY291bnQgQ3VycmVuY3k6ICAgICAgICAgICAgIFBvdW5kIFN0ZXJsaW5nDQpQYXltZW50IEN1cnJlbmN5OiAgICAgICAgICAgICAgICAgICBQb3VuZCBTdGVybGluZw0KUGF5bWVudCBBbW91bnQ6ICAgICAgICAgICAgICAgICAgICAgMjYwMC4wMA0KVHJhbnNhY3Rpb24gUmVmZXJlbmNlIE51bWJlcjogICAgICAgQlgxNTA0MjAwNjkzMjYwNw0KVmFsdWUgRGF0ZTogICAgICAgICAgICAgICAgICAgICAgICAgQXByIDI0LCAyMDE1DQpDdXN0b21lciBSZWZlcmVuY2U6ICAgICAgICAgICAgICAgICAxMjMxMjMxMjMNCk51bWJlciBvZiBjcmVkaXQvZGViaXQgcmVjb3JkczoJICAgIDENCg0KQmVuZWZpY2lhcnkgTmFtZTogICAgICAgICAgICAgICAgICAgMTM0MjM0MjMNCkJlbmVmaWNpYXJ5IEFjY291bnQgQmFuayBJZGVudGlmaWVyOjE4NTAwOA0KQmVuZWZpY2lhcnkgQWNjb3VudCBOdW1iZXI6ICAgICAgICAgNDE4NTAwODMNCkJlbmVmaWNpYXJ5IEFtb3VudDogICAgICAgICAgICAgICAg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&amp;Signature_Format=PKCS7_basic&amp;IsDetailScrAction=false&amp;pd=F0263A0E242E4C94B60DD204F44B6CAB&amp;gssRefId=7a4a1763-0ac0-4fb7-9d98-e6053e95d191401141426801730&amp;gssStore=true"
   }
}]]></con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/verify</con:originalUri><con:assertion type="GroovyScriptAssertion" id="b2b9bd53-4cd9-4378-ad3e-a47f8bc3793c" name="Script Assertion" disabled="true"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "SUCCESS"
assert jsonMap.gssResponseHeader.responseContext.NEXTACTION == "COMPLETE"</scriptText></con:configuration></con:assertion><con:assertion type="Simple NotContains" id="fcfc605e-23f2-411c-99ff-97c4fb8ca583" name="Not Contains"><con:configuration><token>SUCCESS</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:properties/></con:testCase><con:testCase id="9dc1ccd8-f92c-4e64-bd9f-ebdf1b147608" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="TestCase 3.11-Signing-SessionTimeOut>20" searchProperties="true"><con:settings/><con:testStep type="restrequest" name="GetDeviceList" id="004f13a1-abd0-487e-923b-32111640f8d0"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/devicelist" methodName="Devicelist" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="GetDeviceList" id="b063e9a0-5f4c-484f-b84a-038d96c080c1" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request>{
	"gssRequestHeader":{
		"serviceContext":{
			"USER_AGENT":"Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
			"APPLICATION":"B.NET"
		},
		"securityContext":null,
		"requestContext":{
			"REQUEST_TIMESTAMP":"2011-06-14T04:12:36BST",
			"REQUEST_TRACKING_ID":"REQ10001",
			"CALLBACK_URL":"https://bnet.barclays.com/"
		},
		"auditContext":{
			"MODULE_ID":"B.Net Login Module",
			"IS_FINANCIAL_TRANSACTION":"false",
			"CLIENT_IP_ADDRESS":"35.53.180.6"
		}
	},
	"deviceRequestMap":{
		"ONLY_ACTIVE":"true",
		"OUTPUT_TYPE":"BOTH"
	}
}</con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/devicelist</con:originalUri><con:assertion type="GroovyScriptAssertion" id="6c166ddf-cdfe-4189-9b56-bea28374973b" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "SUCCESS"
assert jsonMap.deviceInfo[0].DeviceDetailMap.STATUS == "Active"</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-GetDeviceList" id="70a0fa15-c64f-4679-a06d-f9b161b0d942"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-SC</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>GetDeviceList</con:sourceStep><con:sourcePath>gssResponseHeader.securityContext</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>InitiateLogin</con:targetStep><con:targetPath>initiateRequestHeader.gssRequestHeader.securityContext</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="restrequest" name="InitiateLogin" id="efcafc65-3e91-49d0-8210-2dffdc6fdb99"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/initiate" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="InitiateLogin" id="45730af7-4d98-41bd-a00f-24929dff6304" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request>{
   "transactionItemList": [],
   "preFormattedData": "VGhpcyBpcyBhIHNhbXBsZSBvZiBwcmVmb3JtYXR0ZWQgZGF0YSwgY3JlYXRlZCBvbiAyNy8wMy8yMDE1Lg==",
   "initiateRequestHeader":    {
      "gssRequestHeader":       {
         "serviceContext":          {
            "PURN_TYPE": "pki",
            "PURN": "99800000008804000050",
            "USER_AGENT": "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
            "APPLICATION": "B.NET"
         },
         "auditContext":          {
            "MODULE_ID": "12345678901234567890123456789012345678901",
            "IS_FINANCIAL_TRANSACTION": "false",
            "SUB_MODULE_ID": "eyJVU0VSX0FHRU5UIjoiSUU4IiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IkdCIn0=",
            "SUBMODULE_ID": "eyJVU0VSX0FHRU5UIjoiSUU4IiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IkdCIn0=",
            "CLIENT_IP_ADDRESS": "35.53.180.6"
         },
         "requestContext":          {
            "REQUEST_TIMESTAMP": "2011-06-14T04:12:36BST",
            "REQUEST_TRACKING_ID": "REQ10001",
            "CALLBACK_URL": "https://bnet.barclays.com/"
         },
         "securityContext": "eyJVU0VSX0FHRU5UIjoiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgNi4xOyBXT1c2NDsgVHJpZGVudC83LjA7IEFTOyBydjoxMS4wKSBsaWtlIEdlY2tvIiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IlBVIn0="
      },
      "initiateRequestHeaderDetails":       {
         "FUNCTION_TYPE": "SIGN-TRANSACTIONS",
         "ACTION_TYPE": "SUBMIT",
         "DEVICE_TYPE_CODE": "SC",
         "OUTPUT_TYPE": "HTML"
      }
   },
   "requestDetailsMap": {}
}</con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/initiate</con:originalUri><con:assertion type="GroovyScriptAssertion" id="3f2a7f7f-4150-4f59-b57e-eddb93b59884" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "SUCCESS"
assert jsonMap.gssResponseHeader.responseContext.NEXTACTION == "VERIFY"</scriptText></con:configuration></con:assertion><con:assertion type="Simple NotContains" id="8e764f2a-08c4-484a-ae2c-e00938057b31" name="Not Contains" disabled="true"><con:configuration><token>SUCCESS</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Login_SecurityContext" id="8f252324-2069-42a9-bd40-6107fdb8fe3d"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>SGG-SC</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateLogin</con:sourceStep><con:sourcePath>gssResponseHeader.securityContext</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifyLogin</con:targetStep><con:targetPath>gssRequestHeader.securityContext</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Login_GSS-Nonce" id="4912c68b-e0f1-42e0-a26a-e64c8a30ded0"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-NONCE</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateLogin</con:sourceStep><con:sourcePath>gssResponseHeader.responseContext.GSS_NONCE</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifyLogin</con:targetStep><con:targetPath>gssRequestHeader.requestContext.GSS_NONCE</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Login_GSS-Ref-ID" id="75c10ea6-832a-4a67-aea7-31b07645c504"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-REF-ID</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateLogin</con:sourceStep><con:sourcePath>initiateResponseDetailsMap.GSS_REFERENCE_ID</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifyLogin</con:targetStep><con:targetPath>verifyDetailMap.GSS_REFERENCE_ID</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="delay" name="Delay" id="2237a00b-fe4b-4043-9b74-f79b482c237b"><con:settings/><con:config><delay>1200009</delay></con:config></con:testStep><con:testStep type="restrequest" name="VerifyLogin" id="f27c8437-73ec-4cdb-a827-03f41ab67e0f"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/verify" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="VerifyLogin" id="ae8cc01d-5b14-46b5-8fa6-6207c40ac5af" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request><![CDATA[{
   "verifyDetailMap": {"GSS_REFERENCE_ID": "D97C26F90FAE425197F7F85731C160CF"},
   "gssRequestHeader":    {
      "serviceContext":       {
         "USER_AGENT": "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
         "APPLICATION": "B.NET"
      },
      "auditContext":       {
         "MODULE_ID": "B.Net Login Module",
         "IS_FINANCIAL_TRANSACTION": "false",
         "CLIENT_IP_ADDRESS": "35.53.180.6"
      },
      "requestContext":       {
         "REQUEST_TIMESTAMP": "2011-06-14T04:12:36BST",
         "REQUEST_TRACKING_ID": "REQ10001",
         "CALLBACK_URL": "https://bnet.barclays.com/",
         "GSS_NONCE": "660941a4-ab52-4413-94fb-4daa32b91460"
      },
      "securityContext": "eyJQVVJOX1RZUEUiOiJwa2kiLCJQVVJOIjoiOTk4MDAwMDAwMDg4MDQwMDAwNTAiLCJVU0VSX05BTUUiOiJKZXNpY2ExMCBhbGJhMTAiLCJDTElFTlRfTkFNRSI6IkJhcmNsYXlzIGNvcnAgTGltaXRlZCBURCIsIlVTRVJfQUdFTlQiOiJNb3ppbGxhLzUuMCAoV2luZG93cyBOVCA2LjE7IFdPVzY0OyBUcmlkZW50LzcuMDsgQVM7IHJ2OjExLjApIGxpa2UgR2Vja28iLCJBUFBMSUNBVElPTiI6IkIuTkVUIiwiREVWSUNFX1RZUEVfQ09ERSI6IlNDIiwiREVWSUNFX0FMSUFTIjoiU0MgQWxpYXMiLCJSRUdJT04iOiJHQiIsIlVTRVJfU1RBVFVTIjoiQUNUSVZFIiwiR1NTX1JFRkVSRU5DRV9JRCI6IkQ5N0MyNkY5MEZBRTQyNTE5N0Y3Rjg1NzMxQzE2MENGIn0="
   },
   "deviceParamMap":    {
      "HTTP_METHOD": "PUT",
      "HTTP_INPUT_CONTENTS": "Version_Spec=100&amp;Version_Plugin_Major=3&amp;Version_Plugin_Minor=0&amp;Version_Browser_Major=0&amp;Version_Browser_Minor=11&amp;Transaction_ID=7a4a1763-0ac0-4fb7-9d98-e6053e95d191401141426801730&amp;Signature_DataICAgICAgICAgICAgICAgICAgICAgICBURVNUSU5HIENPTVBBTlkgICAgICAgICAgICAgICAgICAgICAgIA0KRG9jdW1lbnQgSUQ6ICAgICAgICAgICAgICAgICAgICAgICAgRjAyNjNBMEUyNDJFNEM5NEI2MEREMjA0RjQ0QjZDQUINClNpZ24gYW5kIFN1Ym1pdCB0aGUgZm9sbG93aW5nIHRyYW5zYWN0aW9ucyAoMSkNCg0KUGF5bWVudCBUeXBlOiAgICAgICAgICAgICAgICAgICAgICAgRG9tZXN0aWMgUGF5bWVudA0KRGVsaXZlcnkgT3B0aW9uOiAgICAgICAgICAgICAgICAgICAgVUsgVGhyZWUgRGF5IFBheW1lbnQNCkRlYml0IEFjY291bnQgQmFuayBJZGVudGlmaWVyOiAgICAgIDA5MDA2Mw0KRGViaXQgQWNjb3VudCBOdW1iZXI6ICAgICAgICAgICAgICAgMDMwNDE0MDENCkRlYml0IEFjY291bnQgQ3VycmVuY3k6ICAgICAgICAgICAgIFBvdW5kIFN0ZXJsaW5nDQpQYXltZW50IEN1cnJlbmN5OiAgICAgICAgICAgICAgICAgICBQb3VuZCBTdGVybGluZw0KUGF5bWVudCBBbW91bnQ6ICAgICAgICAgICAgICAgICAgICAgMjYwMC4wMA0KVHJhbnNhY3Rpb24gUmVmZXJlbmNlIE51bWJlcjogICAgICAgQlgxNTA0MjAwNjkzMjYwNw0KVmFsdWUgRGF0ZTogICAgICAgICAgICAgICAgICAgICAgICAgQXByIDI0LCAyMDE1DQpDdXN0b21lciBSZWZlcmVuY2U6ICAgICAgICAgICAgICAgICAxMjMxMjMxMjMNCk51bWJlciBvZiBjcmVkaXQvZGViaXQgcmVjb3JkczoJICAgIDENCg0KQmVuZWZpY2lhcnkgTmFtZTogICAgICAgICAgICAgICAgICAgMTM0MjM0MjMNCkJlbmVmaWNpYXJ5IEFjY291bnQgQmFuayBJZGVudGlmaWVyOjE4NTAwOA0KQmVuZWZpY2lhcnkgQWNjb3VudCBOdW1iZXI6ICAgICAgICAgNDE4NTAwODMNCkJlbmVmaWNpYXJ5IEFtb3VudDogICAgICAgICAgICAgICAg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&amp;Signature_Format=PKCS7_basic&amp;IsDetailScrAction=false&amp;pd=F0263A0E242E4C94B60DD204F44B6CAB&amp;gssRefId=7a4a1763-0ac0-4fb7-9d98-e6053e95d191401141426801730&amp;gssStore=true"
   }
}]]></con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/verify</con:originalUri><con:assertion type="GroovyScriptAssertion" id="b2b9bd53-4cd9-4378-ad3e-a47f8bc3793c" name="Script Assertion" disabled="true"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "SUCCESS"
assert jsonMap.gssResponseHeader.responseContext.NEXTACTION == "COMPLETE"</scriptText></con:configuration></con:assertion><con:assertion type="Simple NotContains" id="fcfc605e-23f2-411c-99ff-97c4fb8ca583" name="Not Contains"><con:configuration><token>SUCCESS</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:properties/></con:testCase><con:testCase id="05ae3ba7-6431-4961-9b2e-5d689edc14e5" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="TestCase 3.1-Hitachi--Signing-HappyFlow" searchProperties="true"><con:settings/><con:testStep type="restrequest" name="GetDeviceList" id="132152d0-5118-49fb-b2e4-71c4e7f543ae"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/devicelist" methodName="Devicelist" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="GetDeviceList" id="b063e9a0-5f4c-484f-b84a-038d96c080c1" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request>{
	"gssRequestHeader":{
		"serviceContext":{
			"USER_AGENT":"Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
			"APPLICATION":"B.NET"
		},
		"securityContext":null,
		"requestContext":{
			"REQUEST_TIMESTAMP":"2011-06-14T04:12:36BST",
			"REQUEST_TRACKING_ID":"REQ10001",
			"CALLBACK_URL":"https://bnet.barclays.com/"
		},
		"auditContext":{
			"MODULE_ID":"B.Net Login Module",
			"IS_FINANCIAL_TRANSACTION":"false",
			"CLIENT_IP_ADDRESS":"35.53.180.6"
		}
	},
	"deviceRequestMap":{
		"ONLY_ACTIVE":"true",
		"OUTPUT_TYPE":"BOTH"
	}
}</con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/devicelist</con:originalUri><con:assertion type="GroovyScriptAssertion" id="6c166ddf-cdfe-4189-9b56-bea28374973b" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "SUCCESS"
assert jsonMap.deviceInfo[0].DeviceDetailMap.STATUS == "Active"</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-GetDeviceList" id="87b05ba9-4989-4263-818f-dc2b3b2d5d3f"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-SC</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>GetDeviceList</con:sourceStep><con:sourcePath>gssResponseHeader.securityContext</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>InitiateLogin</con:targetStep><con:targetPath>initiateRequestHeader.gssRequestHeader.securityContext</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="restrequest" name="InitiateLogin" id="639b0a1a-3844-4d69-b871-8d01f34dfd16"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/initiate" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="InitiateLogin" id="45730af7-4d98-41bd-a00f-24929dff6304" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request>{
   "transactionItemList": [],
   "preFormattedData": "VGhpcyBpcyBhIHNhbXBsZSBvZiBwcmVmb3JtYXR0ZWQgZGF0YSwgY3JlYXRlZCBvbiAyNy8wMy8yMDE1Lg==",
   "initiateRequestHeader":    {
      "gssRequestHeader":       {
         "serviceContext":          {
            "PURN_TYPE": "pki",
            "PURN": "99000000000000000003",
            "USER_AGENT": "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
            "APPLICATION": "B.NET"
         },
         "auditContext":          {
            "MODULE_ID": "12345678901234567890123456789012345678901",
            "IS_FINANCIAL_TRANSACTION": "false",
            "SUB_MODULE_ID": "eyJVU0VSX0FHRU5UIjoiSUU4IiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IkdCIn0=",
            "SUBMODULE_ID": "eyJVU0VSX0FHRU5UIjoiSUU4IiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IkdCIn0=",
            "CLIENT_IP_ADDRESS": "35.53.180.6"
         },
         "requestContext":          {
            "REQUEST_TIMESTAMP": "2011-06-14T04:12:36BST",
            "REQUEST_TRACKING_ID": "REQ10001",
            "CALLBACK_URL": "https://bnet.barclays.com/"
         },
         "securityContext": "eyJVU0VSX0FHRU5UIjoiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgNi4xOyBXT1c2NDsgVHJpZGVudC83LjA7IEFTOyBydjoxMS4wKSBsaWtlIEdlY2tvIiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IlBVIn0="
      },
      "initiateRequestHeaderDetails":       {
         "FUNCTION_TYPE": "AUTHENTICATE",
         "ACTION_TYPE": "SUBMIT",
         "DEVICE_TYPE_CODE": "FV",
         "OUTPUT_TYPE": "HTML"
      }
   },
   "requestDetailsMap": {}
}</con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/initiate</con:originalUri><con:assertion type="GroovyScriptAssertion" id="3f2a7f7f-4150-4f59-b57e-eddb93b59884" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "SUCCESS"
assert jsonMap.gssResponseHeader.responseContext.NEXTACTION == "VERIFY"</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Login_SecurityContext" id="5e684a1d-894f-4801-98cc-a4dec480eab3"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>SGG-SC</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateLogin</con:sourceStep><con:sourcePath>gssResponseHeader.securityContext</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifyLogin</con:targetStep><con:targetPath>gssRequestHeader.securityContext</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Login_GSS-Nonce" id="fc76eb74-aab4-4813-b949-6e547aeaa29b"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-NONCE</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateLogin</con:sourceStep><con:sourcePath>gssResponseHeader.responseContext.GSS_NONCE</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifyLogin</con:targetStep><con:targetPath>gssRequestHeader.requestContext.GSS_NONCE</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Login_GSS-Ref-ID" id="4a267f77-79f2-4537-bfc4-5c09fbfa9a68"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-REF-ID</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateLogin</con:sourceStep><con:sourcePath>initiateResponseDetailsMap.GSS_REFERENCE_ID</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifyLogin</con:targetStep><con:targetPath>verifyDetailMap.GSS_REFERENCE_ID</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="restrequest" name="VerifyLogin" id="34d97d4a-b248-475e-ac98-d824b06e05cf"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/verify" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="VerifyLogin" id="ae8cc01d-5b14-46b5-8fa6-6207c40ac5af" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request><![CDATA[{
   "verifyDetailMap": {"GSS_REFERENCE_ID": "2F0E9A68BCD54B2D8E4545D4EC8AABD6"},
   "gssRequestHeader":    {
      "serviceContext":       {
         "USER_AGENT": "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
         "APPLICATION": "B.NET"
      },
      "auditContext":       {
         "MODULE_ID": "B.Net Login Module",
         "IS_FINANCIAL_TRANSACTION": "false",
         "CLIENT_IP_ADDRESS": "35.53.180.6"
      },
      "requestContext":       {
         "REQUEST_TIMESTAMP": "2011-06-14T04:12:36BST",
         "REQUEST_TRACKING_ID": "REQ10001",
         "CALLBACK_URL": "https://bnet.barclays.com/",
         "GSS_NONCE": "e6c84353-cb8a-4c59-aa26-69af6d280666"
      },
      "securityContext": "eyJQVVJOX1RZUEUiOiJwa2kiLCJQVVJOIjoiOTkwMDAwMDAwMDAwMDAwMDAwMDMiLCJVU0VSX0FHRU5UIjoiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgNi4xOyBXT1c2NDsgVHJpZGVudC83LjA7IEFTOyBydjoxMS4wKSBsaWtlIEdlY2tvIiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIkRFVklDRV9UWVBFX0NPREUiOiJGViIsIlJFR0lPTiI6IkdCIiwiR1NTX1JFRkVSRU5DRV9JRCI6IjJGMEU5QTY4QkNENTRCMkQ4RTQ1NDVENEVDOEFBQkQ2In0="
   },
   "deviceParamMap":    {
      "HTTP_METHOD": "PUT",
      "HTTP_INPUT_CONTENTS": "Version_Spec=100&amp;Version_Plugin_Major=3&amp;Version_Plugin_Minor=0&amp;Version_Browser_Major=0&amp;Version_Browser_Minor=11&amp;Transaction_ID=7a4a1763-0ac0-4fb7-9d98-e6053e95d191401141426801730&amp;Signature_Data=MIIPZgYJKoZIhvcNAQcCoIIPVzCCD1MCAQExCzAJBgUrDgMCGgUAMIID2wYJKoZIhvcNAQcBoIIDzASCA8hDbGllbnQgTmFtZTogICAgICAgICAgICAgICAgICAgICAgICBURVNUSU5HIENPTVBBTlkgICAgICAgICAgICAgICAgICAgICAgIA0KRG9jdW1lbnQgSUQ6ICAgICAgICAgICAgICAgICAgICAgICAgRjAyNjNBMEUyNDJFNEM5NEI2MEREMjA0RjQ0QjZDQUINClNpZ24gYW5kIFN1Ym1pdCB0aGUgZm9sbG93aW5nIHRyYW5zYWN0aW9ucyAoMSkNCg0KUGF5bWVudCBUeXBlOiAgICAgICAgICAgICAgICAgICAgICAgRG9tZXN0aWMgUGF5bWVudA0KRGVsaXZlcnkgT3B0aW9uOiAgICAgICAgICAgICAgICAgICAgVUsgVGhyZWUgRGF5IFBheW1lbnQNCkRlYml0IEFjY291bnQgQmFuayBJZGVudGlmaWVyOiAgICAgIDA5MDA2Mw0KRGViaXQgQWNjb3VudCBOdW1iZXI6ICAgICAgICAgICAgICAgMDMwNDE0MDENCkRlYml0IEFjY291bnQgQ3VycmVuY3k6ICAgICAgICAgICAgIFBvdW5kIFN0ZXJsaW5nDQpQYXltZW50IEN1cnJlbmN5OiAgICAgICAgICAgICAgICAgICBQb3VuZCBTdGVybGluZw0KUGF5bWVudCBBbW91bnQ6ICAgICAgICAgICAgICAgICAgICAgMjYwMC4wMA0KVHJhbnNhY3Rpb24gUmVmZXJlbmNlIE51bWJlcjogICAgICAgQlgxNTA0MjAwNjkzMjYwNw0KVmFsdWUgRGF0ZTogICAgICAgICAgICAgICAgICAgICAgICAgQXByIDI0LCAyMDE1DQpDdXN0b21lciBSZWZlcmVuY2U6ICAgICAgICAgICAgICAgICAxMjMxMjMxMjMNCk51bWJlciBvZiBjcmVkaXQvZGViaXQgcmVjb3JkczoJICAgIDENCg0KQmVuZWZpY2lhcnkgTmFtZTogICAgICAgICAgICAgICAgICAgMTM0MjM0MjMNCkJlbmVmaWNpYXJ5IEFjY291bnQgQmFuayBJZGVudGlmaWVyOjE4NTAwOA0KQmVuZWZpY2lh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&amp;Signature_Format=PKCS7_basic&amp;IsDetailScrAction=false&amp;pd=F0263A0E242E4C94B60DD204F44B6CAB&amp;gssRefId=7a4a1763-0ac0-4fb7-9d98-e6053e95d191401141426801730&amp;gssStore=true"
   }
}]]></con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/verify</con:originalUri><con:assertion type="GroovyScriptAssertion" id="b2b9bd53-4cd9-4378-ad3e-a47f8bc3793c" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "SUCCESS"
assert jsonMap.gssResponseHeader.responseContext.NEXTACTION == "COMPLETE"</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Signing_SecurityContext" id="7480d5f2-aa4a-4099-94c8-ed1d2ab67c33"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>SGG-SC</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>VerifyLogin</con:sourceStep><con:sourcePath>gssResponseHeader.securityContext</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>InitiateSigning</con:targetStep><con:targetPath>initiateRequestHeader.gssRequestHeader.securityContext</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="restrequest" name="InitiateSigning" id="cc394a16-8ede-4cde-ae9e-e8c27096a7d4"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/initiate" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="InitiateSigning" id="45730af7-4d98-41bd-a00f-24929dff6304" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request>{
   "transactionItemList": [],
   "preFormattedData": "VGhpcyBpcyBhIHNhbXBsZSBvZiBwcmVmb3JtYXR0ZWQgZGF0YSwgY3JlYXRlZCBvbiAyNy8wMy8yMDE1Lg==",
   "initiateRequestHeader":    {
      "gssRequestHeader":       {
         "serviceContext":          {
            "PURN_TYPE": "pki",
            "USER_AGENT": "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
            "PURN": "99000000000000000003",
            "APPLICATION": "B.NET"
         },
         "auditContext":          {
            "MODULE_ID": "12345678901234567890123456789012345678901",
            "IS_FINANCIAL_TRANSACTION": "false",
            "SUB_MODULE_ID": "eyJVU0VSX0FHRU5UIjoiSUU4IiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IkdCIn0=",
            "SUBMODULE_ID": "eyJVU0VSX0FHRU5UIjoiSUU4IiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IkdCIn0=",
            "CLIENT_IP_ADDRESS": "35.53.180.6"
         },
         "requestContext":          {
            "REQUEST_TIMESTAMP": "2011-06-14T04:12:36BST",
            "REQUEST_TRACKING_ID": "REQ10001",
            "CALLBACK_URL": "https://bnet.barclays.com/"
         },
         "securityContext": "eyJQVVJOX1RZUEUiOiJwa2kiLCJQVVJOIjoiOTkwMDAwMDAwMDAwMDAwMDAwMDMiLCJVU0VSX0FHRU5UIjoiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgNi4xOyBXT1c2NDsgVHJpZGVudC83LjA7IEFTOyBydjoxMS4wKSBsaWtlIEdlY2tvIiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIkRFVklDRV9UWVBFX0NPREUiOiJGViIsIlJFR0lPTiI6IkdCIiwiR1NTX1JFRkVSRU5DRV9JRCI6IjJGMEU5QTY4QkNENTRCMkQ4RTQ1NDVENEVDOEFBQkQ2IiwiQ0xJRU5UX05BTUUiOiJiYXJjbGF5cyBjb3JwIExpbWl0ZWQiLCJVU0VSX05BTUUiOiJKZXNpY2EzIGFsYmEzIiwiREVWSUNFX0FMSUFTIjoiRlYgQWxpYXMiLCJVU0VSX1NUQVRVUyI6IkFDVElWRSJ9"
      },
      "initiateRequestHeaderDetails":       {
         "FUNCTION_TYPE": "SIGN-TRANSACTIONS",
         "ACTION_TYPE": "SUBMIT",
         "DEVICE_TYPE_CODE": "FV",
         "OUTPUT_TYPE": "HTML"
      }
   },
   "requestDetailsMap": {}
}</con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/initiate</con:originalUri><con:assertion type="GroovyScriptAssertion" id="71871115-a758-42aa-9198-a94e0a41ea66" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "SUCCESS"
assert jsonMap.gssResponseHeader.responseContext.NEXTACTION == "VERIFY"</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Signing_SecurityContext1" id="42349e79-f688-450c-9116-2c077842c636"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>SGG-SC</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateSigning</con:sourceStep><con:sourcePath>gssResponseHeader.securityContext</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifySigning</con:targetStep><con:targetPath>gssRequestHeader.securityContext</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Signing_GSS-Nonce1" id="492f6662-dd2d-4c75-9c44-9511d96dfd1c"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-NONCE</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateSigning</con:sourceStep><con:sourcePath>gssResponseHeader.responseContext.GSS_NONCE</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifySigning</con:targetStep><con:targetPath>gssRequestHeader.requestContext.GSS_NONCE</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Signing_GSS-Ref-ID1" id="c541f835-a13e-459b-8429-06d851b5c6eb"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-REF-ID</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateSigning</con:sourceStep><con:sourcePath>initiateResponseDetailsMap.GSS_REFERENCE_ID</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifySigning</con:targetStep><con:targetPath>verifyDetailMap.GSS_REFERENCE_ID
</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="restrequest" name="VerifySigning" id="36eae9fe-4a3e-4ca2-8984-02665081bbcb"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/verify" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="VerifySigning" id="ae8cc01d-5b14-46b5-8fa6-6207c40ac5af" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request><![CDATA[{
   "verifyDetailMap": {"GSS_REFERENCE_ID": "3E1AE6B8D5094C1FB87DB354CEAE09A9"},
   "gssRequestHeader":    {
      "serviceContext":       {
         "USER_AGENT": "Gecko/20130401 Firefox/31.0",
         "APPLICATION": "B.NET"
      },
      "auditContext":       {
         "MODULE_ID": "B.Net Login Module",
         "IS_FINANCIAL_TRANSACTION": "false",
         "CLIENT_IP_ADDRESS": "35.53.180.6"
      },
      "requestContext":       {
         "REQUEST_TIMESTAMP": "2011-06-14T04:12:36BST",
         "REQUEST_TRACKING_ID": "REQ10001",
         "CALLBACK_URL": "https://gbrdsr000002800:5351/generic-security-test-bed/FV_Servlet",
         "GSS_NONCE": "d24ed7f1-5f21-4bbb-aff1-233b59c0524a"
      },
      "securityContext": "eyJQVVJOX1RZUEUiOiJwa2kiLCJVU0VSX05BTUUiOiJKZXNpY2EzIGFsYmEzIiwiQ0xJRU5UX05BTUUiOiJiYXJjbGF5cyBjb3JwIExpbWl0ZWQiLCJVU0VSX0FHRU5UIjoiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgNi4xOyBXT1c2NDsgVHJpZGVudC83LjA7IEFTOyBydjoxMS4wKSBsaWtlIEdlY2tvIiwiUFVSTiI6Ijk5MDAwMDAwMDAwMDAwMDAwMDAzIiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIkRFVklDRV9BTElBUyI6IkZWIEFsaWFzIiwiREVWSUNFX1RZUEVfQ09ERSI6IkZWIiwiUkVHSU9OIjoiR0IiLCJVU0VSX1NUQVRVUyI6IkFDVElWRSIsIkdTU19SRUZFUkVOQ0VfSUQiOiIzRTFBRTZCOEQ1MDk0QzFGQjg3REIzNTRDRUFFMDlBOSJ9"
   },
   "deviceParamMap":    {
      "HTTP_METHOD": "PUT",
      "HTTP_INPUT_CONTENTS": "Version_Spec=100&amp;Version_Plugin_Major=3&amp;Version_Plugin_Minor=0&amp;Version_Browser_Major=0&amp;Version_Browser_Minor=11&amp;Transaction_ID=03B8BBD9AA084C7F917FE3D31CDE19BA&amp;Signature_Data=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&amp;Signature_Format=PKCS7_basic&amp;IsDetailScrAction=false&amp;pd=F0263A0E242E4C94B60DD204F44B6CAB&amp;gssRefId=7a4a1763-0ac0-4fb7-9d98-e6053e95d191401141426801730&amp;gssStore=true"
   }
}]]></con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/verify</con:originalUri><con:assertion type="GroovyScriptAssertion" id="351aafb0-2bc2-4ea1-8f84-b53498b9502b" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "SUCCESS"
assert jsonMap.gssResponseHeader.responseContext.NEXTACTION == "COMPLETE"</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:properties/></con:testCase><con:testCase id="ed9a7401-aac6-48bf-b539-cb52ad6645c9" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="TestCase 2.2-Hitachi--Login-Invalid_Ref_ID" searchProperties="true"><con:settings/><con:testStep type="restrequest" name="GetDeviceList" id="32e0f63e-45cc-43d5-843d-21d6f3101d0e"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/devicelist" methodName="Devicelist" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="GetDeviceList" id="b063e9a0-5f4c-484f-b84a-038d96c080c1" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request>{
	"gssRequestHeader":{
		"serviceContext":{
			"USER_AGENT":"Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
			"APPLICATION":"B.NET"
		},
		"securityContext":null,
		"requestContext":{
			"REQUEST_TIMESTAMP":"2011-06-14T04:12:36BST",
			"REQUEST_TRACKING_ID":"REQ10001",
			"CALLBACK_URL":"https://bnet.barclays.com/"
		},
		"auditContext":{
			"MODULE_ID":"B.Net Login Module",
			"IS_FINANCIAL_TRANSACTION":"false",
			"CLIENT_IP_ADDRESS":"35.53.180.6"
		}
	},
	"deviceRequestMap":{
		"ONLY_ACTIVE":"true",
		"OUTPUT_TYPE":"BOTH"
	}
}</con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/devicelist</con:originalUri><con:assertion type="GroovyScriptAssertion" id="6c166ddf-cdfe-4189-9b56-bea28374973b" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "SUCCESS"
assert jsonMap.deviceInfo[0].DeviceDetailMap.STATUS == "Active"</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-GetDeviceList" id="92d84f82-22fc-4847-b55d-cb848896409f"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-SC</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>GetDeviceList</con:sourceStep><con:sourcePath>gssResponseHeader.securityContext</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>InitiateLogin</con:targetStep><con:targetPath>initiateRequestHeader.gssRequestHeader.securityContext</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="restrequest" name="InitiateLogin" id="755817cc-08e2-44d2-80e8-f461fcc99fc6"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/initiate" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="InitiateLogin" id="45730af7-4d98-41bd-a00f-24929dff6304" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request>{
   "transactionItemList": [],
   "preFormattedData": "VGhpcyBpcyBhIHNhbXBsZSBvZiBwcmVmb3JtYXR0ZWQgZGF0YSwgY3JlYXRlZCBvbiAyNy8wMy8yMDE1Lg==",
   "initiateRequestHeader":    {
      "gssRequestHeader":       {
         "serviceContext":          {
            "PURN_TYPE": "pki",
            "PURN": "99000000000000000003",
            "USER_AGENT": "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
            "APPLICATION": "B.NET"
         },
         "auditContext":          {
            "MODULE_ID": "12345678901234567890123456789012345678901",
            "IS_FINANCIAL_TRANSACTION": "false",
            "SUB_MODULE_ID": "eyJVU0VSX0FHRU5UIjoiSUU4IiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IkdCIn0=",
            "SUBMODULE_ID": "eyJVU0VSX0FHRU5UIjoiSUU4IiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IkdCIn0=",
            "CLIENT_IP_ADDRESS": "35.53.180.6"
         },
         "requestContext":          {
            "REQUEST_TIMESTAMP": "2011-06-14T04:12:36BST",
            "REQUEST_TRACKING_ID": "REQ10001",
            "CALLBACK_URL": "https://bnet.barclays.com/"
         },
         "securityContext": "eyJVU0VSX0FHRU5UIjoiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgNi4xOyBXT1c2NDsgVHJpZGVudC83LjA7IEFTOyBydjoxMS4wKSBsaWtlIEdlY2tvIiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IlBVIn0="
      },
      "initiateRequestHeaderDetails":       {
         "FUNCTION_TYPE": "AUTHENTICATE",
         "ACTION_TYPE": "SUBMIT",
         "DEVICE_TYPE_CODE": "FV",
         "OUTPUT_TYPE": "HTML"
      }
   },
   "requestDetailsMap": {}
}</con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/initiate</con:originalUri><con:assertion type="GroovyScriptAssertion" id="3f2a7f7f-4150-4f59-b57e-eddb93b59884" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "SUCCESS"
assert jsonMap.gssResponseHeader.responseContext.NEXTACTION == "VERIFY"</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Login_SecurityContext" id="e1e279ee-1ba3-4cf9-8f93-f62c55fc404e"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>SGG-SC</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateLogin</con:sourceStep><con:sourcePath>gssResponseHeader.securityContext</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifyLogin</con:targetStep><con:targetPath>gssRequestHeader.securityContext</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Login_GSS-Nonce" id="b1d14ddf-c00f-4a46-a5fa-15705b1607a1"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-NONCE</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateLogin</con:sourceStep><con:sourcePath>gssResponseHeader.responseContext.GSS_NONCE</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifyLogin</con:targetStep><con:targetPath>gssRequestHeader.requestContext.GSS_NONCE</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Login_GSS-Ref-ID" id="63a927b4-3e22-4644-850e-cdc33b38ebff" disabled="true"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-REF-ID</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateLogin</con:sourceStep><con:sourcePath>initiateResponseDetailsMap.GSS_REFERENCE_ID</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifyLogin</con:targetStep><con:targetPath>verifyDetailMap.GSS_REFERENCE_ID</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="restrequest" name="VerifyLogin" id="5d166a37-3078-4dfd-98ad-251cffa41ce6"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/verify" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="VerifyLogin" id="ae8cc01d-5b14-46b5-8fa6-6207c40ac5af" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request><![CDATA[{
   "verifyDetailMap": {"GSS_REFERENCE_ID": "DFBBB31B1ED1447EB80A899E7CF16E71"},
   "gssRequestHeader":    {
      "serviceContext":       {
         "USER_AGENT": "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
         "APPLICATION": "B.NET"
      },
      "auditContext":       {
         "MODULE_ID": "B.Net Login Module",
         "IS_FINANCIAL_TRANSACTION": "false",
         "CLIENT_IP_ADDRESS": "35.53.180.6"
      },
      "requestContext":       {
         "REQUEST_TIMESTAMP": "2011-06-14T04:12:36BST",
         "REQUEST_TRACKING_ID": "REQ10001",
         "CALLBACK_URL": "https://bnet.barclays.com/",
         "GSS_NONCE": "7bc49439-7284-4968-b614-b949591c872f"
      },
      "securityContext": "eyJQVVJOX1RZUEUiOiJwa2kiLCJQVVJOIjoiOTkwMDAwMDAwMDAwMDAwMDAwMDMiLCJVU0VSX0FHRU5UIjoiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgNi4xOyBXT1c2NDsgVHJpZGVudC83LjA7IEFTOyBydjoxMS4wKSBsaWtlIEdlY2tvIiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIkRFVklDRV9UWVBFX0NPREUiOiJGViIsIlJFR0lPTiI6IkdCIiwiR1NTX1JFRkVSRU5DRV9JRCI6IjM4RENBNjA4RTAzMTQ2RjU4NERGRkE5OEU0NDQ2RTVCIn0="
   },
   "deviceParamMap":    {
      "HTTP_METHOD": "PUT",
      "HTTP_INPUT_CONTENTS": "Version_Spec=100&amp;Version_Plugin_Major=3&amp;Version_Plugin_Minor=0&amp;Version_Browser_Major=0&amp;Version_Browser_Minor=11&amp;Transaction_ID=7a4a1763-0ac0-4fb7-9d98-e6053e95d191401141426801730&amp;Signature_Data=MIIPZgYJKoZIhvcNAQcCoIIPVzCCD1MCAQExCzAJBgUrDgMCGgUAMIID2wYJKoZIhvcNAQcBoIIDzASCA8hDbGllbnQgTmFtZTogICAgICAgICAgICAgICAgICAgICAgICBURVNUSU5HIENPTVBBTlkgICAgICAgICAgICAgICAgICAgICAgIA0KRG9jdW1lbnQgSUQ6ICAgICAgICAgICAgICAgICAgICAgICAgRjAyNjNBMEUyNDJFNEM5NEI2MEREMjA0RjQ0QjZDQUINClNpZ24gYW5kIFN1Ym1pdCB0aGUgZm9sbG93aW5nIHRyYW5zYWN0aW9ucyAoMSkNCg0KUGF5bWVudCBUeXBlOiAgICAgICAgICAgICAgICAgICAgICAgRG9tZXN0aWMgUGF5bWVudA0KRGVsaXZlcnkgT3B0aW9uOiAgICAgICAgICAgICAgICAgICAgVUsgVGhyZWUgRGF5IFBheW1lbnQNCkRlYml0IEFjY291bnQgQmFuayBJZGVudGlmaWVyOiAgICAgIDA5MDA2Mw0KRGViaXQgQWNjb3VudCBOdW1iZXI6ICAgICAgICAgICAgICAgMDMwNDE0MDENCkRlYml0IEFjY291bnQgQ3VycmVuY3k6ICAgICAgICAgICAgIFBvdW5kIFN0ZXJsaW5nDQpQYXltZW50IEN1cnJlbmN5OiAgICAgICAgICAgICAgICAgICBQb3VuZCBTdGVybGluZw0KUGF5bWVudCBBbW91bnQ6ICAgICAgICAgICAgICAgICAgICAgMjYwMC4wMA0KVHJhbnNhY3Rpb24gUmVmZXJlbmNlIE51bWJlcjogICAgICAgQlgxNTA0MjAwNjkzMjYwNw0KVmFsdWUgRGF0ZTogICAgICAgICAgICAgICAgICAgICAgICAgQXByIDI0LCAyMDE1DQpDdXN0b21lciBSZWZlcmVuY2U6ICAgICAgICAgICAgICAgICAxMjMxMjMxMjMNCk51bWJlciBvZiBjcmVkaXQvZGViaXQgcmVjb3JkczoJICAgIDENCg0KQmVuZWZpY2lhcnkgTmFtZTogICAgICAgICAgICAgICAgICAgMTM0MjM0MjMNCkJlbmVmaWNpYXJ5IEFjY291bnQgQmFuayBJZGVudGlmaWVyOjE4NTAwOA0KQmVuZWZpY2lh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&amp;Signature_Format=PKCS7_basic&amp;IsDetailScrAction=false&amp;pd=F0263A0E242E4C94B60DD204F44B6CAB&amp;gssRefId=7a4a1763-0ac0-4fb7-9d98-e6053e95d191401141426801730&amp;gssStore=true"
   }
}]]></con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/verify</con:originalUri><con:assertion type="GroovyScriptAssertion" id="b2b9bd53-4cd9-4378-ad3e-a47f8bc3793c" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "ERROR"


assert jsonMap.gssResponseHeader.gssError.errorCode == "INVALID_REFERENCE_ID"


assert jsonMap.gssResponseHeader.gssError.errorMsg == "Reference id is invalid or null"
</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:properties/></con:testCase><con:testCase id="cc4cae60-402c-4fab-8af1-2428c07143f5" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="TestCase 3.2-Hitachi  Signing-ReplayAttack" searchProperties="true"><con:settings/><con:testStep type="restrequest" name="GetDeviceList" id="d6413ca9-6385-4700-815c-533d3e2761e4"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/devicelist" methodName="Devicelist" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="GetDeviceList" id="b063e9a0-5f4c-484f-b84a-038d96c080c1" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request>{
	"gssRequestHeader":{
		"serviceContext":{
			"USER_AGENT":"Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
			"APPLICATION":"B.NET"
		},
		"securityContext":null,
		"requestContext":{
			"REQUEST_TIMESTAMP":"2011-06-14T04:12:36BST",
			"REQUEST_TRACKING_ID":"REQ10001",
			"CALLBACK_URL":"https://bnet.barclays.com/"
		},
		"auditContext":{
			"MODULE_ID":"B.Net Login Module",
			"IS_FINANCIAL_TRANSACTION":"false",
			"CLIENT_IP_ADDRESS":"35.53.180.6"
		}
	},
	"deviceRequestMap":{
		"ONLY_ACTIVE":"true",
		"OUTPUT_TYPE":"BOTH"
	}
}</con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/devicelist</con:originalUri><con:assertion type="GroovyScriptAssertion" id="6c166ddf-cdfe-4189-9b56-bea28374973b" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "SUCCESS"
assert jsonMap.deviceInfo[0].DeviceDetailMap.STATUS == "Active"</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-GetDeviceList" id="bca7c282-ccb4-4584-8a6c-0afaccf8b57a"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-SC</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>GetDeviceList</con:sourceStep><con:sourcePath>gssResponseHeader.securityContext</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>InitiateLogin</con:targetStep><con:targetPath>initiateRequestHeader.gssRequestHeader.securityContext</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="restrequest" name="InitiateLogin" id="cce07738-4317-4719-8d15-ea8866ac3a95"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/initiate" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="InitiateLogin" id="45730af7-4d98-41bd-a00f-24929dff6304" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request>{
   "transactionItemList": [],
   "preFormattedData": "VGhpcyBpcyBhIHNhbXBsZSBvZiBwcmVmb3JtYXR0ZWQgZGF0YSwgY3JlYXRlZCBvbiAyNy8wMy8yMDE1Lg==",
   "initiateRequestHeader":    {
      "gssRequestHeader":       {
         "serviceContext":          {
            "PURN_TYPE": "pki",
            "PURN": "99000000000000000003",
            "USER_AGENT": "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
            "APPLICATION": "B.NET"
         },
         "auditContext":          {
            "MODULE_ID": "12345678901234567890123456789012345678901",
            "IS_FINANCIAL_TRANSACTION": "false",
            "SUB_MODULE_ID": "eyJVU0VSX0FHRU5UIjoiSUU4IiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IkdCIn0=",
            "SUBMODULE_ID": "eyJVU0VSX0FHRU5UIjoiSUU4IiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IkdCIn0=",
            "CLIENT_IP_ADDRESS": "35.53.180.6"
         },
         "requestContext":          {
            "REQUEST_TIMESTAMP": "2011-06-14T04:12:36BST",
            "REQUEST_TRACKING_ID": "REQ10001",
            "CALLBACK_URL": "https://bnet.barclays.com/"
         },
         "securityContext": "eyJVU0VSX0FHRU5UIjoiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgNi4xOyBXT1c2NDsgVHJpZGVudC83LjA7IEFTOyBydjoxMS4wKSBsaWtlIEdlY2tvIiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IlBVIn0="
      },
      "initiateRequestHeaderDetails":       {
         "FUNCTION_TYPE": "AUTHENTICATE",
         "ACTION_TYPE": "SUBMIT",
         "DEVICE_TYPE_CODE": "FV",
         "OUTPUT_TYPE": "HTML"
      }
   },
   "requestDetailsMap": {}
}</con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/initiate</con:originalUri><con:assertion type="GroovyScriptAssertion" id="3f2a7f7f-4150-4f59-b57e-eddb93b59884" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "SUCCESS"
assert jsonMap.gssResponseHeader.responseContext.NEXTACTION == "VERIFY"</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Login_SecurityContext" id="d201f380-2f95-45c0-8a4d-32f09b816553"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>SGG-SC</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateLogin</con:sourceStep><con:sourcePath>gssResponseHeader.securityContext</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifyLogin</con:targetStep><con:targetPath>gssRequestHeader.securityContext</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Login_GSS-Nonce" id="f5dab36e-ce73-4ab7-a51a-52a9ef206f1d"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-NONCE</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateLogin</con:sourceStep><con:sourcePath>gssResponseHeader.responseContext.GSS_NONCE</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifyLogin</con:targetStep><con:targetPath>gssRequestHeader.requestContext.GSS_NONCE</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Login_GSS-Ref-ID" id="3a4861bc-ec71-4bd3-8b47-3feb917ecb51"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-REF-ID</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateLogin</con:sourceStep><con:sourcePath>initiateResponseDetailsMap.GSS_REFERENCE_ID</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifyLogin</con:targetStep><con:targetPath>verifyDetailMap.GSS_REFERENCE_ID</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="restrequest" name="VerifyLogin" id="5f5eca63-7170-4b22-aa16-824ac05d255f"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/verify" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="VerifyLogin" id="ae8cc01d-5b14-46b5-8fa6-6207c40ac5af" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request><![CDATA[{
   "verifyDetailMap": {"GSS_REFERENCE_ID": "C529DEDAA1994DE7B91775689EE046FE"},
   "gssRequestHeader":    {
      "serviceContext":       {
         "USER_AGENT": "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
         "APPLICATION": "B.NET"
      },
      "auditContext":       {
         "MODULE_ID": "B.Net Login Module",
         "IS_FINANCIAL_TRANSACTION": "false",
         "CLIENT_IP_ADDRESS": "35.53.180.6"
      },
      "requestContext":       {
         "REQUEST_TIMESTAMP": "2011-06-14T04:12:36BST",
         "REQUEST_TRACKING_ID": "REQ10001",
         "CALLBACK_URL": "https://bnet.barclays.com/",
         "GSS_NONCE": "54e4e104-aedf-4d96-96dc-d534de648cf1"
      },
      "securityContext": "eyJQVVJOX1RZUEUiOiJwa2kiLCJQVVJOIjoiOTkwMDAwMDAwMDAwMDAwMDAwMDMiLCJVU0VSX0FHRU5UIjoiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgNi4xOyBXT1c2NDsgVHJpZGVudC83LjA7IEFTOyBydjoxMS4wKSBsaWtlIEdlY2tvIiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIkRFVklDRV9UWVBFX0NPREUiOiJGViIsIlJFR0lPTiI6IkdCIiwiR1NTX1JFRkVSRU5DRV9JRCI6IkM1MjlERURBQTE5OTRERTdCOTE3NzU2ODlFRTA0NkZFIn0="
   },
   "deviceParamMap":    {
      "HTTP_METHOD": "PUT",
      "HTTP_INPUT_CONTENTS": "Version_Spec=100&amp;Version_Plugin_Major=3&amp;Version_Plugin_Minor=0&amp;Version_Browser_Major=0&amp;Version_Browser_Minor=11&amp;Transaction_ID=7a4a1763-0ac0-4fb7-9d98-e6053e95d191401141426801730&amp;Signature_Data=MIIPZgYJKoZIhvcNAQcCoIIPVzCCD1MCAQExCzAJBgUrDgMCGgUAMIID2wYJKoZIhvcNAQcBoIIDzASCA8hDbGllbnQgTmFtZTogICAgICAgICAgICAgICAgICAgICAgICBURVNUSU5HIENPTVBBTlkgICAgICAgICAgICAgICAgICAgICAgIA0KRG9jdW1lbnQgSUQ6ICAgICAgICAgICAgICAgICAgICAgICAgRjAyNjNBMEUyNDJFNEM5NEI2MEREMjA0RjQ0QjZDQUINClNpZ24gYW5kIFN1Ym1pdCB0aGUgZm9sbG93aW5nIHRyYW5zYWN0aW9ucyAoMSkNCg0KUGF5bWVudCBUeXBlOiAgICAgICAgICAgICAgICAgICAgICAgRG9tZXN0aWMgUGF5bWVudA0KRGVsaXZlcnkgT3B0aW9uOiAgICAgICAgICAgICAgICAgICAgVUsgVGhyZWUgRGF5IFBheW1lbnQNCkRlYml0IEFjY291bnQgQmFuayBJZGVudGlmaWVyOiAgICAgIDA5MDA2Mw0KRGViaXQgQWNjb3VudCBOdW1iZXI6ICAgICAgICAgICAgICAgMDMwNDE0MDENCkRlYml0IEFjY291bnQgQ3VycmVuY3k6ICAgICAgICAgICAgIFBvdW5kIFN0ZXJsaW5nDQpQYXltZW50IEN1cnJlbmN5OiAgICAgICAgICAgICAgICAgICBQb3VuZCBTdGVybGluZw0KUGF5bWVudCBBbW91bnQ6ICAgICAgICAgICAgICAgICAgICAgMjYwMC4wMA0KVHJhbnNhY3Rpb24gUmVmZXJlbmNlIE51bWJlcjogICAgICAgQlgxNTA0MjAwNjkzMjYwNw0KVmFsdWUgRGF0ZTogICAgICAgICAgICAgICAgICAgICAgICAgQXByIDI0LCAyMDE1DQpDdXN0b21lciBSZWZlcmVuY2U6ICAgICAgICAgICAgICAgICAxMjMxMjMxMjMNCk51bWJlciBvZiBjcmVkaXQvZGViaXQgcmVjb3JkczoJICAgIDENCg0KQmVuZWZpY2lhcnkgTmFtZTogICAgICAgICAgICAgICAgICAgMTM0MjM0MjMNCkJlbmVmaWNpYXJ5IEFjY291bnQgQmFuayBJZGVudGlmaWVyOjE4NTAwOA0KQmVuZWZpY2lh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&amp;Signature_Format=PKCS7_basic&amp;IsDetailScrAction=false&amp;pd=F0263A0E242E4C94B60DD204F44B6CAB&amp;gssRefId=7a4a1763-0ac0-4fb7-9d98-e6053e95d191401141426801730&amp;gssStore=true"
   }
}]]></con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/verify</con:originalUri><con:assertion type="GroovyScriptAssertion" id="b2b9bd53-4cd9-4378-ad3e-a47f8bc3793c" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "SUCCESS"
assert jsonMap.gssResponseHeader.responseContext.NEXTACTION == "COMPLETE"</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Signing_SecurityContext" id="46eee70f-4014-4e5a-bb7f-6dc2bdefdff3"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>SGG-SC</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>VerifyLogin</con:sourceStep><con:sourcePath>gssResponseHeader.securityContext</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>InitiateSigning</con:targetStep><con:targetPath>initiateRequestHeader.gssRequestHeader.securityContext</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="restrequest" name="InitiateSigning" id="2e737d5f-c018-4f5b-bce4-9fc5ae4de212"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/initiate" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="InitiateSigning" id="45730af7-4d98-41bd-a00f-24929dff6304" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request>{
   "transactionItemList": [],
   "preFormattedData": "VGhpcyBpcyBhIHNhbXBsZSBvZiBwcmVmb3JtYXR0ZWQgZGF0YSwgY3JlYXRlZCBvbiAyNy8wMy8yMDE1Lg==",
   "initiateRequestHeader":    {
      "gssRequestHeader":       {
         "serviceContext":          {
            "PURN_TYPE": "pki",
            "USER_AGENT": "Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; AS; rv:11.0) like Gecko",
            "PURN": "99000000000000000003",
            "APPLICATION": "B.NET"
         },
         "auditContext":          {
            "MODULE_ID": "12345678901234567890123456789012345678901",
            "IS_FINANCIAL_TRANSACTION": "false",
            "SUB_MODULE_ID": "eyJVU0VSX0FHRU5UIjoiSUU4IiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IkdCIn0=",
            "SUBMODULE_ID": "eyJVU0VSX0FHRU5UIjoiSUU4IiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIlJFR0lPTiI6IkdCIn0=",
            "CLIENT_IP_ADDRESS": "35.53.180.6"
         },
         "requestContext":          {
            "REQUEST_TIMESTAMP": "2011-06-14T04:12:36BST",
            "REQUEST_TRACKING_ID": "REQ10001",
            "CALLBACK_URL": "https://bnet.barclays.com/"
         },
         "securityContext": "eyJQVVJOX1RZUEUiOiJwa2kiLCJQVVJOIjoiOTkwMDAwMDAwMDAwMDAwMDAwMDMiLCJVU0VSX0FHRU5UIjoiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgNi4xOyBXT1c2NDsgVHJpZGVudC83LjA7IEFTOyBydjoxMS4wKSBsaWtlIEdlY2tvIiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIkRFVklDRV9UWVBFX0NPREUiOiJGViIsIlJFR0lPTiI6IkdCIiwiR1NTX1JFRkVSRU5DRV9JRCI6IkM1MjlERURBQTE5OTRERTdCOTE3NzU2ODlFRTA0NkZFIiwiQ0xJRU5UX05BTUUiOiJiYXJjbGF5cyBjb3JwIExpbWl0ZWQiLCJVU0VSX05BTUUiOiJKZXNpY2EzIGFsYmEzIiwiREVWSUNFX0FMSUFTIjoiRlYgQWxpYXMiLCJVU0VSX1NUQVRVUyI6IkFDVElWRSJ9"
      },
      "initiateRequestHeaderDetails":       {
         "FUNCTION_TYPE": "SIGN-TRANSACTIONS",
         "ACTION_TYPE": "SUBMIT",
         "DEVICE_TYPE_CODE": "FV",
         "OUTPUT_TYPE": "HTML"
      }
   },
   "requestDetailsMap": {}
}</con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/initiate</con:originalUri><con:assertion type="GroovyScriptAssertion" id="71871115-a758-42aa-9198-a94e0a41ea66" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "SUCCESS"
assert jsonMap.gssResponseHeader.responseContext.NEXTACTION == "VERIFY"</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Signing_SecurityContext1" id="7b88784e-6820-48e9-a6d8-343e6f915f9f"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>SGG-SC</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateSigning</con:sourceStep><con:sourcePath>gssResponseHeader.securityContext</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifySigning</con:targetStep><con:targetPath>gssRequestHeader.securityContext</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Signing_GSS-Nonce1" id="441e6e3f-b139-497e-9daf-6f5a2cf630aa"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-NONCE</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateSigning</con:sourceStep><con:sourcePath>gssResponseHeader.responseContext.GSS_NONCE</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifySigning</con:targetStep><con:targetPath>gssRequestHeader.requestContext.GSS_NONCE</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="transfer" name="Property Transfer-Signing_GSS-Ref-ID1" id="184c1717-ccb8-40b4-9e63-7e509f16c72b"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-REF-ID</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateSigning</con:sourceStep><con:sourcePath>initiateResponseDetailsMap.GSS_REFERENCE_ID</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifySigning</con:targetStep><con:targetPath>verifyDetailMap.GSS_REFERENCE_ID
</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="restrequest" name="VerifySigning" id="f35ca392-273d-43fb-a544-fbb777eaaf3f"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/verify" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="VerifySigning" id="ae8cc01d-5b14-46b5-8fa6-6207c40ac5af" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request><![CDATA[{
   "verifyDetailMap": {"GSS_REFERENCE_ID": "01E101BC1321431F8F7834D51E2B64A9"},
   "gssRequestHeader":    {
      "serviceContext":       {
         "USER_AGENT": "Gecko/20130401 Firefox/31.0",
         "APPLICATION": "B.NET"
      },
      "auditContext":       {
         "MODULE_ID": "B.Net Login Module",
         "IS_FINANCIAL_TRANSACTION": "false",
         "CLIENT_IP_ADDRESS": "35.53.180.6"
      },
      "requestContext":       {
         "REQUEST_TIMESTAMP": "2011-06-14T04:12:36BST",
         "REQUEST_TRACKING_ID": "REQ10001",
         "CALLBACK_URL": "https://gbrdsr000002800:5351/generic-security-test-bed/FV_Servlet",
         "GSS_NONCE": "04eb22b4-6625-4b3d-96ca-dcaa9eee8679"
      },
      "securityContext": "eyJQVVJOX1RZUEUiOiJwa2kiLCJVU0VSX05BTUUiOiJKZXNpY2EzIGFsYmEzIiwiQ0xJRU5UX05BTUUiOiJiYXJjbGF5cyBjb3JwIExpbWl0ZWQiLCJVU0VSX0FHRU5UIjoiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgNi4xOyBXT1c2NDsgVHJpZGVudC83LjA7IEFTOyBydjoxMS4wKSBsaWtlIEdlY2tvIiwiUFVSTiI6Ijk5MDAwMDAwMDAwMDAwMDAwMDAzIiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIkRFVklDRV9BTElBUyI6IkZWIEFsaWFzIiwiREVWSUNFX1RZUEVfQ09ERSI6IkZWIiwiUkVHSU9OIjoiR0IiLCJVU0VSX1NUQVRVUyI6IkFDVElWRSIsIkdTU19SRUZFUkVOQ0VfSUQiOiIwMUUxMDFCQzEzMjE0MzFGOEY3ODM0RDUxRTJCNjRBOSJ9"
   },
   "deviceParamMap":    {
      "HTTP_METHOD": "PUT",
      "HTTP_INPUT_CONTENTS": "Version_Spec=100&amp;Version_Plugin_Major=3&amp;Version_Plugin_Minor=0&amp;Version_Browser_Major=0&amp;Version_Browser_Minor=11&amp;Transaction_ID=03B8BBD9AA084C7F917FE3D31CDE19BA&amp;Signature_Data=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&amp;Signature_Format=PKCS7_basic&amp;IsDetailScrAction=false&amp;pd=F0263A0E242E4C94B60DD204F44B6CAB&amp;gssRefId=7a4a1763-0ac0-4fb7-9d98-e6053e95d191401141426801730&amp;gssStore=true"
   }
}]]></con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/verify</con:originalUri><con:assertion type="GroovyScriptAssertion" id="351aafb0-2bc2-4ea1-8f84-b53498b9502b" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "SUCCESS"
assert jsonMap.gssResponseHeader.responseContext.NEXTACTION == "COMPLETE"</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="transfer" name="Copy of Property Transfer-Signing_SecurityContext1" id="954d76ce-e21c-48bc-bf96-84ad2850b36f"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>SGG-SC</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>VerifySigning</con:sourceStep><con:sourcePath>gssResponseHeader.securityContext</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifySigning-Replay</con:targetStep><con:targetPath>gssRequestHeader.securityContext</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="transfer" name="Copy of Property Transfer-Signing_GSS-Nonce1" id="c9fdb916-74ed-4e3f-82b8-416ed476e476"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-NONCE</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateSigning</con:sourceStep><con:sourcePath>gssResponseHeader.responseContext.GSS_NONCE</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifySigning</con:targetStep><con:targetPath>gssRequestHeader.requestContext.GSS_NONCE</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="transfer" name="Copy of Property Transfer-Signing_GSS-Ref-ID1" id="2f64f38e-75a1-4594-a72e-b9a88d8797d4"><con:settings/><con:config xsi:type="con:PropertyTransfersStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:transfers setNullOnMissingSource="true" transferTextContent="true" failOnError="true" ignoreEmpty="false" transferToAll="false" entitize="false" transferChildNodes="false"><con:name>GSS-REF-ID</con:name><con:sourceType>Response</con:sourceType><con:sourceStep>InitiateSigning</con:sourceStep><con:sourcePath>initiateResponseDetailsMap.GSS_REFERENCE_ID</con:sourcePath><con:targetType>Request</con:targetType><con:targetStep>VerifySigning</con:targetStep><con:targetPath>verifyDetailMap.GSS_REFERENCE_ID
</con:targetPath><con:type>JSONPATH</con:type><con:targetTransferType>JSONPATH</con:targetTransferType><con:upgraded>true</con:upgraded></con:transfers></con:config></con:testStep><con:testStep type="restrequest" name="VerifySigning-Replay" id="85f81241-afcf-4229-803a-ade83d6c7c6f"><con:settings/><con:config service="https://gbrdsr000003146.intranet.barcapint.com:4201" resourcePath="/generic-security-rs/verify" methodName="Method 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="VerifySigning-Replay" id="ae8cc01d-5b14-46b5-8fa6-6207c40ac5af" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>https://gbrdsr000003146.intranet.barcapint.com:4201</con:endpoint><con:request><![CDATA[{
   "verifyDetailMap": {"GSS_REFERENCE_ID": "3E1E052D329A491E8A9D26CF45BB9E4F"},
   "gssRequestHeader":    {
      "serviceContext":       {
         "USER_AGENT": "Gecko/20130401 Firefox/31.0",
         "APPLICATION": "B.NET"
      },
      "auditContext":       {
         "MODULE_ID": "B.Net Login Module",
         "IS_FINANCIAL_TRANSACTION": "false",
         "CLIENT_IP_ADDRESS": "35.53.180.6"
      },
      "requestContext":       {
         "REQUEST_TIMESTAMP": "2011-06-14T04:12:36BST",
         "REQUEST_TRACKING_ID": "REQ10001",
         "CALLBACK_URL": "https://gbrdsr000002800:5351/generic-security-test-bed/FV_Servlet",
         "GSS_NONCE": "677f9c83-2fcb-4266-8972-76b9b59b2c2b"
      },
      "securityContext": "eyJQVVJOX1RZUEUiOiJwa2kiLCJVU0VSX05BTUUiOiJKZXNpY2EzIGFsYmEzIiwiQ0xJRU5UX05BTUUiOiJiYXJjbGF5cyBjb3JwIExpbWl0ZWQiLCJVU0VSX0FHRU5UIjoiTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgNi4xOyBXT1c2NDsgVHJpZGVudC83LjA7IEFTOyBydjoxMS4wKSBsaWtlIEdlY2tvIiwiUFVSTiI6Ijk5MDAwMDAwMDAwMDAwMDAwMDAzIiwiQVBQTElDQVRJT04iOiJCLk5FVCIsIkRFVklDRV9BTElBUyI6IkZWIEFsaWFzIiwiREVWSUNFX1RZUEVfQ09ERSI6IkZWIiwiUkVHSU9OIjoiR0IiLCJVU0VSX1NUQVRVUyI6IkFDVElWRSIsIkdTU19SRUZFUkVOQ0VfSUQiOiI2NjFEMjlFOEU0MzY0MDgxQUJFREU5RjI0QkUzOTU5NyJ9"
   },
   "deviceParamMap":    {
      "HTTP_METHOD": "PUT",
      "HTTP_INPUT_CONTENTS": "Version_Spec=100&amp;Version_Plugin_Major=3&amp;Version_Plugin_Minor=0&amp;Version_Browser_Major=0&amp;Version_Browser_Minor=11&amp;Transaction_ID=03B8BBD9AA084C7F917FE3D31CDE19BA&amp;Signature_Data=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&amp;Signature_Format=PKCS7_basic&amp;IsDetailScrAction=false&amp;pd=F0263A0E242E4C94B60DD204F44B6CAB&amp;gssRefId=7a4a1763-0ac0-4fb7-9d98-e6053e95d191401141426801730&amp;gssStore=true"
   }
}]]></con:request><con:originalUri>https://gbrdsr000003146.intranet.barcapint.com/generic-security-rs/verify</con:originalUri><con:assertion type="GroovyScriptAssertion" id="351aafb0-2bc2-4ea1-8f84-b53498b9502b" name="Script Assertion"><con:configuration><scriptText>import groovy.json.JsonSlurper 
def response = messageExchange.response.responseContent
def slurper = new JsonSlurper()
def jsonMap = slurper.parseText response

assert jsonMap.gssResponseHeader.responseContext.RESPONSECODE == "ERROR"


assert jsonMap.gssResponseHeader.gssError.errorCode == "INVALID_REFERENCE_ID"


assert jsonMap.gssResponseHeader.gssError.errorMsg == "Reference id is invalid or null"
</scriptText></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:properties/></con:testCase><con:properties/></con:testSuite><con:testSuite id="b0935fca-0e82-4076-8e8a-51ecf75f8320" name="TestSuite 2"><con:settings/><con:runType>SEQUENTIAL</con:runType><con:properties/></con:testSuite><con:properties/><con:wssContainer/><con:oAuth2ProfileContainer/><con:oAuth1ProfileContainer/><con:sensitiveInformation/></con:soapui-project>